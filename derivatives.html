<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MTH229 with Julia - 6&nbsp; Approximate derivatives in Julia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./first-second-derivatives.html" rel="next">
<link href="./limits.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Approximate derivatives in Julia</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MTH229 with Julia</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/MTH229/mth229.github.io/tree/master/quarto/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">MTH229 notes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calculator.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Julia as a calculator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Functions in Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Graphing functions with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./zeros.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Solving for zeros with julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./limits.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Investigating limits with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./derivatives.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Approximate derivatives in Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./first-second-derivatives.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exploring first and second derivatives with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./newton.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Newton‚Äôs method using julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./extrema.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Maximization and minimization with Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./integration.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Numeric integration with Julia</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">MTH232 and 233</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mth232.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Notes on MTH 232 and Julia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mth233.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Notes on MTH 233 and Julia</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">6.1</span>  Introduction</a></li>
  <li><a href="#forward-difference-quotients-slope-of-the-tangent-line" id="toc-forward-difference-quotients-slope-of-the-tangent-line" class="nav-link" data-scroll-target="#forward-difference-quotients-slope-of-the-tangent-line"><span class="toc-section-number">6.2</span>  Forward difference quotients, Slope of the tangent line</a>
  <ul class="collapse">
  <li><a href="#practice" id="toc-practice" class="nav-link" data-scroll-target="#practice"><span class="toc-section-number">6.2.1</span>  Practice</a></li>
  </ul></li>
  <li><a href="#derivative-of-a-function" id="toc-derivative-of-a-function" class="nav-link" data-scroll-target="#derivative-of-a-function"><span class="toc-section-number">6.3</span>  Derivative of a function</a>
  <ul class="collapse">
  <li><a href="#practice-1" id="toc-practice-1" class="nav-link" data-scroll-target="#practice-1"><span class="toc-section-number">6.3.1</span>  Practice</a></li>
  </ul></li>
  <li><a href="#improvements-to-the-basic-forward-difference-quotient" id="toc-improvements-to-the-basic-forward-difference-quotient" class="nav-link" data-scroll-target="#improvements-to-the-basic-forward-difference-quotient"><span class="toc-section-number">6.4</span>  Improvements to the basic forward difference quotient</a>
  <ul class="collapse">
  <li><a href="#central-difference-quotient" id="toc-central-difference-quotient" class="nav-link" data-scroll-target="#central-difference-quotient"><span class="toc-section-number">6.4.1</span>  Central difference quotient</a></li>
  <li><a href="#practice-2" id="toc-practice-2" class="nav-link" data-scroll-target="#practice-2"><span class="toc-section-number">6.4.2</span>  Practice</a></li>
  </ul></li>
  <li><a href="#automatic-differentiation" id="toc-automatic-differentiation" class="nav-link" data-scroll-target="#automatic-differentiation"><span class="toc-section-number">6.5</span>  Automatic differentiation</a>
  <ul class="collapse">
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="toc-section-number">6.5.1</span>  Examples</a></li>
  <li><a href="#practice-3" id="toc-practice-3" class="nav-link" data-scroll-target="#practice-3"><span class="toc-section-number">6.5.2</span>  Practice</a></li>
  </ul></li>
  <li><a href="#error-analysis" id="toc-error-analysis" class="nav-link" data-scroll-target="#error-analysis"><span class="toc-section-number">6.6</span>  Error analysis</a>
  <ul class="collapse">
  <li><a href="#approximation-errors-for-the-central-difference-quotient" id="toc-approximation-errors-for-the-central-difference-quotient" class="nav-link" data-scroll-target="#approximation-errors-for-the-central-difference-quotient"><span class="toc-section-number">6.6.1</span>  Approximation errors for the central difference quotient</a></li>
  <li><a href="#practice-4" id="toc-practice-4" class="nav-link" data-scroll-target="#practice-4"><span class="toc-section-number">6.6.2</span>  Practice</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/MTH229/mth229.github.io/edit/master/quarto/derivatives.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/MTH229/mth229.github.io/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Approximate derivatives in Julia</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<div class="cell-output cell-output-error">
<pre><code>LoadError: InitError: PyError (PyImport_ImportModule

The Python package sympy could not be imported by pyimport. Usually this means
that you did not install sympy in the Python version being used by PyCall.

PyCall is currently configured to use the Python version at:

/opt/hostedtoolcache/Python/3.10.6/x64/bin/python3

and you should use whatever mechanism you usually use (apt-get, pip, conda,
etcetera) to install the Python package containing the sympy module.

One alternative is to re-configure PyCall to use a different Python
version on your system: set ENV["PYTHON"] to the path/name of the python
executable you want to use, run Pkg.build("PyCall"), and re-launch Julia.

Another alternative is to configure PyCall to use a Julia-specific Python
distribution via the Conda.jl package (which installs a private Anaconda
Python distribution), which has the advantage that packages can be installed
and kept up-to-date via Julia.  As explained in the PyCall documentation,
set ENV["PYTHON"]="", run Pkg.build("PyCall"), and re-launch Julia. Then,
To install the sympy module, you can use `pyimport_conda("sympy", PKG)`,
where PKG is the Anaconda package that contains the module sympy,
or alternatively you can use the Conda package directly (via
`using Conda` followed by `Conda.add` etcetera).

) &lt;class 'ModuleNotFoundError'&gt;
ModuleNotFoundError("No module named 'sympy'")

during initialization of module SymPy</code></pre>
</div>
</div>
<p><br> A notebook for this material: <a href="https://raw.githubusercontent.com/mth229/229-projects/master/06-derivatives.ipynb">ipynb</a> <a href="./229-projects/06-derivatives.html">(Pluto html)</a> <a href="./229-projects/06-derivatives-pluto-commentary.html">(With commentary)</a></p>
<section id="introduction" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">6.1</span> Introduction</h2>
<p>We load our packages to begin.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MTH229</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ERROR: LoadError: InitError: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>PyError (PyImport_ImportModule

The Python package sympy could not be imported by pyimport. Usually this means
that you did not install sympy in the Python version being used by PyCall.

PyCall is currently configured to use the Python version at:

/opt/hostedtoolcache/Python/3.10.6/x64/bin/python3

and you should use whatever mechanism you usually use (apt-get, pip, conda,
etcetera) to install the Python package containing the sympy module.

One alternative is to re-configure PyCall to use a different Python
version on your system: set ENV["PYTHON"] to the path/name of the python
executable you want to use, run Pkg.build("PyCall"), and re-launch Julia.

Another alternative is to configure PyCall to use a Julia-specific Python
distribution via the Conda.jl package (which installs a private Anaconda
Python distribution), which has the advantage that packages can be installed
and kept up-to-date via Julia.  As explained in the PyCall documentation,
set ENV["PYTHON"]="", run Pkg.build("PyCall"), and re-launch Julia. Then,
To install the sympy module, you can use `pyimport_conda("sympy", PKG)`,
where PKG is the Anaconda package that contains the module sympy,
or alternatively you can use the Conda package directly (via
`using Conda` followed by `Conda.add` etcetera).

) &lt;class 'ModuleNotFoundError'&gt;
ModuleNotFoundError("No module named 'sympy'")

Stacktrace:
  [1] pyimport(name::</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>String)
    @ PyCall ~/.julia/packages/PyCall/ygXW2/src/PyCall.jl:558
  [2] pyimport_conda(modulename::String, condapkg::String, channel::String)
    @ PyCall ~/.julia/packages/PyCall/ygXW2/src/PyCall.jl:716
  [3] pyimport_conda
    @ ~/.julia/packages/PyCall/ygXW2/src/PyCall.jl:715 [inlined]
  [4] __init__()
    @ SymPy ~/.julia/packages/SymPy/7cg6m/src/SymPy.jl:128
  [5] _include_from_serialized(pkg::Base.PkgId, path::String, depmods::Vector{Any})
    @ Base ./loading.jl:831
  [6] _require_search_from_serialized(pkg::Base.PkgId, sourcepath::String, build_id::UInt64)
    @ Base ./loading.jl:1039
  [7] _require(pkg::Base.PkgId)
    @ Base ./loading.jl:1315
  [8] _require_prelocked(uuidkey::Base.PkgId)
    @ Base ./loading.jl:1200
  [9] macro expansion
    @ ./loading.jl:1180 [inlined]
 [10] macro expansion
    @ ./lock.jl:223 [inlined]
 [11] require(into::Module, mod::Symbol)
    @ Base ./loading.jl:1144
 [12] include
    @ ./Base.jl:419 [inlined]
 [13] include_package_for_output(pkg::Base.PkgId, input::String, depot_path::Vector{String}, dl_load_path::Vector{String}, load_path::Vector{String}, concrete_deps::Vector{Pair{Base.PkgId, UInt64}}, source::Nothing)
    @ Base ./loading.jl:1554
 [14] top-level scope
    @ stdin:1
during initialization of module SymPy
in expression starting at /home/runner/.julia/packages/MTH229/6VRYU/src/MTH229.jl:1
in expression starting at stdin:1</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: Failed to precompile MTH229 [ebaf19f5-aa55-568f-9bb2-d6722dad893b] to /home/runner/.julia/compiled/v1.8/MTH229/jl_6BsmHA.</code></pre>
</div>
</div>
<p>Single-variable calculus has two main concepts: the derivative and the integral, both defined in terms of a third important concept: the limit. The derivative is what we discuss here. The derivative allows us to talk about a tangent line to a curve. This is often called a line that touches the curve at just one point, but that isn‚Äôt quite correct, though often the case locally. A better idea would be to say it is the line that best approximates the curve at that point. That is, if we were to zoom in to the graph it might appear to look straight, and that straightness would have a slope that would match the tangent line. This idea leads to a primary use of the derivative ‚Äì to approximate functions with simpler lines. Of course, this intuition is informal, a definition is in terms of the slope of approximating secant lines.</p>
<p>Historically, Fermat, in a treatise on finding maxima and minima, approached the problem of finding the tangent line by comparing the value of <span class="math inline">\(f(x)\)</span> to a nearby value <span class="math inline">\(f(x+h)\)</span>. Working with polynomials, meant that subtracting <span class="math inline">\(f(x+h) - f(x)\)</span> led to a polynomial in <span class="math inline">\(h\)</span>. Dividing by <span class="math inline">\(h\)</span> and then setting <span class="math inline">\(h=0\)</span> yields an answer for the slope.</p>
<p>The more modern approach (well Cauchy in the 1820s) defines the derivative of a function, <span class="math inline">\(f\)</span>, at a point <span class="math inline">\(c\)</span> as the slope of the <em>tangent line</em>, defined in terms of the <em>limit</em> of the slopes of approximating secant lines. The notation is:</p>
<p><span class="math display">\[
f'( c ) = \lim_{h \rightarrow 0} \frac{f(c + h) - f( c)}{h}.\quad\text{Derivative at a point}
\]</span></p>
<p>As mentioned, intuitively, the tangent line is the best straight-line approximation to a function near the point <span class="math inline">\((c, f( c))\)</span> and would have slope given by the derivative.</p>
<p>This graph shows <span class="math inline">\(f(x) = 2 - x^2\)</span> and various secant lines when <span class="math inline">\(c=-0.75\)</span>.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fl">2</span> <span class="op">-</span> x<span class="op">^</span><span class="fl">2</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="op">-</span><span class="fl">0.75</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sec_line</span>(h) <span class="op">=</span> <span class="fu">secant</span>(f, c, c<span class="op">+</span>h)                <span class="co"># secant in MTH229 package</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, legend<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(<span class="fu">sec_line</span>(<span class="fl">1</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(<span class="fu">sec_line</span>(<span class="fl">0.75</span>))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(<span class="fu">sec_line</span>(<span class="fl">0.5</span>))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(<span class="fu">sec_line</span>(<span class="fl">0.25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
<p>As the value of <span class="math inline">\(h\)</span> goes towards 0 along the path <span class="math inline">\(1\)</span>, <span class="math inline">\(0.75\)</span>, <span class="math inline">\(0.5\)</span>, <span class="math inline">\(0.25\)</span>, ‚Ä¶ the slope of the secant line heads towards the slope of the tangent line, in this case <span class="math inline">\(2\cdot 0.75 = 1.5\)</span>.</p>
<p>Using the idea of a derivative at a point, one defines the derivative of the function <span class="math inline">\(f\)</span> to be the function which for each <span class="math inline">\(x\)</span> returns the derivative of <span class="math inline">\(f\)</span> at the point <span class="math inline">\(x\)</span>. Notationally, this just replaces <span class="math inline">\(c\)</span> above with <span class="math inline">\(x\)</span>, but conceptually there is a bit more to it.</p>
</section>
<section id="forward-difference-quotients-slope-of-the-tangent-line" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="forward-difference-quotients-slope-of-the-tangent-line"><span class="header-section-number">6.2</span> Forward difference quotients, Slope of the tangent line</h2>
<p>The rules of derivatives allow for a mechanical approach to taking derivatives with the power rule, chain rule and some special cases. In this project we look at approaching the derivative numerically. We start by investigating <em>approximate derivatives</em> computed with <em>finite difference quotients</em>.</p>
<p>The most naive approximation is simply to assume <span class="math inline">\(h\)</span> is some small number and use that to approximate the limit above:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">2</span>x; <span class="fu">fp</span>(x) <span class="op">=</span> <span class="fl">2</span>x <span class="op">-</span> <span class="fl">2</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="fl">.001</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">3</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>( <span class="fu">f</span>(c <span class="op">+</span> h) <span class="op">-</span> <span class="fu">f</span>(c) ) <span class="op">/</span> h</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>4.000999999999699</code></pre>
</div>
</div>
<p>This is known as the <em>forward difference quotient</em> approximation to the derivative. For this example, the difference between the approximation and the actual slope is:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>( <span class="fu">f</span>(c <span class="op">+</span> h) <span class="op">-</span> <span class="fu">f</span>(c) ) <span class="op">/</span> h <span class="op">-</span> <span class="fu">fp</span>(c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>0.0009999999996992415</code></pre>
</div>
</div>
<p>That is not too close, just to 3 digits of accuracy.</p>
<p>Notationally, we may write this as:</p>
<p><span class="math display">\[
f'( c) \approx \frac{f(c + h) - f( c) }{h}
\]</span></p>
<p>For some small value of <span class="math inline">\(h\)</span>. The equals sign is replaced by an approximation symbol, as there is no limit expression written.</p>
<section id="example-derivative-at-a-point" class="level5">
<h5 class="anchored" data-anchor-id="example-derivative-at-a-point">Example Derivative at a point</h5>
<p>Let‚Äôs try the derivative of some well known function. We know the derivative of <span class="math inline">\(f(x) = \sin(x)\)</span> is <span class="math inline">\(f'(x) = \cos(x)\)</span>. Let‚Äôs see if the above works well:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">sin</span>(x); <span class="fu">fp</span>(x) <span class="op">=</span> <span class="fu">cos</span>(x)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="cn">pi</span><span class="op">/</span><span class="fl">4</span>; h <span class="op">=</span> <span class="fl">0.0001</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>( <span class="fu">f</span>(c <span class="op">+</span> h) <span class="op">-</span> <span class="fu">f</span>(c) )<span class="op">/</span>h <span class="op">-</span> <span class="fu">fp</span>(c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>-3.535651724428934e-5</code></pre>
</div>
</div>
<p>Not as good as we can get ‚Äì the error is like <code>1e-5</code>, but not too bad already.</p>
</section>
<section id="example-finding-profit" class="level5">
<h5 class="anchored" data-anchor-id="example-finding-profit">Example Finding profit</h5>
<p>Suppose the tractor company John Deere models its profit per units sold through the function <span class="math inline">\(P(x) = 50 e^{x/250}/(1 - e^{x/250})\)</span>. Find the marginal profit for <span class="math inline">\(x=200\)</span>.</p>
<p>The marginal profit is the change in profit per unit sold ‚Äì or the derivative ‚Äì at <span class="math inline">\(x=200\)</span>. We can find this quite simply by either differentiating directly, or as we do here, approximating the answer with <code>julia</code>. We first note that the function above, is a composition, so it may be written using two functions:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f1</span>(x) <span class="op">=</span> <span class="fu">exp</span>(x)<span class="op">/</span>(<span class="fl">1</span> <span class="op">-</span> <span class="fu">exp</span>(x))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fl">50</span> <span class="op">*</span> <span class="fu">f1</span>(x<span class="op">/</span><span class="fl">250</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">200</span>; h <span class="op">=</span> <span class="fl">0.0001</span>;</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> (<span class="fu">f</span>(c<span class="op">+</span>h) <span class="op">-</span> <span class="fu">f</span>(c))<span class="op">/</span>h</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>0.29635326299626286</code></pre>
</div>
</div>
<p>If <span class="math inline">\(50\)</span> is the maximum profit, this is a percentage increase of:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(res<span class="op">/</span><span class="fl">50</span>) <span class="op">*</span> <span class="fl">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>0.5927065259925257</code></pre>
</div>
</div>
<p>or a bit more than half a percent.</p>
</section>
<section id="example-finding-the-tangent-line-at-a-point" class="level5">
<h5 class="anchored" data-anchor-id="example-finding-the-tangent-line-at-a-point">Example Finding the tangent line at a point</h5>
<p>Let <span class="math inline">\(f(x) = x^x\)</span>. Find the tangent line at <span class="math inline">\(c=2\)</span>. Compare the difference between the value of the tangent line and the function at <span class="math inline">\(x=2.1\)</span>.</p>
<p>The tangent line is most easily expressed in terms of the <em>point-slope</em> formula for a line where the point is <span class="math inline">\((c, f( c))\)</span> and the slope is <span class="math inline">\(f'( c)\)</span>. This gives:</p>
<p><span class="math display">\[
y = f( c) + f'( c)\cdot(x - c)
\]</span></p>
<p>In the following, the slope of the tangent line will be <em>approximated</em> using a numeric derivative. We use <span class="math inline">\(h=0.0001\)</span>:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span>x</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">2</span>; h <span class="op">=</span> <span class="fl">0.0001</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> ( <span class="fu">f</span>(c <span class="op">+</span> h) <span class="op">-</span> <span class="fu">f</span>(c) ) <span class="op">/</span> h</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tangent_line</span>(x) <span class="op">=</span> <span class="fu">f</span>(c) <span class="op">+</span> m <span class="op">*</span> (x <span class="op">-</span> c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>tangent_line (generic function with 1 method)</code></pre>
</div>
</div>
<p>To compare the difference, we have:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(<span class="fl">2.1</span>) <span class="op">-</span> <span class="fu">tangent_line</span>(<span class="fl">2.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>0.07231187980696063</code></pre>
</div>
</div>
<p>A graph shows this difference:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>([f, tangent_line], <span class="fl">1.85</span>, <span class="fl">2.15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
</section>
<section id="practice" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="practice"><span class="header-section-number">6.2.1</span> Practice</h3>
<section id="question" class="level4">
<h4 class="anchored" data-anchor-id="question">Question</h4>
<p>Find the slope of the tangent line of <span class="math inline">\(f(x) = x\log(x)\)</span> at the value <span class="math inline">\(x=1\)</span> using <span class="math inline">\(h=0.0001\)</span> and the forward difference quotient method:</p>
<div class="cell" data-execution_count="13">
<div class="cell-output cell-output-display" data-execution_count="14">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="XiPKCRv7" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_XiPKCRv7">
        <div style="padding-top: 5px">
    <br>
<div class="input-group">
    <input id="XiPKCRv7" type="number" class="form-control" placeholder="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="XiPKCRv7_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.getElementById("XiPKCRv7").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 1.0000499983333064) <= 1.0e-6);
  var msgBox = document.getElementById('XiPKCRv7_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_XiPKCRv7")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_XiPKCRv7")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>
</div>
</div>
</section>
<section id="question-1" class="level4">
<h4 class="anchored" data-anchor-id="question-1">Question</h4>
<p>Find the slope of the tangent line of <span class="math inline">\(f(x) = x-\log(x)\)</span> at the value <span class="math inline">\(x=1\)</span> using <span class="math inline">\(h=0.0001\)</span> and the forward difference quotient method:</p>
<div class="cell" data-execution_count="14">
<div class="cell-output cell-output-display" data-execution_count="15">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="hQ6phsgZ" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_hQ6phsgZ">
        <div style="padding-top: 5px">
    <br>
<div class="input-group">
    <input id="hQ6phsgZ" type="number" class="form-control" placeholder="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="hQ6phsgZ_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.getElementById("hQ6phsgZ").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 4.999666680660653e-5) <= 1.0e-6);
  var msgBox = document.getElementById('hQ6phsgZ_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_hQ6phsgZ")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_hQ6phsgZ")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>
</div>
</div>
</section>
<section id="question-2" class="level4">
<h4 class="anchored" data-anchor-id="question-2">Question</h4>
<p>The built-in <code>airyai</code> function, when called as <code>airyai(x)</code>, returns the so-called Airy function, a special function named after</p>
<p><a href="http://en.wikipedia.org/wiki/Airy_function">George Biddell Airy</a>.</p>
<p>Compute the derivative at <span class="math inline">\(c=-3\)</span> using <span class="math inline">\(h=0.0001\)</span>.</p>
<div class="cell" data-execution_count="15">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: airyai not defined</code></pre>
</div>
</div>
</section>
<section id="question-3" class="level4">
<h4 class="anchored" data-anchor-id="question-3">Question</h4>
<p>Let <span class="math inline">\(f(x) = \sin(x)\)</span>. The slope of the tangent line at <span class="math inline">\(c=\pi/4\)</span> is well known to have slope <span class="math inline">\(\sqrt{2}/2\)</span>.</p>
<p>Compute the forward difference quotient for <span class="math inline">\(f\)</span> at <span class="math inline">\(c\)</span> using <span class="math inline">\(h=0.01\)</span>. What is the order of the difference between the two values?</p>
<div class="cell" data-execution_count="16">
<div class="cell-output cell-output-display" data-execution_count="17">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="k8vauzP1" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_k8vauzP1">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_k8vauzP1_1">
      <input class="form-check-input" type="radio" name="radio_k8vauzP1" id="radio_k8vauzP1_1" value="1">
      
      <span class="label-body px-1">
        3 parts in 100
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_k8vauzP1_2">
      <input class="form-check-input" type="radio" name="radio_k8vauzP1" id="radio_k8vauzP1_2" value="2">
      
      <span class="label-body px-1">
        3 parts in 1000
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_k8vauzP1_3">
      <input class="form-check-input" type="radio" name="radio_k8vauzP1" id="radio_k8vauzP1_3" value="3">
      
      <span class="label-body px-1">
        3 parts in 10,000
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_k8vauzP1_4">
      <input class="form-check-input" type="radio" name="radio_k8vauzP1" id="radio_k8vauzP1_4" value="4">
      
      <span class="label-body px-1">
        3 parts in 100,000
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="k8vauzP1_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_k8vauzP1"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('k8vauzP1_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_k8vauzP1")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_k8vauzP1")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
<section id="question-4" class="level4">
<h4 class="anchored" data-anchor-id="question-4">Question</h4>
<p>For the function <span class="math inline">\(f(x) = x^3 - 5x\)</span> use a forward difference quotient with <span class="math inline">\(h=0.0001\)</span> to approximate the slope of the tangent line at <span class="math inline">\(c=1\)</span>. Use this value to create a tangent line at <code>(c, f( c))</code>. Plot both the function and the tangent. Estimate graphically where the tangent line crosses the <span class="math inline">\(x\)</span> axis. The value is near:</p>
<div class="cell" data-execution_count="17">
<div class="cell-output cell-output-display" data-execution_count="18">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="qfF6sbNI" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_qfF6sbNI">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_qfF6sbNI_1">
      <input class="form-check-input" type="radio" name="radio_qfF6sbNI" id="radio_qfF6sbNI_1" value="1">
      
      <span class="label-body px-1">
        -2.0
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_qfF6sbNI_2">
      <input class="form-check-input" type="radio" name="radio_qfF6sbNI" id="radio_qfF6sbNI_2" value="2">
      
      <span class="label-body px-1">
        -1.5
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_qfF6sbNI_3">
      <input class="form-check-input" type="radio" name="radio_qfF6sbNI" id="radio_qfF6sbNI_3" value="3">
      
      <span class="label-body px-1">
        -1.0
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_qfF6sbNI_4">
      <input class="form-check-input" type="radio" name="radio_qfF6sbNI" id="radio_qfF6sbNI_4" value="4">
      
      <span class="label-body px-1">
        -0.5
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_qfF6sbNI_5">
      <input class="form-check-input" type="radio" name="radio_qfF6sbNI" id="radio_qfF6sbNI_5" value="5">
      
      <span class="label-body px-1">
        0.0
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_qfF6sbNI_6">
      <input class="form-check-input" type="radio" name="radio_qfF6sbNI" id="radio_qfF6sbNI_6" value="6">
      
      <span class="label-body px-1">
        1.0
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="qfF6sbNI_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_qfF6sbNI"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 3;
    var msgBox = document.getElementById('qfF6sbNI_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_qfF6sbNI")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_qfF6sbNI")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
</section>
</section>
<section id="derivative-of-a-function" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="derivative-of-a-function"><span class="header-section-number">6.3</span> Derivative of a function</h2>
<p>We might be interested not in the derivative at a point, but in the derivative as a function. This is how we think of the derivative when we say if <span class="math inline">\(f(x) = \sin(x)\)</span>, the <span class="math inline">\(f'(x) = \cos(x)\)</span>. Mathematically, from this viewpoint, the derivative is referred to as an <em>operator</em>, as it takes a function and returns a function.</p>
<p>We can reproduce this behavior easily enough with <code>julia</code>, as functions are <em>first class objects</em>: they can be passed as arguments and returned as values.</p>
<p>First, let‚Äôs define a function to find the derivative at a point using the ‚Äúforward difference quotient‚Äù:</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">forward_difference</span>(f, x0, h) <span class="op">=</span> (<span class="fu">f</span>(x0 <span class="op">+</span> h) <span class="op">-</span> <span class="fu">f</span>(x0))<span class="op">/</span>h</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>forward_difference (generic function with 1 method)</code></pre>
</div>
</div>
<p>We need three arguments of course as we have three ingredients to worry about: the function, the point and the size of <span class="math inline">\(h\)</span>.</p>
<p>To make an operator that takes <span class="math inline">\(f\)</span> and returns a function (an anonymous function in this case) that computes our approximation to <span class="math inline">\(f'\)</span> we can do the following:</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Df</span>(f; h<span class="op">=</span><span class="fl">1e-8</span>) <span class="op">=</span> x <span class="op">-&gt;</span> <span class="fu">forward_difference</span>(f, x, h)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>Df (generic function with 1 method)</code></pre>
</div>
</div>
<p>We specified a default value of <span class="math inline">\(h\)</span> for convenience, but allow it to be varied if desired.</p>
<p>To see this work, we can find and plot the derivative of <span class="math inline">\(\sin(x)\)</span>:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">sin</span>(x)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> <span class="fu">Df</span>(f)(x)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="fl">0</span>, <span class="fl">2</span>pi)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(fp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
<p>Well, we already knew that should just be <span class="math inline">\(\cos(x)\)</span>. The point is we can easily make the an approximate derivative function from <code>f</code> with the definition <code>fp(x) = Df(f)(x)</code>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Parsing Df(f)(x)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Seeing the pair of parenthesis can lead to confusion, as it isn‚Äôt common math notation. Here parentheses are not used for grouping, but rather function application. There are two function applications and the associativity rules for function application are left to right, as with most ‚Äì but not all ‚Äì operations. So <code>Df(f)</code> is done first. This returns a function (the approximate derivative) which is then evaluated at <code>x</code>.</p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Defining <code>fp</code> or <code>fp(x)</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>We could also have just plotted <code>f</code> and <code>Df(f)</code> without naming <code>fp</code>. As well, could have written <code>fp = Df(f)</code>, but that creates <code>fp</code> as an <em>anonymous</em> function and we then couldn‚Äôt redefine it through <code>fp(x) = ...</code>, which would attempt to make it a <em>generic</em> function.</p>
</div>
</div>
<p>Let‚Äôs look at a different function, where we don‚Äôt know in our heads the answer.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">exp</span>(x)<span class="op">/</span>(<span class="fl">1</span> <span class="op">+</span> <span class="fu">exp</span>(x))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="fl">0</span>, <span class="fl">5</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(<span class="fu">Df</span>(f))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
<p>If we look, we can see from the graph that <code>f</code> is increasing and <code>Df(f)</code> is positive ‚Äì this is no coincidence, of course.</p>
<section id="example-critical-points" class="level5">
<h5 class="anchored" data-anchor-id="example-critical-points">Example: Critical points</h5>
<p>A function‚Äôs <em>critical points</em> are where its derivative is <span class="math inline">\(0\)</span> or undefined. We can examine these by graphing the function‚Äôs derivative. Let‚Äôs do so for the polynomial <span class="math inline">\(f(x) = x^3 - 5x + 4\)</span>:</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">3</span> <span class="op">-</span><span class="fl">5</span>x <span class="op">+</span> <span class="fl">4</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> <span class="fu">Df</span>(f)(x)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fp, <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
<p>You can check the zeroes graphically, say by zooming in a bit and adding the line <span class="math inline">\(y=0\)</span>:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fp, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(zero)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
<p>If you want, we can find the roots numerically. For example,</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">find_zeros</span>(fp, <span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: find_zeros not defined</code></pre>
</div>
</div>
</section>
<section id="example-when-is-a-function-increasing" class="level5">
<h5 class="anchored" data-anchor-id="example-when-is-a-function-increasing">Example: When is a function increasing?</h5>
<p>Let <span class="math inline">\(f(x) = \cos(x)\)</span> over the interval <span class="math inline">\([0, 360]\)</span> (in degrees). When is the function increasing?</p>
<p>From the relationship of the derivative and the function, we know the answer is when <span class="math inline">\(f'(x) &gt; 0\)</span>. For this example, we can solve this directly as <span class="math inline">\(f'(x) = -\sin(x)\)</span> and we know when that is positive (well you are supposed to anyways: when the angle is in the third and fourth quadrants). Let‚Äôs see how we would do this task with <code>julia</code> and compare.</p>
<p>First, we only need the derivative, so we just ask:</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">cosd</span>(x)          <span class="co"># using degrees</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> <span class="fu">Df</span>(f)(x)                <span class="co"># use default h</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>fp (generic function with 1 method)</code></pre>
</div>
</div>
<p>Then we wish to indicate on the graph where <code>fp(x) &gt; 0</code>. We can do this by defining a function that is <span class="math inline">\(0\)</span> when that is the case and <code>NaN</code> otherwise (so that those points are not plotted). We do so below using the <code>plotif</code> function from the <code>MTH229</code> package</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotif</span>(f, fp, <span class="fl">0</span>, <span class="fl">360</span>)  <span class="co"># second color when fp &gt; 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plotif not defined</code></pre>
</div>
</div>
</section>
<section id="practice-1" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="practice-1"><span class="header-section-number">6.3.1</span> Practice</h3>
<section id="question-5" class="level4">
<h4 class="anchored" data-anchor-id="question-5">Question</h4>
<p>Let <span class="math inline">\(f(x) = e^x\)</span>. Using a forward difference quotient and <span class="math inline">\(h=0.001\)</span> graph both the function and its approximate derivative over the interval <span class="math inline">\([0, 3]\)</span>. Estimate graphically the largest difference between the function and its approximate derivative.</p>
<div class="cell" data-execution_count="27">
<div class="cell-output cell-output-display" data-execution_count="28">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="NVJrVEPS" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_NVJrVEPS">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_NVJrVEPS_1">
      <input class="form-check-input" type="radio" name="radio_NVJrVEPS" id="radio_NVJrVEPS_1" value="1">
      
      <span class="label-body px-1">
        It is about 0.1
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_NVJrVEPS_2">
      <input class="form-check-input" type="radio" name="radio_NVJrVEPS" id="radio_NVJrVEPS_2" value="2">
      
      <span class="label-body px-1">
        It is about 0.01
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_NVJrVEPS_3">
      <input class="form-check-input" type="radio" name="radio_NVJrVEPS" id="radio_NVJrVEPS_3" value="3">
      
      <span class="label-body px-1">
        It is about 0
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="NVJrVEPS_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_NVJrVEPS"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('NVJrVEPS_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_NVJrVEPS")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_NVJrVEPS")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
<section id="question-6" class="level4">
<h4 class="anchored" data-anchor-id="question-6">Question</h4>
<p>Let <span class="math inline">\(f(x) = x^2 \exp(-x)\)</span>. Using <span class="math inline">\(h=0.0001\)</span> and an approximate derivative, estimate graphically where <span class="math inline">\(f'(x)\)</span> is positive on the interval <span class="math inline">\([0,3]\)</span>.</p>
<div class="cell" data-execution_count="28">
<div class="cell-output cell-output-display" data-execution_count="29">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="KnyBqEZ5" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_KnyBqEZ5">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_KnyBqEZ5_1">
      <input class="form-check-input" type="radio" name="radio_KnyBqEZ5" id="radio_KnyBqEZ5_1" value="1">
      
      <span class="label-body px-1">
        From 0 to about 0.45
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_KnyBqEZ5_2">
      <input class="form-check-input" type="radio" name="radio_KnyBqEZ5" id="radio_KnyBqEZ5_2" value="2">
      
      <span class="label-body px-1">
        Between 0 and 2
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_KnyBqEZ5_3">
      <input class="form-check-input" type="radio" name="radio_KnyBqEZ5" id="radio_KnyBqEZ5_3" value="3">
      
      <span class="label-body px-1">
        It is for the entire interval
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="KnyBqEZ5_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_KnyBqEZ5"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('KnyBqEZ5_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_KnyBqEZ5")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_KnyBqEZ5")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
<section id="question-7" class="level4">
<h4 class="anchored" data-anchor-id="question-7">Question</h4>
<p>The critical points of a function are where its derivative is undefined or where its derivative is <span class="math inline">\(0\)</span>. For the function <span class="math inline">\(f(x) = 3x^4 -28x^3 + 96x^2 - 144x\)</span> graphically find any critical points over the interval <span class="math inline">\([0,10]\)</span></p>
<div class="cell" data-execution_count="29">
<div class="cell-output cell-output-display" data-execution_count="30">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="GJAmUbci" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_GJAmUbci">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_GJAmUbci_1">
      <input class="form-check-input" type="radio" name="radio_GJAmUbci" id="radio_GJAmUbci_1" value="1">
      
      <span class="label-body px-1">
        There are two distinct ones: 2, 3
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_GJAmUbci_2">
      <input class="form-check-input" type="radio" name="radio_GJAmUbci" id="radio_GJAmUbci_2" value="2">
      
      <span class="label-body px-1">
        There are two distinct ones: 2, 4.69
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_GJAmUbci_3">
      <input class="form-check-input" type="radio" name="radio_GJAmUbci" id="radio_GJAmUbci_3" value="3">
      
      <span class="label-body px-1">
        There are two distinct ones: 2, 2.6667
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_GJAmUbci_4">
      <input class="form-check-input" type="radio" name="radio_GJAmUbci" id="radio_GJAmUbci_4" value="4">
      
      <span class="label-body px-1">
        There is one at 3
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="GJAmUbci_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_GJAmUbci"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 1;
    var msgBox = document.getElementById('GJAmUbci_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_GJAmUbci")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_GJAmUbci")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
</section>
</section>
<section id="improvements-to-the-basic-forward-difference-quotient" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="improvements-to-the-basic-forward-difference-quotient"><span class="header-section-number">6.4</span> Improvements to the basic forward difference quotient</h2>
<p>The error in the approximation of the derivative depends on the size of <span class="math inline">\(h\)</span>. Mathematically, as <span class="math inline">\(h\)</span> gets smaller we get better approximations, though with the computer other complications arise. To see mathematically that this is the case, let‚Äôs look at the difference between the approximate numeric derivative from the forward difference quotient and a known derivative.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">sin</span>(x)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> <span class="fu">cos</span>(x)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>[ <span class="fu">Df</span>(f,h<span class="op">=</span>h)(<span class="fl">.5</span>) <span class="op">-</span> <span class="fu">fp</span>(<span class="fl">.5</span>) for h<span class="op">=</span>[<span class="fl">.1</span>, <span class="fl">.01</span>, <span class="fl">.001</span>, <span class="fl">.0001</span>, <span class="fl">.00001</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>5-element Vector{Float64}:
 -0.0254132139820491
 -0.0024117340199198978
 -0.00023985901305767499
 -2.3972739644051444e-5
 -2.3971472203898614e-6</code></pre>
</div>
</div>
<p>It gets better as <span class="math inline">\(h\)</span> gets smaller. In fact, it looks like when <span class="math inline">\(h\)</span> gets smaller by a factor of <span class="math inline">\(1/10\)</span> so does the error. Let‚Äôs look a little deeper though. Rather than type in the values of <span class="math inline">\(h\)</span> as above, let‚Äôs use an expression to compute them. Here we find the powers <span class="math inline">\(10^{-1}, \dots, 10^{-16}\)</span> at once and then compute the differences:</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>hs <span class="op">=</span> [(<span class="fl">1</span><span class="op">/</span><span class="fl">10</span>)<span class="op">^</span>i for i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">16</span>];</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> [ <span class="fu">Df</span>(f,h<span class="op">=</span>h)(<span class="fl">.5</span>) <span class="op">-</span> <span class="fu">fp</span>(<span class="fl">.5</span>) for h <span class="kw">in</span> hs ];</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>[hs out]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>16√ó2 Matrix{Float64}:
 0.1      -0.0254132
 0.01     -0.00241173
 0.001    -0.000239859
 0.0001   -2.39727e-5
 1.0e-5   -2.39715e-6
 1.0e-6   -2.3969e-7
 1.0e-7   -2.4695e-8
 1.0e-8    2.85032e-10
 1.0e-9    2.85032e-10
 1.0e-10  -1.10737e-7
 1.0e-11  -1.22096e-6
 1.0e-12  -6.77208e-6
 1.0e-13   4.87391e-5
 1.0e-14  -0.000506372
 1.0e-15   0.0105959
 1.0e-16   0.23264</code></pre>
</div>
</div>
<p>When we look, we see that for awhile the approximation gets better (to about <code>1e-9</code>), but then does a U-turn and starts getting worse. The mathematical approximation gets better and better, but what happens is the computational error gets worse. We‚Äôll see below how to pick the <span class="math inline">\(h\)</span> that best balances these off, but first lets look at how using different approximations for the derivative can improve the ‚Äúmathematical‚Äù error.</p>
<section id="central-difference-quotient" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="central-difference-quotient"><span class="header-section-number">6.4.1</span> Central difference quotient</h3>
<p>It turns out that just by looking to the left and the right we can improve the mathematical error from getting better at a rate of <span class="math inline">\(h\)</span> to a rate of <span class="math inline">\(h^2\)</span>, provided our function is smooth enough and we don‚Äôt have issues on the boundaries. The formula, called the <em>central difference quotient</em> approximation to the derivative is:</p>
<p><span class="math display">\[
f'(x) \approx \frac{ f(x + h) - f(x - h) }{2h}
\]</span></p>
<p>For this the mathematical error is like <span class="math inline">\(h^2\)</span>, not <span class="math inline">\(h\)</span>.</p>
<p>Let‚Äôs compare. To make our life easier we again create some functions, as we did with <code>Df</code> above.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">central_difference</span>(f, x0, h) <span class="op">=</span> (<span class="fu">f</span>(x0 <span class="op">+</span> h) <span class="op">-</span> <span class="fu">f</span>(x0 <span class="op">-</span> h)) <span class="op">/</span> (<span class="fl">2</span>h)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Dc</span>(f; h<span class="op">=</span><span class="fl">0.0001</span>) <span class="op">=</span> x <span class="op">-&gt;</span> <span class="fu">central_difference</span>(f, x, h)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>Dc (generic function with 1 method)</code></pre>
</div>
</div>
<p>Now to see whether a forward difference quotient or central difference quotient works better. We can do so with a table. Again with <span class="math inline">\(f(x) = \sin(x)\)</span></p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">sin</span>(x)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> <span class="fu">cos</span>(x)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>using_D <span class="op">=</span>  [ <span class="fu">Df</span>(f,h<span class="op">=</span>h)(<span class="fl">.5</span>) <span class="op">-</span> <span class="fu">fp</span>(<span class="fl">.5</span>) for h <span class="kw">in</span> hs ];</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>using_Dc <span class="op">=</span> [ <span class="fu">Dc</span>(f,h<span class="op">=</span>h)(<span class="fl">.5</span>) <span class="op">-</span> <span class="fu">fp</span>(<span class="fl">.5</span>) for h <span class="kw">in</span> hs ];</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>[hs using_D using_Dc]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>16√ó3 Matrix{Float64}:
 0.1      -0.0254132    -0.00146191
 0.01     -0.00241173   -1.46263e-5
 0.001    -0.000239859  -1.46264e-7
 0.0001   -2.39727e-5   -1.46274e-9
 1.0e-5   -2.39715e-6   -1.75036e-11
 1.0e-6   -2.3969e-7     7.47635e-12
 1.0e-7   -2.4695e-8    -2.70079e-10
 1.0e-8    2.85032e-10   2.85032e-10
 1.0e-9    2.85032e-10   2.85032e-10
 1.0e-10  -1.10737e-7   -1.10737e-7
 1.0e-11  -1.22096e-6   -1.22096e-6
 1.0e-12  -6.77208e-6   -6.77208e-6
 1.0e-13   4.87391e-5    4.87391e-5
 1.0e-14  -0.000506372  -0.000506372
 1.0e-15   0.0105959     0.0105959
 1.0e-16   0.23264       0.23264</code></pre>
</div>
</div>
<p>The errors for the central difference quotient are either much smaller for the same size <span class="math inline">\(h\)</span> or the same. We see that we can use a larger <span class="math inline">\(h\)</span> to get the most accuracy in this example.</p>
<section id="example-when-does-the-tangent-line-hit-0" class="level5">
<h5 class="anchored" data-anchor-id="example-when-does-the-tangent-line-hit-0">Example: When does the tangent line hit 0?</h5>
<p>Let <span class="math inline">\(f(x) = 10/(1+x^2) - 10\exp(-(1/2)x^2)\)</span>. The tangent line at <span class="math inline">\(x=c\)</span> is given by</p>
<p><span class="math display">\[
y = f( c) - f'( c)(x - c)
\]</span></p>
<p>and this intersects the <span class="math inline">\(x\)</span> axis when <span class="math inline">\(y=0\)</span>. Solving this gives:</p>
<p><span class="math display">\[
c - f( c)/f'( c)
\]</span></p>
<p>Our goal is to compute this value for any <span class="math inline">\(c &gt; 0\)</span>.</p>
<p>Doing so is easy:</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fl">10</span><span class="op">/</span>(<span class="fl">1</span><span class="op">+</span>x<span class="op">^</span><span class="fl">2</span>) <span class="op">-</span> <span class="fl">10</span><span class="fu">*exp</span>(<span class="fu">-</span>(<span class="fl">1</span><span class="op">/</span><span class="fl">2</span>)<span class="op">*</span>x<span class="op">^</span><span class="fl">2</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> <span class="fu">Dc</span>(f)(x)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">intersection_point</span>(c) <span class="op">=</span> c <span class="op">-</span> <span class="fu">f</span>(c)<span class="op">/</span><span class="fu">fp</span>(c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>intersection_point (generic function with 1 method)</code></pre>
</div>
</div>
<p>For example, when <span class="math inline">\(c=1\)</span> we have:</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">1</span>;</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">intersection_point</span>(c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>2.000000018978514</code></pre>
</div>
</div>
<p>You can tell from the graph of <span class="math inline">\(f(x)\)</span> that this value should be more than 1, as it is.</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="fl">.5</span>, <span class="fl">2.1</span>, legend<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(zero)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(x <span class="op">-&gt;</span> <span class="fu">f</span>(c) <span class="op">+</span> <span class="fu">fp</span>(c)<span class="fu">*</span>(x<span class="op">-</span>c))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
<hr>
<p>We could have defined <code>intersection_point</code> to accept a function with:</p>
<pre><code>intersection_point(f, c) = c  - f(c)/Dc(f)(c)</code></pre>
<p>Then it could easily be reused for other problems.</p>
</section>
</section>
<section id="practice-2" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="practice-2"><span class="header-section-number">6.4.2</span> Practice</h3>
<section id="question-8" class="level4">
<h4 class="anchored" data-anchor-id="question-8">Question</h4>
<p>Let</p>
<pre><code>f(x) = besselj(1, x)</code></pre>
<p>This defines <span class="math inline">\(f\)</span> as a Bessel function of the first kind with order <span class="math inline">\(\alpha=1\)</span>. Plot the approximate derivative over the interval <span class="math inline">\([0,5]\)</span>. There is one zero. What is its approximate value:</p>
<div class="cell" data-execution_count="37">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: besselj not defined</code></pre>
</div>
</div>
</section>
<section id="question-9" class="level4">
<h4 class="anchored" data-anchor-id="question-9">Question</h4>
<p>Let <span class="math inline">\(f(x) = \sin(\cos(x))\)</span>. Plot the approximate derivative of <span class="math inline">\(f\)</span>. How many zeros are there between <span class="math inline">\(5\)</span> and <span class="math inline">\(20\)</span>?</p>
<div class="cell" data-execution_count="38">
<div class="cell-output cell-output-display" data-execution_count="39">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="f7lNvaWi" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_f7lNvaWi">
        <div style="padding-top: 5px">
    <br>
<div class="input-group">
    <input id="f7lNvaWi" type="number" class="form-control" placeholder="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="f7lNvaWi_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.getElementById("f7lNvaWi").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 5) <= 1.0e-10);
  var msgBox = document.getElementById('f7lNvaWi_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_f7lNvaWi")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_f7lNvaWi")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>
</div>
</div>
</section>
<section id="question-10" class="level4">
<h4 class="anchored" data-anchor-id="question-10">Question</h4>
<p>Let <span class="math inline">\(f(x) = |x^2 - 2|\)</span>. Plot the derivative of <span class="math inline">\(f(x)\)</span> over the interval <span class="math inline">\([-2,2]\)</span>. How many critical points do you see? (A critical point is where the derivative is <span class="math inline">\(0\)</span> <em>or</em> undefined.)</p>
<div class="cell" data-execution_count="39">
<div class="cell-output cell-output-display" data-execution_count="40">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="tXRB4eqh" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_tXRB4eqh">
        <div style="padding-top: 5px">
    <br>
<div class="input-group">
    <input id="tXRB4eqh" type="number" class="form-control" placeholder="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="tXRB4eqh_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.getElementById("tXRB4eqh").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 3) <= 1.0e-10);
  var msgBox = document.getElementById('tXRB4eqh_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_tXRB4eqh")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_tXRB4eqh")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>
</div>
</div>
</section>
</section>
</section>
<section id="automatic-differentiation" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="automatic-differentiation"><span class="header-section-number">6.5</span> Automatic differentiation</h2>
<p>We discuss now <a href="http://en.wikipedia.org/wiki/Automatic_differentiation">Forward Mode Automatic Differentiation</a>.</p>
<p>Automatic differentiation avoids the numeric instability issues of finite difference quotients by using a different approach. Whereas finite difference quotientss have a long history, automatic differentiation only dates back to the 50s.</p>
<p>The <code>ForwardDiff</code> package implements automatic differentiation.</p>
<p>The <code>MTH229</code> package overloads the idea of <code>'</code>, so uses automatic differentiation when the notation <code>f'</code> is encountered.</p>
<p>That means, we can find derivatives, as familiarly as:</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span>x</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>f<span class="op">'</span>(<span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: MethodError: no method matching adjoint(::typeof(f))
[0mClosest candidates are:
[0m  adjoint([91m::Union{LinearAlgebra.QR, LinearAlgebra.QRCompactWY, LinearAlgebra.QRPivoted}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/qr.jl:517
[0m  adjoint([91m::Union{LinearAlgebra.Cholesky, LinearAlgebra.CholeskyPivoted}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/cholesky.jl:558
[0m  adjoint([91m::LinearAlgebra.Diagonal{var"#s884", V} where {var"#s884"&lt;:Number, V&lt;:AbstractVector{var"#s884"}}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/diagonal.jl:644
[0m  ...</code></pre>
</div>
</div>
<p>Here <code>f</code> is a function, <code>f'</code> is a derived function, and <code>f'(1)</code> is this derived function evaluated at <code>1</code> ‚Äì just as with the use within a math text book.</p>
<p>Unlike, finite difference quotients automatic differentiation does not have issues arising from the loss of precision encountered when subtracting two like-sized numbers. Unlike symbolic derivatives (such as those found by the Wolfram Alpha website used by your iPhone‚Äôs Siri) they can be computed quickly, even if the computations defining the function involve many steps.</p>
<p>So what is automatic differentiation? The idea of the forward mode is quite intuitive. The <em>tangent line</em> approximation of a function at the point <span class="math inline">\(c\)</span> becomes</p>
<p><span class="math display">\[
f(x) = f(c) + f'( c)(x-c) + O((x-c)^2)
\]</span></p>
<p>Where the notation <span class="math inline">\(O(x-c)^2\)</span> means that the last term is not precisely spelled out, but is like some constant times the difference <span class="math inline">\((x-c)^2\)</span>. This has many applications, but for this one it reduces the knowledge of the function values at this level to two values <span class="math inline">\((f(c), f'(c))\)</span></p>
<p>Now consider the product of two functions <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(x)\)</span>? The above formula applied to <span class="math inline">\(f \cdot g\)</span> is:</p>
<p><span class="math display">\[
(f\cdot g)(x) = f(c) \cdot g(c) + (f'( c)g( c) + f( c)g'( c))(x-c) + O((x-c)^2)
\]</span></p>
<p>This follows by the product rule. Again we have that two values determine the product <span class="math inline">\(f\cdot g\)</span> at this level, these being <span class="math inline">\((f(c) \cdot g(c)\)</span>, and <span class="math inline">\(f'( c)g( c) + f( c)g'( c)\)</span>. <em>But</em>, this combination can be made from the values <span class="math inline">\((f(c), f'(c))\)</span> and <span class="math inline">\((g(c), g'(c))\)</span> which represent <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span>. Hence it is enough to know the two values for <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> to compute the two values for <span class="math inline">\(f\cdot g\)</span>.</p>
<p>In fact, the rules of derivatives allow us to say the same for addition, subtraction, multiplication, division, powers <em>and</em> composition. For composition this is from the chain rule:</p>
<p><span class="math display">\[
(f \circ g)(x) = (f \circ g)(c) + f'( g(c)) g'(c) (x-c) + O((x-c)^2).
\]</span></p>
<p>Automatic differentiation can be implemented by extending how we store a value, storing both <span class="math inline">\((x, dx)\)</span> as above. With this, the rules of differentials inform us how we combine these values. For example:</p>
<ul>
<li><span class="math display">\[
(x, dx) + (y, dy) = (x + y, d(x+y)) = (x + y, 1dx +  1dy)
\]</span></li>
<li><span class="math display">\[
(x, dx) \cdot (y, dy) = (xy, d(xy)) = (xy, y dx + x dy)
\]</span></li>
<li><span class="math display">\[
(x, dx)^n = (x^n, d(x^n)) = (x^n, n x^{n-1} dx)
\]</span></li>
</ul>
<p>etc.</p>
<p>For functions we need to use the chain rule:</p>
<ul>
<li><span class="math display">\[
f((x, dx)) = (f(x), d(f(x))) = (f(x), f'(x) dx )
\]</span></li>
</ul>
<section id="examples" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="examples"><span class="header-section-number">6.5.1</span> Examples</h3>
<p>Using <code>'</code>, we see that plotting a function and its derivative is straightforward:</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">exp</span>(<span class="op">-</span>x)<span class="fu">*sin</span>(x)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="fl">0</span>, <span class="fl">2</span>pi)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(f<span class="op">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
<p>Second derivatives are also available:</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">2</span>x</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(f<span class="op">'</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(f<span class="op">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
<p>Here is an example where we plot the tangent line and the function. The <code>MTH229</code> package provides this function to compute a tangent line function:</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tangent</span>(f, c) <span class="op">=</span> x <span class="op">-&gt;</span> <span class="fu">f</span>(c) <span class="op">+</span> f<span class="op">'</span>(c)<span class="fu">*</span>(x<span class="op">-</span>c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is employed as follows:</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span>x</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">2</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(<span class="fu">tangent</span>(f, c))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
<hr>
<section id="example-ap-calculus-question" class="level5">
<h5 class="anchored" data-anchor-id="example-ap-calculus-question">Example: AP Calculus question</h5>
<p>The 2014 AP Calculus exam included this question:</p>
<p>Grass clippings are placed in a bin, where they decompose. For <span class="math inline">\(0 \leq t \leq 30\)</span>, the amount of grass clippings remaining in the bin is modeled by <span class="math inline">\(A(t) = 6.687(0.931)^t\)</span>. Where <span class="math inline">\(A(t)\)</span> is measured in pounds and <span class="math inline">\(t\)</span> is measured in days.</p>
<ul>
<li>Find the average rate of change of <span class="math inline">\(A(t)\)</span> over the interval of <span class="math inline">\(0 \leq t \leq 30\)</span>. Indicate units of measure.</li>
<li>Find the value of <span class="math inline">\(A'(15)\)</span>. Using correct units, interpret the meaning of the value in the context of the problem.</li>
<li>Find the time <span class="math inline">\(t\)</span> for which the amount of grass clippings in the bin is equal to the average amount of grass clippings in the bin over the interval <span class="math inline">\(0 \leq t \leq 30\)</span>.</li>
<li>For <span class="math inline">\(t &gt; 30\)</span>, <span class="math inline">\(L(t)\)</span>, the linear approximation to <span class="math inline">\(A\)</span> at <span class="math inline">\(t=30\)</span> is a better model for the amount of grass clippings remaining in the bin. Use <span class="math inline">\(L(t)\)</span> to predict the time at which there will be 0.5% pound of grass clippings remaining in the bin. Show the work that leads to your answer.</li>
</ul>
<p>We can do all this relatively quickly with the <code>find_zero</code> function from the <code>Roots</code> package.</p>
<p>First, we define <span class="math inline">\(A(t)\)</span>:</p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">A</span>(t) <span class="op">=</span> <span class="fl">6.687</span> <span class="op">*</span> (<span class="fl">0.931</span>)<span class="op">^</span>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>A (generic function with 1 method)</code></pre>
</div>
</div>
<p>The first question is answered by the slope of the secant line connecting <span class="math inline">\((0,A(0))\)</span> and <span class="math inline">\((30, A(30))\)</span>:</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> (<span class="fu">A</span>(<span class="fl">30</span>) <span class="op">-</span> <span class="fu">A</span>(<span class="fl">0</span>)) <span class="op">/</span> (<span class="fl">30</span> <span class="op">-</span> <span class="fl">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>-0.1968024043540685</code></pre>
</div>
</div>
<p>The units are in pounds per day.</p>
<p>The second question is done through the derivative, as follows:</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>A<span class="op">'</span>(<span class="fl">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: MethodError: no method matching adjoint(::typeof(A))
[0mClosest candidates are:
[0m  adjoint([91m::Union{LinearAlgebra.QR, LinearAlgebra.QRCompactWY, LinearAlgebra.QRPivoted}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/qr.jl:517
[0m  adjoint([91m::Union{LinearAlgebra.Cholesky, LinearAlgebra.CholeskyPivoted}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/cholesky.jl:558
[0m  adjoint([91m::LinearAlgebra.Diagonal{var"#s884", V} where {var"#s884"&lt;:Number, V&lt;:AbstractVector{var"#s884"}}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/diagonal.jl:644
[0m  ...</code></pre>
</div>
</div>
<p>This also has units in pounds per day. This is the instantaneous rate of decomposition, and is less (in absolute value) than the average decay rate.</p>
<p>The mean value theorem tells us that there is at least one time where the instantaneous decomposition rate equals the average rate over the interval <span class="math inline">\([0,30]\)</span>. Thus the endpoints form a bracketing interval for the equation <span class="math inline">\(A'(t) = m\)</span>, which we solve with:</p>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">find_zero</span>(t <span class="op">-&gt;</span> A<span class="op">'</span>(t) <span class="op">-</span> m, (<span class="fl">0</span>, <span class="fl">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: MethodError: no method matching adjoint(::typeof(A))
[0mClosest candidates are:
[0m  adjoint([91m::Union{LinearAlgebra.QR, LinearAlgebra.QRCompactWY, LinearAlgebra.QRPivoted}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/qr.jl:517
[0m  adjoint([91m::Union{LinearAlgebra.Cholesky, LinearAlgebra.CholeskyPivoted}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/cholesky.jl:558
[0m  adjoint([91m::LinearAlgebra.Diagonal{var"#s884", V} where {var"#s884"&lt;:Number, V&lt;:AbstractVector{var"#s884"}}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/diagonal.jl:644
[0m  ...</code></pre>
</div>
</div>
<p>So at 12.4 days, the instantaneous rate is equal to the average rate of decomposition over the first 30 days.</p>
<p>But this doesn‚Äôt really answer the question asked, which is about the average amount of grass clippings in the bin. For this we need the integral form of the mean value theorem. Skipping ahead a few lessons to solve this problem, we have:</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>a, err <span class="op">=</span> <span class="fu">quadgk</span>(A, <span class="fl">0</span>, <span class="fl">30</span>)   <span class="co"># area under A from 0,30</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>avg <span class="op">=</span> a<span class="op">/</span>(<span class="fl">30</span><span class="op">-</span><span class="fl">0</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">find_zero</span>(t <span class="op">-&gt;</span> <span class="fu">A</span>(t) <span class="op">-</span> avg, (<span class="fl">0</span>, <span class="fl">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: quadgk not defined</code></pre>
</div>
</div>
<p>We get the same answer ‚Äì think about whether that is a coincidence.</p>
<p>Finally, we can define <span class="math inline">\(L(t)\)</span> using the point-slope form of the line. The point is <span class="math inline">\((30, A(30))\)</span> and the slope is <span class="math inline">\(A'(30)\)</span>:</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">L</span>(t) <span class="op">=</span> <span class="fu">A</span>(<span class="fl">30</span>) <span class="op">+</span> A<span class="op">'</span>(<span class="fl">30</span>) <span class="op">*</span> (t <span class="op">-</span> <span class="fl">30</span>) <span class="co"># t &gt; 30</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>L (generic function with 1 method)</code></pre>
</div>
</div>
<p>We could restrict <span class="math inline">\(L\)</span> to insist that <span class="math inline">\(t &gt; 30\)</span>, but this isn‚Äôt necessary. We are asked to solve this. Using <code>find_zero</code> requires a bracket. We check that <span class="math inline">\(L(30) &gt; 0.5\)</span> and that <span class="math inline">\(L(100)\)</span> is negative:</p>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">L</span>(<span class="fl">30</span>), <span class="fu">L</span>(<span class="fl">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: MethodError: no method matching adjoint(::typeof(A))
[0mClosest candidates are:
[0m  adjoint([91m::Union{LinearAlgebra.QR, LinearAlgebra.QRCompactWY, LinearAlgebra.QRPivoted}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/qr.jl:517
[0m  adjoint([91m::Union{LinearAlgebra.Cholesky, LinearAlgebra.CholeskyPivoted}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/cholesky.jl:558
[0m  adjoint([91m::LinearAlgebra.Diagonal{var"#s884", V} where {var"#s884"&lt;:Number, V&lt;:AbstractVector{var"#s884"}}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/diagonal.jl:644
[0m  ...</code></pre>
</div>
</div>
<p>So, we can use <span class="math inline">\([30, 100]\)</span> as a bracket for <span class="math inline">\(L(t) - 0.5 = 0\)</span>:</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">find_zero</span>(t <span class="op">-&gt;</span> <span class="fu">L</span>(t) <span class="op">-</span> <span class="fl">0.5</span>, (<span class="fl">30</span>, <span class="fl">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: MethodError: no method matching adjoint(::typeof(A))
[0mClosest candidates are:
[0m  adjoint([91m::Union{LinearAlgebra.QR, LinearAlgebra.QRCompactWY, LinearAlgebra.QRPivoted}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/qr.jl:517
[0m  adjoint([91m::Union{LinearAlgebra.Cholesky, LinearAlgebra.CholeskyPivoted}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/cholesky.jl:558
[0m  adjoint([91m::LinearAlgebra.Diagonal{var"#s884", V} where {var"#s884"&lt;:Number, V&lt;:AbstractVector{var"#s884"}}[39m) at /opt/hostedtoolcache/julia/1.8.0/x64/share/julia/stdlib/v1.8/LinearAlgebra/src/diagonal.jl:644
[0m  ...</code></pre>
</div>
</div>
<p>So a bit over 35 days to decompose to half a pound.</p>
<p>Here is a picture, showing the decay:</p>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(t) <span class="op">=</span> t <span class="op">&lt;=</span> <span class="fl">30</span> ? <span class="fu">A</span>(t) <span class="op">:</span> <span class="fu">L</span>(t)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="fl">0</span>, <span class="fl">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
</section>
</section>
<section id="practice-3" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="practice-3"><span class="header-section-number">6.5.2</span> Practice</h3>
<section id="question-11" class="level4">
<h4 class="anchored" data-anchor-id="question-11">Question</h4>
<p>Which definition would be right for <span class="math inline">\((x,dx) - (y, dy)\)</span>?</p>
<div class="cell" data-execution_count="54">
<div class="cell-output cell-output-display" data-execution_count="54">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="HTSjjNwa" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_HTSjjNwa">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_HTSjjNwa_1">
      <input class="form-check-input" type="radio" name="radio_HTSjjNwa" id="radio_HTSjjNwa_1" value="1">
      
      <span class="label-body px-1">
        <code>(x - dx, y -dy)</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_HTSjjNwa_2">
      <input class="form-check-input" type="radio" name="radio_HTSjjNwa" id="radio_HTSjjNwa_2" value="2">
      
      <span class="label-body px-1">
        <code>(x-y, dx - dy)</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_HTSjjNwa_3">
      <input class="form-check-input" type="radio" name="radio_HTSjjNwa" id="radio_HTSjjNwa_3" value="3">
      
      <span class="label-body px-1">
        <code>(x - y, dx - y)</code>
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="HTSjjNwa_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_HTSjjNwa"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('HTSjjNwa_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_HTSjjNwa")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_HTSjjNwa")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
<section id="question-find-tangent-line-intersection" class="level4">
<h4 class="anchored" data-anchor-id="question-find-tangent-line-intersection">Question: find tangent line intersection</h4>
<p>Redefine <code>intersection_point</code> as:</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intersection_point</span>(f, c) <span class="op">=</span> c <span class="op">-</span> <span class="fu">f</span>(c)<span class="op">/</span>f<span class="op">'</span>(c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>intersection_point (generic function with 2 methods)</code></pre>
</div>
</div>
<p>Now for <span class="math inline">\(f(x) = 10/(1+x^2) - 10 \cdot \exp(-(1/2) \cdot x^2)\)</span> and <span class="math inline">\(c=1\)</span> find the intersection point.</p>
<div class="cell" data-execution_count="56">
<div class="cell-output cell-output-display" data-execution_count="56">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="pSIgrdPG" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_pSIgrdPG">
        <div style="padding-top: 5px">
    <br>
<div class="input-group">
    <input id="pSIgrdPG" type="number" class="form-control" placeholder="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="pSIgrdPG_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.getElementById("pSIgrdPG").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 2) <= 0.0001);
  var msgBox = document.getElementById('pSIgrdPG_message');
    if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_pSIgrdPG")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_pSIgrdPG")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

});

</script>
</div>
</div>
</section>
<section id="question-what-is-the-size-of-the-error" class="level4">
<h4 class="anchored" data-anchor-id="question-what-is-the-size-of-the-error">Question: what is the size of the error?</h4>
<p>We can compare the error at many different points with the following construct</p>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">exp</span>(<span class="op">-</span>x)<span class="fu">*sin</span>(x)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> <span class="fu">exp</span>(<span class="op">-</span>x)<span class="fu">*</span>(<span class="fu">cos</span>(x) <span class="op">-</span> <span class="fu">sin</span>(x))</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>[<span class="fu">abs</span>(f<span class="op">'</span>(x) <span class="op">-</span> <span class="fu">fp</span>(x) ) for x <span class="kw">in</span> <span class="fu">range</span>(<span class="fl">0</span>, <span class="cn">pi</span>, <span class="fl">25</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What is the order (exponent) of the largest difference above?</p>
<div class="cell" data-execution_count="58">
<div class="cell-output cell-output-display" data-execution_count="57">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="y5L68NzL" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_y5L68NzL">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_y5L68NzL_1">
      <input class="form-check-input" type="radio" name="radio_y5L68NzL" id="radio_y5L68NzL_1" value="1">
      
      <span class="label-body px-1">
        <code>1e-17</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_y5L68NzL_2">
      <input class="form-check-input" type="radio" name="radio_y5L68NzL" id="radio_y5L68NzL_2" value="2">
      
      <span class="label-body px-1">
        <code>1e-10</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_y5L68NzL_3">
      <input class="form-check-input" type="radio" name="radio_y5L68NzL" id="radio_y5L68NzL_3" value="3">
      
      <span class="label-body px-1">
        <code>1e-14</code>
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="y5L68NzL_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_y5L68NzL"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 1;
    var msgBox = document.getElementById('y5L68NzL_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_y5L68NzL")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_y5L68NzL")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
</section>
</section>
<section id="error-analysis" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="error-analysis"><span class="header-section-number">6.6</span> Error analysis</h2>
<p>We end with a digression on how big <code>h</code> should be to have the approximate derivatives as close as can be.</p>
<p>The choice of <span class="math inline">\(h\)</span> in the derivative approximations above was done somewhat arbitrarily, with only the intuition that smaller <span class="math inline">\(h\)</span>‚Äôs should produce more accurate approximations (which of course may be way off, as we are subtracting like-sized values in the derivative formula). Here we look a bit more closely at how to choose <span class="math inline">\(h\)</span>.</p>
<p>As mentioned, with a bit of work from the second semester of calculus one can learn that the <em>mathematical error</em> in the forward difference quotient is ‚Äúorder <span class="math inline">\(h\)</span>‚Äù whereas the mathematical error in the central difference quotient is ‚Äúorder <span class="math inline">\(h^2\)</span>. This means that as <span class="math inline">\(h\)</span> gets small the approximation error in the first is a multple of <span class="math inline">\(h\)</span>, but for the second a multiple of <span class="math inline">\(h^2\)</span> ‚Äì a much smaller error in general.</p>
<p>However there is also error due to <em>floating point approximation</em>. Such error is different in that it gets bigger as <span class="math inline">\(h\)</span> gets smaller. So one error gets bigger, the other gets smaller. So clearly if <span class="math inline">\(h\)</span> gets too small, the floating point error will dominate and the overall error will not get smaller, rather larger.</p>
<p>So, how big is the floating point error? For any given number, it can be roughly as big as the the machine precision amount, <span class="math inline">\(\epsilon\)</span>. So in the forward-difference quotient approximation we could have errors in both terms <span class="math inline">\(f(x+h)\)</span> and <span class="math inline">\(f(x)\)</span> so the total error could be as big as <span class="math inline">\(2\epsilon\)</span>. But this is divided by <span class="math inline">\(h\)</span> as we have:</p>
<p><span class="math display">\[
\frac{f(x+h) - f(x)}{h} = \frac{float(f(x +h)) + \epsilon - float(f(x_) + \epsilon}{h} =
         \frac{float(f(x+h))-float(f(x))}{h} + \frac{2\epsilon}{h}.
\]</span></p>
<p>The errors may or <em>may not</em> cancel so the algebra with <span class="math inline">\(\epsilon\)</span> is unusual to the untrained eye. It basically takes into account the worse case.</p>
<p>The key is the <span class="math inline">\(2\epsilon/h\)</span> term ‚Äì it gets bigger as <span class="math inline">\(h\)</span> gets smaller.</p>
<p>So if each floating point approximation is no more off than <span class="math inline">\(\epsilon\)</span>, we have this bound on the error:</p>
<p><span class="math display">\[
\text{error} \leq \frac{2\epsilon}{h} + (M/2)h
\]</span></p>
<p>Where <span class="math inline">\(M\)</span> is a constant that depends on the maximum absolute value of the second derivative and the <span class="math inline">\(1/2\)</span> comes from second semester calculus. Choosing <span class="math inline">\(h\)</span> to make this as small as possible is possible with some calculus involving the derivative, but for now we simply note the answer is <span class="math inline">\(h=((2\epsilon)/(M/2))^{1/2}\)</span>.</p>
<p>Taking <span class="math inline">\(\epsilon\)</span> as machine tolerance and (conveniently) <span class="math inline">\(M=1\)</span> we get</p>
<p><span class="math display">\[
h_{min} = \sqrt((2\epsilon)/(1/2)) \approx 10^{-8}
\]</span></p>
<p>Or more precisely:</p>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>( (<span class="fl">2</span><span class="fu">*eps</span>())<span class="op">/</span>(<span class="fl">1</span><span class="op">/</span><span class="fl">2</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>2.9802322387695312e-8</code></pre>
</div>
</div>
<p>We can check this is about right,but graphing on a different scale:</p>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(h; M<span class="op">=</span><span class="fl">1</span>) <span class="op">=</span> <span class="fl">2</span><span class="fu">*eps</span>()<span class="op">/</span>h <span class="op">+</span> (M<span class="op">/</span><span class="fl">2</span>)<span class="op">*</span>h</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">g</span>(x) <span class="op">=</span> <span class="fu">log10</span>(<span class="fu">f</span>(<span class="fl">10.0</span><span class="op">^</span>(<span class="op">-</span>x)))</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g, <span class="fl">1</span>, <span class="fl">10</span>)          <span class="co"># min near 8, which means h like 1e-8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: plot not defined</code></pre>
</div>
</div>
<p>Numerically, we can check how this basically works for some test function:</p>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">exp</span>(x) <span class="op">-</span> x<span class="op">^</span><span class="fl">3</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> <span class="fu">exp</span>(x) <span class="op">-</span> <span class="fl">3</span>x<span class="op">^</span><span class="fl">2</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>[hs [<span class="fu">Df</span>(f,h<span class="op">=</span>h)(<span class="fl">.5</span>) <span class="op">-</span> <span class="fu">fp</span>(<span class="fl">.5</span>) for h <span class="kw">in</span> hs] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>16√ó2 Matrix{Float64}:
 0.1      -0.074746
 0.01     -0.00682885
 0.001    -0.000676365
 0.0001   -6.75712e-5
 1.0e-5   -6.75649e-6
 1.0e-6   -6.75645e-7
 1.0e-7   -6.65768e-8
 1.0e-8    4.47752e-9
 1.0e-9   -1.73158e-7
 1.0e-10  -1.73158e-7
 1.0e-11   4.26773e-6
 1.0e-12  -0.000106755
 1.0e-13   0.000559379
 1.0e-14  -0.0105429
 1.0e-15  -0.0105429
 1.0e-16   1.32172</code></pre>
</div>
</div>
<p>We see the best case is around <span class="math inline">\(h=10^{-8}\)</span>, as expected by the theory.</p>
<section id="approximation-errors-for-the-central-difference-quotient" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="approximation-errors-for-the-central-difference-quotient"><span class="header-section-number">6.6.1</span> Approximation errors for the central difference quotient</h3>
<p>For the central difference quotient, the errors are different. The error in <span class="math inline">\(h\)</span> becomes:</p>
<p><span class="math display">\[
\text{error} \leq (2\epsilon)/(2h) + (M/6) h^2
\]</span></p>
<p>This gives <span class="math inline">\((3\epsilon/M)^{1/3}\)</span> as the choice for <span class="math inline">\(h\)</span> that minimizes the right-hand expression.</p>
<p>Taking <span class="math inline">\(\epsilon\)</span> as the machine tolerance and (conveniently) <span class="math inline">\(M=3\)</span> we get</p>
<p><span class="math display">\[
h_{min} \approx 10^{-6}
\]</span></p>
<p>We can again check how this works for our function and point:</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>[hs [ <span class="fu">Dc</span>(f,h<span class="op">=</span>h)(<span class="fl">.5</span>) <span class="op">-</span> <span class="fu">fp</span>(<span class="fl">.5</span>) for h <span class="kw">in</span> hs] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>16√ó2 Matrix{Float64}:
 0.1      -0.00725076
 0.01     -7.25212e-5
 0.001    -7.25213e-7
 0.0001   -7.2531e-9
 1.0e-5   -8.54954e-11
 1.0e-6    3.6629e-11
 1.0e-7    3.6629e-11
 1.0e-8    4.47752e-9
 1.0e-9   -6.21359e-8
 1.0e-10  -1.73158e-7
 1.0e-11   4.26773e-6
 1.0e-12  -0.000106755
 1.0e-13   0.000559379
 1.0e-14  -0.0105429
 1.0e-15   0.100479
 1.0e-16   1.32172</code></pre>
</div>
</div>
</section>
<section id="practice-4" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="practice-4"><span class="header-section-number">6.6.2</span> Practice</h3>
<section id="question-best-depends-on-the-function-and-value" class="level4">
<h4 class="anchored" data-anchor-id="question-best-depends-on-the-function-and-value">Question: best depends on the function and value</h4>
<p>A subtle point above is that we are minimizing an upper bound in <span class="math inline">\(h\)</span> with an assumption, not the actual error. The actual answer may differ as it depends on a function and the point of evaluation. Look at the function <span class="math inline">\(f(x) = x^2 - 2x\)</span> and compare the values at <span class="math inline">\(0.5\)</span> as above:</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>hs <span class="op">=</span> [(<span class="fl">1</span><span class="op">/</span><span class="fl">10</span>)<span class="op">^</span>i for i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">16</span>]</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">2</span>x</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> <span class="fl">2</span>x <span class="op">-</span> <span class="fl">2</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>[hs [<span class="fu">Dc</span>(f,h<span class="op">=</span>h)(<span class="fl">.5</span>) <span class="op">-</span> <span class="fu">fp</span>(<span class="fl">.5</span>) for h <span class="kw">in</span> hs] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>16√ó2 Matrix{Float64}:
 0.1       2.22045e-16
 0.01     -6.66134e-16
 0.001    -6.66134e-16
 0.0001    1.10356e-13
 1.0e-5   -9.99867e-13
 1.0e-6   -2.87552e-11
 1.0e-7   -2.87552e-11
 1.0e-8   -5.02476e-9
 1.0e-9   -2.72292e-8
 1.0e-10  -8.27404e-8
 1.0e-11  -8.27404e-8
 1.0e-12   2.21217e-5
 1.0e-13   0.000244166
 1.0e-14   0.000799278
 1.0e-15   0.000799278
 1.0e-16  -0.110223</code></pre>
</div>
</div>
<p>What is the best value of <span class="math inline">\(h\)</span>?</p>
<p>For which of these values of <span class="math inline">\(h\)</span> is the error smallest?</p>
<div class="cell" data-execution_count="64">
<div class="cell-output cell-output-display" data-execution_count="63">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="mFOov1IH" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_mFOov1IH">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_mFOov1IH_1">
      <input class="form-check-input" type="radio" name="radio_mFOov1IH" id="radio_mFOov1IH_1" value="1">
      
      <span class="label-body px-1">
        <code>1e-3</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_mFOov1IH_2">
      <input class="form-check-input" type="radio" name="radio_mFOov1IH" id="radio_mFOov1IH_2" value="2">
      
      <span class="label-body px-1">
        <code>1e-6</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_mFOov1IH_3">
      <input class="form-check-input" type="radio" name="radio_mFOov1IH" id="radio_mFOov1IH_3" value="3">
      
      <span class="label-body px-1">
        <code>1e-8</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_mFOov1IH_4">
      <input class="form-check-input" type="radio" name="radio_mFOov1IH" id="radio_mFOov1IH_4" value="4">
      
      <span class="label-body px-1">
        <code>1e-12</code>
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="mFOov1IH_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_mFOov1IH"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 1;
    var msgBox = document.getElementById('mFOov1IH_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_mFOov1IH")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_mFOov1IH")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>
</section>
<section id="question-error-analysis" class="level4">
<h4 class="anchored" data-anchor-id="question-error-analysis">Question: error analysis</h4>
<p>Consider these commands:</p>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">sin</span>(x)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> <span class="fu">cos</span>(x)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>[hs [ <span class="fu">Dc</span>(f,h<span class="op">=</span>h)(<span class="fl">.5</span>) <span class="op">-</span> <span class="fu">fp</span>(<span class="fl">.5</span>) for h <span class="kw">in</span> hs] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Do they show the smallest error around <span class="math inline">\(10^{-6}\)</span> as expected?</p>
<div class="cell" data-execution_count="66">
<div class="cell-output cell-output-display" data-execution_count="64">
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="8RQDWgR8" data-controltype="">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_8RQDWgR8">
        <div style="padding-top: 5px">
    <div class="form-check">
    <label class="form-check-label" for="radio_8RQDWgR8_1">
      <input class="form-check-input" type="radio" name="radio_8RQDWgR8" id="radio_8RQDWgR8_1" value="1">
      
      <span class="label-body px-1">
        true
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_8RQDWgR8_2">
      <input class="form-check-input" type="radio" name="radio_8RQDWgR8" id="radio_8RQDWgR8_2" value="2">
      
      <span class="label-body px-1">
        false
      </span>
    </label>
</div>

    
        </div>
      </div>
      <div id="8RQDWgR8_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_8RQDWgR8"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 1;
    var msgBox = document.getElementById('8RQDWgR8_message');
      if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> üëç&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_8RQDWgR8")
    if (explanation != null) {
       explanation.style.display = "none";
    }
  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>üëé&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_8RQDWgR8")
    if (explanation != null) {
       explanation.style.display = "block";
    }
  }

})});

</script>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./limits.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Investigating limits with Julia</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./first-second-derivatives.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exploring first and second derivatives with Julia</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>