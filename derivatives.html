
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">




<link
  href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"
  rel="stylesheet">

<style>
.julia {font-family: "Source Code Pro";
        color:#0033CC;
        }
body { padding-top: 60px; }
h5:before {content:"\2746\ ";}
h6:before {content:"\2742\ ";}
pre {display: block;}
</style>

<script src="http://code.jquery.com/jquery.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

<!-- .julia:before {content: "julia> "} -->

<style></style>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>


<!-- not TeX-AMS-MML_HTMLorMML-->
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">  
</script>
<script>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ["\$","\$"], ["\\(","\\)"]]
  },
  displayAlign: "left",
  displayIndent: "5%"
});
</script>


<script type="text/javascript">
$( document ).ready(function() {
  $("h1").each(function(index) { 
       var title = $( this ).text()
       $("#page_title").html("<strong>" + title + "</strong>");
       document.title = title
  });
  $( "h2" ).each(function( index ) {
    var nm =  $( this ).text();                                    
    var id = $.trim(nm).replace(/ /g,'');
    this.id = id
    $("#page_dropdown").append("<li><a href='#" + id + "'>" + nm + "</a></li>");
  });
  $('[data-toggle="popover"]').popover();  
});
</script>

</head>


<body data-spy="scroll" >

<nav class="navbar navbar-default  navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
         
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="#" id="page_title"></a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
         <li class="dropdown">
           <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
           Jump to... <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="page_dropdown"></ul>
        </li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<header>
</header>

<div class="container-fluid">
  <div class="span10 offset1">
<h1>Approximate derivatives in julia</h1><h2>Introduction</h2><p>Single-variable calculus has two main concepts: the derivative and the integral, both defined in terms of a third important concept: the limit. The derivative is what we discuss here. The derivative allows us to talk about a tangent line to a curve. This is often called a line that touches the curve at just one point, but that isn't quite correct, though often the case locally. A better idea would be to say it is the line that best approximates the curve at that point. That is, if we were to zoom in to the graph it might appear to look straight, and that straightness would have a slope that would match the tangent line. This idea leads to a primary use of the derivative – to approximate functions with simpler lines.  Of course, this intuition is informal, a definition is in terms of the slope of approximating secant lines.</p><p>Historically, Fermat, in a treatise on finding maxima and minima, approached the problem of finding the tangent line by comparing the value of $f(x)$ to a nearby value $f(x+h)$. Working with polynomials, meant that subtracting $f(x+h) - f(x)$ led to a polynomial in $h$. Dividing by $h$ and then setting $h=0$ yields an answer for the slope.</p><p>The more modern approach (well Cauchy in the 1820s) defines the derivative of a function, $f$, at a point $c$ as the slope of the <em>tangent line</em>, defined in terms of the <em>limit</em> of the slopes of approximating secant lines. The notation is:</p>$$~
f'( c ) = \lim_{h \rightarrow 0} \frac{f(c + h) - f( c)}{h}.\quad\text{Derivative at a point}
~$$
<p>As mentioned, intuitively, the tangent line is the best straight-line approximation to a function near the point $(c, f( c))$ and would have slope given by the derivative.</p><p>This graph shows $f(x) = 2 - x^2$ and various secant lines when $c=-0.75$ (see also <code>derivative_viz&#40;f, c&#41;</code> in the <code>MTH229</code> package):</p><pre class="sourceCode julia">using MTH229 
f(x) = 2 - x^2
c = -0.75
sec_line(h) = secant(f, c, c+h)                # secant in MTH229 package
plot([f, sec_line(1), sec_line(.75), sec_line(.5), sec_line(.25)], -1, 1)</pre>
    <div id="10925b48-f5a2-4782-89dd-bc1cd7cffffc" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('10925b48-f5a2-4782-89dd-bc1cd7cffffc');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[1.019436266818449,1.0386817911946435,1.2075986817646887,1.360207718081838,1.4440744194030222,1.522051524484798,1.5833852999060314,1.6405089049404395,1.7501039292625655,1.8335358442004768,1.9042233011719392,1.9618459522802083,1.99118470775101,1.9999756425481972,1.9915269975583305,1.9640482157025214,1.9115084308681156,1.8399144833845975,1.7431336021182964,1.6440093653984647,1.5755667740386983,1.501110232505976,1.4256351122042323,1.3448457320519571,1.2043380227964475,1.0501904553859271,1.025256749830422],"type":"scatter","name":"y1","yaxis":"y","x":[-0.9902341809802119,-0.9804683619604238,-0.890169263811839,-0.7998701656632544,-0.7456041715260033,-0.6913381773887523,-0.6454569699786104,-0.5995757625684686,-0.49989605993389713,-0.4080001909307437,-0.3094781071870203,-0.19533061132293544,-0.09388978777795712,-0.004935326919559979,0.09204891331063893,0.1896095575056242,0.29747532524880854,0.4001068814896869,0.5068198870227011,0.5966495073336903,0.6514853996532093,0.7063212919727282,0.7578686481150726,0.809416004257417,0.8919988661447684,0.9745817280321198,0.9872908640160599]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[1.3222658190197882,1.4125649171683727,1.466830911305624,1.5127121187157657,1.5625519700330515,1.6084999045346282,1.6577609464064897,1.7148346943385322,1.7655551061110215,1.81003233654022,1.8585244566553194,1.9073047787528121,1.9612376626244044,2.0125534407448433,2.0659099435113504,2.1108247536668454,2.165660645986364,2.2172080021287086,2.29979086401606],"type":"scatter","name":"y2","yaxis":"y","x":[-0.9804683619604238,-0.7998701656632544,-0.6913381773887523,-0.5995757625684686,-0.49989605993389713,-0.4080001909307437,-0.3094781071870203,-0.19533061132293544,-0.09388978777795712,-0.004935326919559979,0.09204891331063893,0.1896095575056242,0.29747532524880854,0.4001068814896869,0.5068198870227011,0.5966495073336903,0.7063212919727282,0.809416004257417,0.9745817280321198]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(62, 164, 78, 1.000)","shape":"linear","dash":"solid","width":1},"y":[1.2646487285296821,1.4000973757525592,1.4814963669584358,1.5503181780736486,1.625077955049577,1.693999856801942,1.7678914196097348,1.8535020415077985,1.9295826591665322,1.9962985048103299,2.0690366849829793,2.142207168129218,2.2231064939366063,2.300080161117265,2.380114915267026,2.4474871305002677,2.5297409689795463,2.6070620031930627,2.73093629602409],"type":"scatter","name":"y3","yaxis":"y","x":[-0.9804683619604238,-0.7998701656632544,-0.6913381773887523,-0.5995757625684686,-0.49989605993389713,-0.4080001909307437,-0.3094781071870203,-0.19533061132293544,-0.09388978777795712,-0.004935326919559979,0.09204891331063893,0.1896095575056242,0.29747532524880854,0.4001068814896869,0.5068198870227011,0.5966495073336903,0.7063212919727282,0.809416004257417,0.9745817280321198]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(195, 113, 210, 1.000)","shape":"linear","dash":"solid","width":1},"y":[1.2070316380395762,1.3876298343367455,1.4961618226112479,1.5879242374315314,1.687603940066103,1.7794998090692564,1.8780218928129797,1.9921693886770646,2.093610212222043,2.18256467308044,2.279548913310639,2.3771095575056242,2.4849753252488087,2.5876068814896866,2.694319887022701,2.7841495073336904,2.893821291972728,2.996916004257417,3.1620817280321196],"type":"scatter","name":"y4","yaxis":"y","x":[-0.9804683619604238,-0.7998701656632544,-0.6913381773887523,-0.5995757625684686,-0.49989605993389713,-0.4080001909307437,-0.3094781071870203,-0.19533061132293544,-0.09388978777795712,-0.004935326919559979,0.09204891331063893,0.1896095575056242,0.29747532524880854,0.4001068814896869,0.5068198870227011,0.5966495073336903,0.7063212919727282,0.809416004257417,0.9745817280321198]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(172, 142, 24, 1.000)","shape":"linear","dash":"solid","width":1},"y":[1.1494145475494704,1.375162292920932,1.5108272782640597,1.6255302967894143,1.7501299250826285,1.8649997613365703,1.9881523660162246,2.130836735846331,2.2576377652775537,2.36883084135055,2.4900611416382987,2.6120119468820304,2.7468441565610107,2.8751336018621085,3.0085248587783764,3.120811884167113,3.25790161496591,3.3867700053217713,3.5932271600401497],"type":"scatter","name":"y5","yaxis":"y","x":[-0.9804683619604238,-0.7998701656632544,-0.6913381773887523,-0.5995757625684686,-0.49989605993389713,-0.4080001909307437,-0.3094781071870203,-0.19533061132293544,-0.09388978777795712,-0.004935326919559979,0.09204891331063893,0.1896095575056242,0.29747532524880854,0.4001068814896869,0.5068198870227011,0.5966495073336903,0.7063212919727282,0.809416004257417,0.9745817280321198]}], {"showlegend":true,"xaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[-0.75,-0.5,-0.25,0.0,0.25,0.5,0.75],"visible":true,"ticks":"inside","range":[-0.9902341809802119,0.9872908640160599],"domain":[0.05100612423447069,0.9934383202099737],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["-0.75","-0.50","-0.25","0.00","0.25","0.50","0.75"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[1.5,2.0,2.5,3.0,3.5],"visible":true,"ticks":"inside","range":[1.019436266818449,3.5932271600401497],"domain":[0.03762029746281716,0.9901574803149606],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["1.5","2.0","2.5","3.0","3.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>As the value of $h$ goes towards 0 along the path $1$, $0.75$, $0.5$, $0.25$, ... the slope of the secant line heads towards the slope of the tangent line, in this case $2\cdot 0.75 = 1.5$.</p><p>Using the idea of a derivative at a point, one defines the derivative of the function $f$ to be the function which for each $x$ returns the derivative of $f$ at the point $x$. Notationally, this just replaces $c$ above with $x$, but conceptually there is a bit more to it.</p><h2>Forward differences <small>Slope of the tangent line</small></h2><p>The rules of derivatives allow for a mechanical approach to taking derivatives with the power rule, chain rule and some special cases. In this project we look at approaching the derivative numerically. We start by investigating <em>approximate derivatives</em> computed with <em>finite differences</em>.</p><p>The most naive approximation is simply to assume $h$ is some small number and use that to approximate the limit above:</p><pre class="sourceCode julia">f(x) = x^2 - 2x; fp(x) = 2x - 2
h = .001
c = 3
( f(c + h) - f(c) ) / h</pre>
<div class="well well-sm">
4.000999999999699</div>

<p>This is known as the <em>forward difference</em> approximation to the derivative. For this example, the difference between the approximation and the actual slope is:</p><pre class="sourceCode julia">( f(c + h) - f(c) ) / h - fp(c)</pre>
<div class="well well-sm">
0.0009999999996992415</div>

<p>That is not too close, just to 3 digits of accuracy.</p><p>Notationally, we may write this as:</p>$$~
f'( c) \approx \frac{f(c + h) - f( c) }{h}
~$$
<p>For some small value of $h$. The equals sign is replaced by an approximation symbol, as there is no limit expression written.</p><div class="alert alert-danger" role="alert">
<span class="glyphicon glyphicon-th" aria-hidden="true"></span>
<span class="text-uppercase">example:</span><div class="markdown"><p>Derivative at a point</p>
</div>
</div>
<p>Let's try the derivative of some well known function.  We know the derivative of $f(x) = \sin(x)$ is $f'(x) = \cos(x)$. Let's see if the above works well:</p><pre class="sourceCode julia">f(x) = sin(x); fp(x) = cos(x)
c = pi/4; h = 0.0001
( f(c + h) - f(c) )/h - fp(c)</pre>
<div class="well well-sm">
-3.535651724428934e-5</div>

<p>Not as good as we can get – the error is like <code>1e-5</code>, but not too bad already.</p><div class="alert alert-danger" role="alert">
<span class="glyphicon glyphicon-th" aria-hidden="true"></span>
<span class="text-uppercase">example:</span><div class="markdown"><p>Finding profit</p>
</div>
</div>
<p>Suppose the tractor company John Deere models its profit per units sold through the function $P(x) = 50 e^{x/250}/(1 - e^{x/250})$. Find the marginal profit for $x=200$.</p><p>The marginal profit is the change in profit per unit sold – or the derivative – at $x=200$.  We can find this quite simply by either differentiating directly, or as we do here, approximating the answer with <code>julia</code>. We first note that the function above, is a composition, so it may be written using two functions:</p><pre class="sourceCode julia">f1(x) = exp(x)/(1 - exp(x))
f(x) = 50 * f1(x/250)
c = 200; h = 0.0001;
res = (f(c+h) - f(c))/h</pre>
<div class="well well-sm">
0.29635326299626286</div>

<p>If $50$ is the maximum profit, this is a percentage increase of:</p><pre class="sourceCode julia">(res/50) * 100</pre>
<div class="well well-sm">
0.5927065259925257</div>

<p>or a bit more than half a percent.</p><div class="alert alert-danger" role="alert">
<span class="glyphicon glyphicon-th" aria-hidden="true"></span>
<span class="text-uppercase">example:</span><div class="markdown"><p>Finding the tangent line at a point</p>
</div>
</div>
<p>Let $f(x) = x^x$. Find the tangent line at $c=2$. Compare the difference between the value of the tangent line  and the function at $x=2.1$.</p><p>The tangent line is most easily expressed in terms of the <em>point-slope</em> formula for a line where the point is $(c, f( c))$ and the slope is $f'( c)$. This gives:</p>$$~
y = f( c) + f'( c)\cdot(x - c)
~$$
<p>In the following, the slope of the tangent line will be <em>approximated</em> using a numeric derivative.  We use $h=0.0001$:</p><pre class="sourceCode julia">f(x) = x^x
c = 2; h = 0.0001
m = ( f(c + h) - f(c) ) / h	 
tangent_line(x) = f(c) + m * (x - c)</pre>
<pre class="output">
tangent_line (generic function with 1 method)</pre>

<p>To compare the difference, we have:</p><pre class="sourceCode julia">f(2.1) - tangent_line(2.1)</pre>
<div class="well well-sm">
0.07231187980696063</div>

<p>A graph shows this difference:</p><pre class="sourceCode julia">plot([f, tangent_line], 1.85, 2.15)</pre>
    <div id="669aa1ab-5e2a-4223-ba54-acf97d808fb8" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('669aa1ab-5e2a-4223-ba54-acf97d808fb8');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[3.135622861090096,3.2766537708329353,3.3650739455307113,3.4420664657644933,3.5280957927971666,3.609682310381122,3.6996511249527835,3.807228559863699,3.905940813093756,3.9949899473956574,4.094807739593921,4.198180307168144,4.3160424867605895,4.431782810710922,4.555974128261295,4.663657003184509,4.799147130332536,4.930676893769447,5.1501609779003195],"type":"scatter","name":"y1","yaxis":"y","x":[1.8529297457059364,1.8800194751505117,1.8962992733916872,1.9100636356147296,1.9250155910099154,1.9387999713603883,1.953578283921947,1.9707004083015596,1.9859165318333065,1.999259700962066,2.013807336996596,2.0284414336258436,2.0446212987873214,2.0600160322234533,2.0760229830534054,2.089497426100053,2.1059481937959093,2.121412400638613,2.146187259204818]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[3.0038546177064345,3.1873404559768925,3.2976077967145536,3.390837429956937,3.4921109430454016,3.585476164312011,3.6855735489731734,3.8015461854364494,3.904608978557424,3.9949857605693686,4.093520712648181,4.192641284998014,4.302231752792487,4.406504317612974,4.514923591315831,4.606189525983067,4.717614887651682,4.822358014065203,4.990164625104003],"type":"scatter","name":"y2","yaxis":"y","x":[1.8529297457059364,1.8800194751505117,1.8962992733916872,1.9100636356147296,1.9250155910099154,1.9387999713603883,1.953578283921947,1.9707004083015596,1.9859165318333065,1.999259700962066,2.013807336996596,2.0284414336258436,2.0446212987873214,2.0600160322234533,2.0760229830534054,2.089497426100053,2.1059481937959093,2.121412400638613,2.146187259204818]}], {"showlegend":true,"xaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[1.9000000000000001,1.9500000000000002,2.0,2.0500000000000003,2.1],"visible":true,"ticks":"inside","range":[1.8529297457059364,2.146187259204818],"domain":[0.05100612423447069,0.9934383202099737],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["1.90","1.95","2.00","2.05","2.10"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[3.5,4.0,4.5,5.0],"visible":true,"ticks":"inside","range":[3.0038546177064345,5.1501609779003195],"domain":[0.03762029746281716,0.9901574803149606],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["3.5","4.0","4.5","5.0"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<h3>Practice</h3><h4>Question</h4><p>Find the slope of the tangent line of $f(x) = x\log(x)$ at the value $x=1$ using $h=0.0001$ and the forward difference method:</p><form name='WeaveQuestion' data-id='U6OWDZer' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>



<div class="input-group">
<input id="U6OWDZer" type="number" class="form-control">

</div>
  
<div id='U6OWDZer_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#U6OWDZer').on('change', function() {
  correct = Math.abs(this.value - 1.0000499983333064) <= 1.0e-6;

  if(correct) {
     $('#U6OWDZer_message').html('<div class="alert alert-success"><span class="glyphicon glyphicon-thumbs-up">&nbsp;Correct</span></div>');
  } else {
     $('#U6OWDZer_message').html('<div class="alert alert-danger"><span class="glyphicon glyphicon-thumbs-down">&nbsp;Incorrect</span></div>');
  }
});
</script>
<h4>Question</h4><p>Find the slope of the tangent line of $f(x) = x-\log(x)$ at the value $x=1$ using $h=0.0001$ and the forward difference method:</p><form name='WeaveQuestion' data-id='YePVVdc9' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>



<div class="input-group">
<input id="YePVVdc9" type="number" class="form-control">

</div>
  
<div id='YePVVdc9_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#YePVVdc9').on('change', function() {
  correct = Math.abs(this.value - 4.999666680660653e-5) <= 1.0e-6;

  if(correct) {
     $('#YePVVdc9_message').html('<div class="alert alert-success"><span class="glyphicon glyphicon-thumbs-up">&nbsp;Correct</span></div>');
  } else {
     $('#YePVVdc9_message').html('<div class="alert alert-danger"><span class="glyphicon glyphicon-thumbs-down">&nbsp;Incorrect</span></div>');
  }
});
</script>
<h4>Question</h4><p>The built-in <code>airy</code> function, when called as <code>airy&#40;x&#41;</code>, returns the so-called Airy function, a special function named after</p><p><a href="http://en.wikipedia.org/wiki/Airy_function">George Biddell Airy</a>. </p><p>Compute the derivative at $c=-3$ using $h=0.0001$.</p><form name='WeaveQuestion' data-id='rTWJidyC' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>



<div class="input-group">
<input id="rTWJidyC" type="number" class="form-control">

</div>
  
<div id='rTWJidyC_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#rTWJidyC').on('change', function() {
  correct = Math.abs(this.value - 0.31464058915464665) <= 1.0e-6;

  if(correct) {
     $('#rTWJidyC_message').html('<div class="alert alert-success"><span class="glyphicon glyphicon-thumbs-up">&nbsp;Correct</span></div>');
  } else {
     $('#rTWJidyC_message').html('<div class="alert alert-danger"><span class="glyphicon glyphicon-thumbs-down">&nbsp;Incorrect</span></div>');
  }
});
</script>
<h4>Question</h4><p>Let $f(x) = \sin(x)$. The slope of the tangent line at $c=\pi/4$ is well known to have slope $\sqrt{2}/2$. </p><p>Compute the forward difference quotient for $f$ at $c$ using $h=0.01$. What is the order of the difference between the two values?</p><form name="WeaveQuestion" data-id="zyPKz5kx" data-controltype="radio">
<div class="form-group ">
    
    <div  class="radio inline"> 
    <label>
      <input type="radio" name="radio_zyPKz5kx" value="1"><div class="markdown"><p>3 parts in 10,000</p>
</div>
    </label>
    </div>
    
    <div  class="radio inline"> 
    <label>
      <input type="radio" name="radio_zyPKz5kx" value="2"><div class="markdown"><p>3 parts in 100,000</p>
</div>
    </label>
    </div>
    
    <div  class="radio inline"> 
    <label>
      <input type="radio" name="radio_zyPKz5kx" value="3"><div class="markdown"><p>3 parts in 100</p>
</div>
    </label>
    </div>
    
    <div  class="radio inline"> 
    <label>
      <input type="radio" name="radio_zyPKz5kx" value="4"><div class="markdown"><p>3 parts in 1000</p>
</div>
    </label>
    </div>
    


<span class="help-inline"><span id="zyPKz5kx_hint" class="glyphicon glyphicon-gift"></span></span>
<script>$("#zyPKz5kx_hint").tooltip({title:"<div class="markdown"><p>Look at <code>sqrt&#40;2&#41;/2</code> minus the computed value</p>
</div>", html:true, placement:"right"});</script>

<div id="zyPKz5kx_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_zyPKz5kx']").on("change", function() {
  correct = this.value == 4;

  if(correct) {
     $("#zyPKz5kx_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#zyPKz5kx_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>
<h4>Question</h4><p>For the function $f(x) = x^3 - 5x$ use a forward difference with $h=0.0001$ to approximate the slope of the tangent line at $c=1$. Use this value to create a tangent line at <code>&#40;c, f&#40; c&#41;&#41;</code>. Plot both the function and the tangent. Estimate graphically where the tangent line crosses the $x$ axis. The value is near:</p><form name="WeaveQuestion" data-id="VatAmxAK" data-controltype="radio">
<div class="form-group ">
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_VatAmxAK" value="1"><div class="markdown"><p>1.0</p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_VatAmxAK" value="2"><div class="markdown"><p>0.0</p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_VatAmxAK" value="3"><div class="markdown"><p>-1.5</p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_VatAmxAK" value="4"><div class="markdown"><p>-2.0</p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_VatAmxAK" value="5"><div class="markdown"><p>-0.5</p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_VatAmxAK" value="6"><div class="markdown"><p>-1.0</p>
</div>
    </label>
    </div>
    


<div id="VatAmxAK_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_VatAmxAK']").on("change", function() {
  correct = this.value == 6;

  if(correct) {
     $("#VatAmxAK_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#VatAmxAK_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>
<h2>Derivative of a function</h2><p>We might be interested not in the derivative at a point, but in the derivative as a function. This is how we think of the derivative when we say if $f(x) = \sin(x)$, the $f'(x) = \cos(x)$.  Mathematically, from this viewpoint, the derivative is referred to as an <em>operator</em>, as it takes a function and returns a function.</p><p>We can reproduce this behavior easily enough with <code>julia</code>, as functions are <em>first class objects</em>: they can be passed as arguments and returned as values.</p><p>First, let's define a function to find the derivative at a point using the "forward difference":</p><pre class="sourceCode julia">forward_difference(f, x0, h) = (f(x0 + h) - f(x0))/h</pre>
<pre class="output">
forward_difference (generic function with 1 method)</pre>

<p>We need three arguments of course as we have three ingredients to worry about: the function, the point and the size of $h$.</p><p>To make an operator that takes $f$ and returns a function (an anonymous function in this case) that computes our approximation to $f'$ we can do the following:</p><pre class="sourceCode julia">Df(f; h=1e-8) = x -> forward_difference(f, x, h)</pre>
<pre class="output">
Df (generic function with 1 method)</pre>

<p>We specified a default value of $h$ for convenience, but allow it to be varied if desired.</p><p>To see this work, we can find and plot the derivative of $\sin(x)$:</p><pre class="sourceCode julia">f(x) = sin(x)
fp(x) = Df(f)(x)
plot([f, fp], 0, 2pi)</pre>
    <div id="c51a414c-c17c-4553-9c02-7a7100f9e0f7" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('c51a414c-c17c-4553-9c02-7a7100f9e0f7');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.015339511014701464,0.03067541242093728,0.046004095459634804,0.061321953070307515,0.20180642360713794,0.33823755155018476,0.46787507674258566,0.5881151905779408,0.654837238293407,0.7168041201646171,0.7735658575053913,0.8247102693051217,0.8632937107664949,0.8973950679428847,0.9268372919861522,0.9514675235298343,0.9726217578315877,0.9878177879548484,0.9969625242175817,0.9999999466866806,0.9973729257124501,0.989552636203005,0.9765797979958295,0.9585219599793448,0.9336213299034533,0.9031334125880434,0.8672406639667144,0.8261578853619512,0.7723947159607715,0.7124277016382363,0.6467384951679416,0.5758547097527327,0.43883912087112936,0.29070489558439705,0.15461141539348522,0.015504165579995984,-0.13641106359642388,-0.28516655102344535,-0.42813502702217854,-0.5610684489029837,-0.6290990036649874,-0.6926171720883418,-0.7511673525685626,-0.8043295777666695,-0.8495612319132725,-0.8892759098040912,-0.923215707798165,-0.9511602238189567,-0.9736638213734828,-0.9893319351014062,-0.9980545689901091,-0.999770486890561,-0.9957730669594766,-0.9868211552281166,-0.9729592921392197,-0.9542564477114475,-0.9249967065444722,-0.8888782743946314,-0.8461689632045494,-0.7971854551477641,-0.7457424027956453,-0.6894127808039027,-0.6285656960110432,-0.5635998564911867,-0.4520091420044189,-0.3328229035580867,-0.2080439367721085,-0.07976901700741997,-0.05985459571496414,-0.03991632077017164,-0.01996213810723592],"type":"scatter","name":"y1","yaxis":"y","x":[0.015340112644426933,0.030680225288853866,0.0460203379332808,0.06136045057770773,0.20320194226239643,0.34504343394708514,0.4868849256317738,0.6287264173164625,0.7139672415771299,0.7992080658377971,0.8844488900984645,0.9696897143591319,1.0417597464278976,1.113829778496663,1.1858998105654286,1.2579698426341943,1.3362580980113905,1.4145463533885865,1.4928346087657827,1.5711228641429789,1.643297710881868,1.7154725576207572,1.7876474043596464,1.8598222510985358,1.9372013147249456,2.0145803783513556,2.0919594419777656,2.1693385056041756,2.2589897392122458,2.3486409728203155,2.4382922064283856,2.5279434400364558,2.6872863130479567,2.846629186059458,2.986358526427849,3.1260878667962397,3.27843035510683,3.43077284341742,3.5840207449586465,3.7372686464998734,3.8219862223788263,3.906703798257779,3.9914213741367313,4.076138950015684,4.156745585793892,4.2373522215721,4.317958857350307,4.398565493128515,4.482377691684766,4.566189890241017,4.650002088797269,4.733814287353519,4.804366306164461,4.874918324975402,4.945470343786344,5.016022362597284,5.102158380829305,5.188294399061325,5.274430417293346,5.360566435525367,5.44153683320975,5.522507230894133,5.603477628578516,5.684448026262899,5.814168882371761,5.943889738480623,6.073610594589485,6.203331450698347,6.2232949148186565,6.243258378938966,6.263221843059276]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.9998823427212478,0.9995293988318554,0.9989412512456664,0.9981180375262522,0.9912635934306024,0.97942542687246,0.9626630548265069,0.9410607570981,0.9147271440301807,0.8837946041673206,0.8484186686530393,0.8087771785625364,0.7557699244209459,0.6972745825173376,0.6337159241809331,0.5655554469186086,0.44122792086653817,0.30774915948938997,-0.00032653879600275104,-0.2850186864300497,-0.4293600364135841,-0.563438684597628,-0.6351428272211024,-0.7017455172508846,-0.7627118159270196,-0.8175520482822662,-0.8607893509093856,-0.8985656441140577,-0.9306412807053022,-0.9568127568027052,-0.9747720547403915,-0.9879753543051706,-0.9963582348060385,-0.9998797971880191,-0.9981603481257206,-0.9906523157354741,-0.9773992365458284,-0.9584779747662253,-0.9338364137523314,-0.9037147696844272,-0.8682898011702633,-0.8277693974712008,-0.7773251819997995,-0.7213053709875794,-0.6601118096583036,-0.5941834135825275,-0.5274900072294031,-0.4573711298583305,-0.3842821172383992,-0.30869762301932724,0.021423673945974997,0.2989893554961043,0.3799751180366684,0.4581434343009505,0.532914712358945,0.603734495729924,0.666234400981125,0.7243686983571251,0.7777564925426361,0.826047930058138,0.8608407098265047,0.8920133021117493,0.9194346173302392,0.9429893421675217,0.9781194770797086,0.996813367959426,0.9982071010050664,0.9992030196304125,0.9998007307471246],"type":"scatter","name":"y2","yaxis":"y","x":[0.015340112644426933,0.030680225288853866,0.0460203379332808,0.06136045057770773,0.1322811964200521,0.20320194226239643,0.2741226881047408,0.34504343394708514,0.41596417978942946,0.4868849256317738,0.5578056714741182,0.6287264173164625,0.7139672415771299,0.7992080658377971,0.8844488900984645,0.9696897143591319,1.113829778496663,1.2579698426341943,1.5711228641429789,1.8598222510985358,2.0145803783513556,2.1693385056041756,2.2589897392122458,2.3486409728203155,2.4382922064283856,2.5279434400364558,2.6076148765422063,2.6872863130479567,2.7669577495537077,2.846629186059458,2.9164938562436538,2.986358526427849,3.056223196612044,3.1260878667962397,3.202259110951535,3.27843035510683,3.354601599262125,3.43077284341742,3.5073967941880335,3.5840207449586465,3.66064469572926,3.7372686464998734,3.8219862223788263,3.906703798257779,3.9914213741367313,4.076138950015684,4.156745585793892,4.2373522215721,4.317958857350307,4.398565493128515,4.733814287353519,5.016022362597284,5.102158380829305,5.188294399061325,5.274430417293346,5.360566435525367,5.44153683320975,5.522507230894133,5.603477628578516,5.684448026262899,5.74930845431733,5.814168882371761,5.879029310426192,5.943889738480623,6.073610594589485,6.203331450698347,6.2232949148186565,6.243258378938966,6.263221843059276]}], {"showlegend":true,"xaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[1.0,2.0,3.0,4.0,5.0,6.0],"visible":true,"ticks":"inside","range":[0.015340112644426933,6.263221843059276],"domain":[0.08063575386410031,0.9934383202099737],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["1","2","3","4","5","6"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[-0.75,-0.5,-0.25,0.0,0.25,0.5,0.75],"visible":true,"ticks":"inside","range":[-0.9998797971880191,0.9999999466866806],"domain":[0.03762029746281716,0.9901574803149606],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["-0.75","-0.50","-0.25","0.00","0.25","0.50","0.75"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>Well, we already knew that should just be $\cos(x)$.  The point is we can easily make the an approximate derivative function from <code>f</code> with the definition <code>fp&#40;x&#41; &#61; Df&#40;f&#41;&#40;x&#41;</code>. </p><div class="alert alert-success" role="alert">
<div class="markdown"><p><strong>Parsing <code>Df&#40;f&#41;&#40;x&#41;</code></strong> Seeing the pair of parenthesis can lead to confusion, as it isn't common math notation. Here parentheses are not used for grouping, but rather function application. There are two function applications and the associativity rules for function application are left to right, as with most – but not all – operations. So <code>Df&#40;f&#41;</code> is done first. This returns a function (the approximate derivative) which is then evaluated at <code>x</code>.</p>
</div> 
</div>
<div class="alert alert-success" role="alert">
<div class="markdown"><p><strong>Defining <code>fp</code> or <code>fp&#40;x&#41;</code></strong> We could also have just plotted <code>&#91;f, Df&#40;f&#41;&#93;</code> without naming <code>fp</code>. As well, could have written <code>fp &#61; Df&#40;f&#41;</code>, but that creates <code>fp</code> as an <em>anonymous</em> function and we then couldn't redefine it through <code>fp&#40;x&#41; &#61; ...</code>, which would attempt to make it a <em>generic</em> function.</p>
</div> 
</div>
<p>Let's look at a different function, where we don't know in our heads the answer.</p><pre class="sourceCode julia">f(x) = exp(x)/(1 + exp(x))
plot([f, Df(f)], 0, 5)</pre>
    <div id="52644b28-e3ea-434e-8b31-a16511a1248d" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('52644b28-e3ea-434e-8b31-a16511a1248d');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.5122048488891306,0.6225356070470957,0.6838786988118317,0.7312670528758386,0.7773448392409867,0.8145725086096052,0.848939144436672,0.8820172796987661,0.9059600510555974,0.923272318840618,0.9387808653424419,0.951386720594286,0.9624456475829317,0.9706953710464699,0.9774022891934558,0.9818652442397385,0.9861538236287487,0.9892659259910299,0.9928711737386635],"type":"scatter","name":"y1","yaxis":"y","x":[0.04882909509894066,0.5003245858418641,0.7716545565281194,1.0010605935788286,1.250259850165257,1.4799995226731408,1.7263047320324492,2.0116734716926614,2.2652755305551073,2.4876616827011,2.7301222832765975,2.9740238937640604,3.2436883131220213,3.5002672037242175,3.7670497175567528,3.9916237683342257,4.26580322993182,4.523540010643543,4.9364543200802995]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.24999068370945565,0.24996275049815608,0.24991619884673355,0.2498510398574183,0.24837285561574163,0.24534655418406714,0.24084746419461567,0.2349850203309245,0.22633129814764175,0.21618862255934346,0.20667860756162781,0.1965155482785974,0.17307982824732449,0.15104413275679462,0.12824146189416297,0.10406281392150163,0.08519643879267846,0.07084054454153943,0.05747134990130576,0.04625002603120265,0.03614402110940773,0.02844586788341985,0.02208705440764902,0.01780587899347097,0.013654466446411107,0.010618850243560018,0.0070780048488927605],"type":"scatter","name":"y2","yaxis":"y","x":[0.012207273774735164,0.02441454754947033,0.036621821324205495,0.04882909509894066,0.16170296778467153,0.2745768404704024,0.3874507131561332,0.5003245858418641,0.6359895711849918,0.7716545565281194,0.886357575053474,1.0010605935788286,1.250259850165257,1.4799995226731408,1.7263047320324492,2.0116734716926614,2.2652755305551073,2.4876616827011,2.7301222832765975,2.9740238937640604,3.2436883131220213,3.5002672037242175,3.7670497175567528,3.9916237683342257,4.26580322993182,4.523540010643543,4.9364543200802995]}], {"showlegend":true,"xaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[1.0,2.0,3.0,4.0],"visible":true,"ticks":"inside","range":[0.012207273774735164,4.9364543200802995],"domain":[0.05100612423447069,0.9934383202099737],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["1","2","3","4"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[0.2,0.4,0.6000000000000001,0.8],"visible":true,"ticks":"inside","range":[0.0070780048488927605,0.9928711737386635],"domain":[0.03762029746281716,0.9901574803149606],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["0.2","0.4","0.6","0.8"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>If we look, we can see from the graph that <code>f</code> is increasing and <code>Df&#40;f&#41;</code> is positive – this is no coincidence, of course.</p><div class="alert alert-danger" role="alert">
<span class="glyphicon glyphicon-th" aria-hidden="true"></span>
<span class="text-uppercase">example:</span><div class="markdown"><p>Critical points</p>
</div>
</div>
<p>A function's <em>critical points</em> are where its derivative is $0$ or undefined. We can examine these by graphing the function's derivative. Let's do so for the polynomial $f(x) = x^3 - 5x + 4$:</p><pre class="sourceCode julia">f(x) = x^3 -5x + 4
fp(x) = Df(f)(x)
plot(fp, -5, 5)</pre>
    <div id="70daf920-a7d1-494c-b8c5-0e033d65fd10" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('70daf920-a7d1-494c-b8c5-0e033d65fd10');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[69.26934901230197,68.54227905250809,67.81878312267509,67.09886548605937,60.61159609771494,54.430098828106566,48.554375098319724,42.984421355640734,36.69441852593991,30.846135601336755,26.246102535765203,21.96183235270155,17.665717777504142,13.742204885147657,10.455167398504273,7.484811348490439,4.652033158691893,2.1832523344755828,-0.22190285164924717,-2.1384464865548125,-3.431591721891891,-4.3388530102106415,-4.816879961566656,-4.998173164239006,-4.85771041169869,-4.364524830435812,-3.5125344854947116,-2.3036160978762155,-0.5515307321957152,1.636867796861452,4.124142627404126,7.006413760279884,10.422177965097035,14.264979775191478,17.83083796169649,21.699297292343545,26.832491428763205,32.416732054230124,38.07736703720366,44.13657137547489,54.67464774255859,66.23571380259818,68.10574291193916],"type":"scatter","name":"y1","yaxis":"y","x":[-4.975585452450529,-4.951170904901059,-4.926756357351589,-4.9023418098021185,-4.676594064430657,-4.450846319059195,-4.225098573687734,-3.9993508283162718,-3.7280208576300167,-3.456690886943761,-3.227284849893052,-2.997878812842343,-2.7486795562559143,-2.499480299669486,-2.2697406271616023,-2.0400009546537183,-1.7936957452944098,-1.5473905359351015,-1.2620217962748894,-0.9766530566146772,-0.7230509977522314,-0.46944893888978556,-0.24706278674379273,-0.024676634597799892,0.21778396597769734,0.46024456655319457,0.7041461770406577,0.9480477875281209,1.2177122068860817,1.4873766262440427,1.7439555168462386,2.0005344074484346,2.26731692128097,2.5340994351135055,2.758673485890978,2.983247536668451,3.257426998266046,3.531606459863641,3.789343240575363,4.047080021287085,4.459994330723842,4.872908640160599,4.9364543200802995]}], {"showlegend":true,"xaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[-4.0,-2.0,0.0,2.0,4.0],"visible":true,"ticks":"inside","range":[-4.975585452450529,4.9364543200802995],"domain":[0.03619130941965587,0.9934383202099738],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["-4","-2","0","2","4"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[0.0,10.0,20.0,30.0,40.0,50.0,60.0],"visible":true,"ticks":"inside","range":[-4.998173164239006,69.26934901230197],"domain":[0.03762029746281716,0.9901574803149606],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["0","10","20","30","40","50","60"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>You can check the zeroes graphically, say by zooming in a bit and adding the line $y=0$:</p><pre class="sourceCode julia">plot([fp, x->0], -2, 2) </pre>
    <div id="6ec03b81-a433-4f8c-be1e-29ca7b01cb11" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('6ec03b81-a433-4f8c-be1e-29ca7b01cb11');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[6.883096226317775,6.76676474853366,6.651005435287516,6.535818553032868,5.497855415370623,4.508815631965035,3.5686998245409995,2.67750728255578,1.6711069861230499,0.7353815334454339,-0.0006236788863134279,-0.6861068158059425,-1.3734851478375276,-2.001247256799843,-2.527173226241075,-3.0024301267417286,-3.455674768559902,-3.850679686223657,-4.235504480476493,-4.542151454955956,-4.7490546606354656,-4.894216498740889,-4.970700739903577,-4.999707758912564,-4.977233691860761,-4.898323968660634,-4.762005456626639,-4.5685785377003185,-4.288244959127496,-3.938101222900059,-3.540137161195389,-3.0789738314496162,-2.532451448544748,-1.9176031429424256,-1.3470658366543375,-0.7281123259872402,0.09319869320734142,0.9866773176270272,1.8923786981872581,2.8618513780998,3.684437555051545,4.547943888155714,5.452369489233888,6.397714358286066,6.546832320708518,6.696918930515494,6.847974987067573],"type":"scatter","name":"y1","yaxis":"y","x":[-1.9902341809802118,-1.9804683619604238,-1.9707025429406357,-1.9609367239208475,-1.8706376257722628,-1.780338527623678,-1.6900394294750933,-1.5997403313265088,-1.4912083430520067,-1.3826763547775045,-1.2909139399572207,-1.1991515251369371,-1.0994718225023656,-0.9997921198677943,-0.9078962508646409,-0.8160003818614874,-0.717478298117764,-0.6189562143740406,-0.5048087185099557,-0.3906612226458709,-0.2892203991008926,-0.18777957555591424,-0.09882511469751709,-0.009870653839119958,0.08711358639107895,0.18409782662127785,0.2816584708162631,0.3792191150112484,0.48708488275443274,0.5949506504976171,0.6975822067384955,0.8002137629793739,0.9069267685123881,1.0136397740454022,1.1034693943563914,1.1932990146673805,1.3029707993064186,1.4126425839454564,1.5157372962301452,1.618832008514834,1.7014148704021854,1.7839977322895368,1.8665805941768883,1.9491634560642397,1.9618725920481799,1.9745817280321198,1.9872908640160598]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"type":"scatter","name":"y2","yaxis":"y","x":[-1.9609367239208475,-1.5997403313265088,-1.3826763547775045,-1.1991515251369371,-0.9997921198677943,-0.8160003818614874,-0.6189562143740406,-0.3906612226458709,-0.18777957555591424,-0.009870653839119958,0.18409782662127785,0.3792191150112484,0.5949506504976171,0.8002137629793739,1.0136397740454022,1.1932990146673805,1.4126425839454564,1.618832008514834,1.9491634560642397]}], {"showlegend":true,"xaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[-1.5,-1.0,-0.5,0.0,0.5,1.0,1.5],"visible":true,"ticks":"inside","range":[-1.9902341809802118,1.9872908640160598],"domain":[0.0658209390492855,0.9934383202099738],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["-1.5","-1.0","-0.5","0.0","0.5","1.0","1.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[-2.5,0.0,2.5,5.0],"visible":true,"ticks":"inside","range":[-4.999707758912564,6.883096226317775],"domain":[0.03762029746281716,0.9901574803149606],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["-2.5","0.0","2.5","5.0"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>If you want, we can find the roots numerically. For example,</p><pre class="sourceCode julia">using Roots
fzeros(fp, -10, 10)</pre>
<pre class="output">
2-element Array{Float64,1}:
 -1.29099
  1.29099</pre>

<div class="alert alert-danger" role="alert">
<span class="glyphicon glyphicon-th" aria-hidden="true"></span>
<span class="text-uppercase">example:</span><div class="markdown"><p>When is a function increasing?</p>
</div>
</div>
<p>Let $f(x) = \cos(x)$ over the interval $[0, 360]$ (in degrees). When is the function increasing?</p><p>From the relationship of the derivative and the function, we know the answer is when $f'(x) > 0$. For this example, we can solve this directly as $f'(x) = -\sin(x)$ and we know when that is positive (well you are supposed to anyways: when the angle is in the third and fourth quadrants). Let's see how we would do this task with <code>julia</code> and compare.</p><p>First, we only need the derivative, so we just ask:</p><pre class="sourceCode julia">f(x) = cosd(x)			# using degrees
fp(x) = Df(f)(x)                # use default h</pre>
<pre class="output">
fp (generic function with 1 method)</pre>

<p>Then we wish to indicate on the graph where <code>fp&#40;x&#41; &gt; 0</code>. We can do this by defining a function that is $0$ when that is the case and <code>NaN</code> otherwise (so that those points are not plotted). We do so below with an anonymous function:</p><pre class="sourceCode julia">plot([f, x -> fp(x) > 0 ? 0.0 : NaN], 0, 360)</pre>
    <div id="b11761c5-03c3-4eb6-bbb9-2e6bb9b0a251" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('b11761c5-03c3-4eb6-bbb9-2e6bb9b0a251');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.9998823427793041,0.9995293988036597,0.9989412511258812,0.9981180381456108,0.9912635930571241,0.9794254271719192,0.9626630585777484,0.9410607625022607,0.91472714760713,0.8837946099423325,0.8484186673058938,0.8087771773557118,0.7557699328130643,0.6972745896094515,0.6337159175071654,0.5655554541357316,0.44122793659489123,0.30774917005250263,-0.0003265373422793792,-0.28501868752303844,-0.4293600343151133,-0.5634386820713226,-0.6351428207544184,-0.7017455165075589,-0.7627118190167937,-0.8175520492638961,-0.8607893509321662,-0.8985656492394167,-0.9306412845153702,-0.9568127631272823,-0.9747720599950521,-0.9879753591208756,-0.9963582404588714,-0.9998798032011988,-0.9981603548015345,-0.9906523213158552,-0.9773992437347957,-0.9584779800169604,-0.9338364217545462,-0.9037147772592401,-0.8682898111179286,-0.8277694097063503,-0.777325185226698,-0.7213053811863239,-0.6601118151003937,-0.594183414721154,-0.5274900124457361,-0.4573711362144594,-0.384282131870235,-0.3086976330078868,0.021423667814140863,0.2989893509828227,0.37997512139859846,0.45814344184897215,0.532914707724733,0.6037345029902234,0.6662343946934728,0.7243687028469895,0.7777564951822342,0.8260479415646008,0.8608407130615462,0.8920133045781485,0.9194346228819075,0.9429893503466328,0.9781194816444272,0.9968133746723455,0.9982071064522624,0.9992030260843753,0.9998007366681562],"type":"scatter","name":"y1","yaxis":"y","x":[0.8789237117809318,1.7578474235618635,2.636771135342795,3.515694847123727,7.579154263810038,11.642613680496348,15.70607309718266,19.76953251386897,23.83299193055528,27.896451347241594,31.959910763927905,36.023370180614215,40.907309652966816,45.79124912531941,50.675188597672005,55.5591280700246,63.81774540385013,72.07636273767567,90.01870921189851,106.55996563246615,115.42695316940124,124.29394070633634,129.43057802022017,134.567215334104,139.7038526479878,144.8404899618716,149.40532702139564,153.97016408091966,158.53500114044368,163.0998381999677,167.10278893859558,171.10573967722345,175.10869041585133,179.1116411544792,183.47593196483814,187.8402227751971,192.20451358555607,196.568804395915,200.95903338468935,205.3492623734637,209.73949136223803,214.12972035101237,218.98367989945564,223.83763944789894,228.69159899634224,233.54555854478554,238.16397857562507,242.7823986064646,247.40081863730413,252.01923866814366,271.2275796640862,287.39691132006425,292.332141628821,297.26737193757765,302.2026022463343,307.13783255509105,311.7770946079021,316.41635666071306,321.05561871352404,325.6948807663351,329.4111095512659,333.12733833619666,336.8435671211275,340.5597959060583,347.99225347591994,355.4247110457816,356.5685332843362,357.7123555228908,358.8561777614454]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[null,null,null,null,null,null,null,null,null,null,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],"type":"scatter","name":"y2","yaxis":"y","x":[3.515694847123727,36.023370180614215,55.5591280700246,72.07636273767567,90.01870921189851,106.55996563246615,124.29394070633634,144.8404899618716,163.0998381999677,179.1116411544792,196.568804395915,214.12972035101237,233.54555854478554,252.01923866814366,271.2275796640862,287.39691132006425,307.13783255509105,325.6948807663351,355.4247110457816]}], {"showlegend":true,"xaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[50.0,100.0,150.0,200.0,250.0,300.0,350.0],"visible":true,"ticks":"inside","range":[0.8789237117809318,358.8561777614454],"domain":[0.08063575386410031,0.9934383202099737],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["50","100","150","200","250","300","350"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[-0.75,-0.5,-0.25,0.0,0.25,0.5,0.75],"visible":true,"ticks":"inside","range":[-0.9998798032011988,0.9998823427793041],"domain":[0.03762029746281716,0.9901574803149606],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["-0.75","-0.50","-0.25","0.00","0.25","0.50","0.75"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>The graph of the second function is only drawn when the first function is increasing. It is from 180 to 360 degrees, or the third and fourth quadrant, as anticipated.</p><h3>Practice</h3><h4>question</h4><p>Let $f(x) = e^x$. Using a forward difference and $h=0.001$ graph both the function and its approximate derivative over the interval $[0, 3]$. Estimate graphically the largest difference between the function and its approximate derivative.</p><form name="WeaveQuestion" data-id="7fUAPqDH" data-controltype="radio">
<div class="form-group ">
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_7fUAPqDH" value="1"><div class="markdown"><p>It is about 0.1</p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_7fUAPqDH" value="2"><div class="markdown"><p>It is about 0</p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_7fUAPqDH" value="3"><div class="markdown"><p>It is about 0.01</p>
</div>
    </label>
    </div>
    


<div id="7fUAPqDH_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_7fUAPqDH']").on("change", function() {
  correct = this.value == 2;

  if(correct) {
     $("#7fUAPqDH_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#7fUAPqDH_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>
<h4>question</h4><p>Let $f(x) = x^2 \exp(-x)$. Using $h=0.0001$ and an approximate derivative, estimate graphically where $f'(x)$ is positive on the interval $[0,3]$.</p><form name="WeaveQuestion" data-id="tdbv2KMM" data-controltype="radio">
<div class="form-group ">
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_tdbv2KMM" value="1"><div class="markdown"><p>From 0 to about 0.45</p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_tdbv2KMM" value="2"><div class="markdown"><p>It is for the entire interval</p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_tdbv2KMM" value="3"><div class="markdown"><p>Between 0 and 2</p>
</div>
    </label>
    </div>
    


<div id="tdbv2KMM_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_tdbv2KMM']").on("change", function() {
  correct = this.value == 3;

  if(correct) {
     $("#tdbv2KMM_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#tdbv2KMM_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>
<h4>question</h4><p>The critical points of a function are where its derivative is undefined or where its derivative is $0$. For the function $f(x) = 3x^4 -28x^3 + 96x^2 - 144x$ graphically find any critical points over the interval $[0,10]$</p><form name="WeaveQuestion" data-id="kKjSA04j" data-controltype="radio">
<div class="form-group ">
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_kKjSA04j" value="1"><div class="markdown"><p>There are two distinct ones: 2, 2.6667</p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_kKjSA04j" value="2"><div class="markdown"><p>There is one at 3</p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_kKjSA04j" value="3"><div class="markdown"><p>There are two distinct ones: 2, 3</p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_kKjSA04j" value="4"><div class="markdown"><p>There are two distinct ones: 2, 4.69</p>
</div>
    </label>
    </div>
    


<div id="kKjSA04j_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_kKjSA04j']").on("change", function() {
  correct = this.value == 3;

  if(correct) {
     $("#kKjSA04j_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#kKjSA04j_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>
<h2>Improvements to the basic forward difference equation</h2><p>The error in the approximation of the derivative depends on the size of $h$. Mathematically, as $h$ gets smaller we get better approximations, though with the computer other complications arise. To see mathematically that this is the case, let's look at the difference between the approximate numeric derivative from the forward difference and a known derivative.</p><pre class="sourceCode julia">f(x) = sin(x)
fp(x) = cos(x)
[ Df(f,h=h)(.5) - fp(.5) for h=[.1, .01, .001, .0001, .00001] ] </pre>
<pre class="output">
5-element Array{Float64,1}:
 -0.0254132  
 -0.00241173 
 -0.000239859
 -2.39727e-5 
 -2.39715e-6 </pre>

<p>It gets better as $h$ gets smaller. In fact, it looks like when $h$ gets smaller by a factor of $1/10$ so does the error. Let's look a little deeper though. Rather than type in the values of $h$ as above, let's use an expression to compute them. Here we find the powers $10^{-1}, \dots, 10^{-16}$ at once and then compute the differences:</p><pre class="sourceCode julia">hs = [(1/10)^i for i in 1:16];
out = [ Df(f,h=h)(.5) - fp(.5) for h in hs ];
[hs out]</pre>
<pre class="output">
16×2 Array{Float64,2}:
 0.1      -0.0254132  
 0.01     -0.00241173 
 0.001    -0.000239859
 0.0001   -2.39727e-5 
 1.0e-5   -2.39715e-6 
 1.0e-6   -2.3969e-7  
 1.0e-7   -2.4695e-8  
 1.0e-8    2.85032e-10
 1.0e-9    2.85032e-10
 1.0e-10  -1.10737e-7 
 1.0e-11  -1.22096e-6 
 1.0e-12  -6.77208e-6 
 1.0e-13   4.87391e-5 
 1.0e-14  -0.000506372
 1.0e-15   0.0105959  
 1.0e-16   0.23264    </pre>

<p>When we look, we see that for awhile the approximation gets better (to about <code>1e-9</code>), but then does a U-turn and starts getting worse. The mathematical approximation gets better and better, but what happens is the computational error gets worse. We'll see below how to pick the $h$ that best balances these off, but first lets look at how using different approximations for the derivative can improve the "mathematical" error.</p><h3>Central difference</h3><p>It turns out that just by looking to the left and the right we can improve the mathematical error from getting better at a rate of $h$ to a rate of $h^2$, provided our function is smooth enough and we don't have issues on the boundaries. The formula, called the <em>central difference</em> approximation to the derivative is:</p>$$~
f'(x) \approx \frac{ f(x + h) - f(x - h) }{2h}
~$$
<p>For this the mathematical error is like $h^2$, not $h$.</p><p>Let's compare. To make our life easier we again create some functions, as we did with <code>Df</code> above.</p><pre class="sourceCode julia">central_difference(f, x0, h) = (f(x0 + h) - f(x0 - h)) / (2h)
Dc(f; h=0.0001) = x -> central_difference(f, x, h) </pre>
<pre class="output">
Dc (generic function with 1 method)</pre>

<p>Now to see whether a forward difference or central difference works better. We can do so with a table. Again with $f(x) = \sin(x)$</p><pre class="sourceCode julia">f(x) = sin(x)
fp(x) = cos(x)
using_D =  [ Df(f,h=h)(.5) - fp(.5) for h in hs ];
using_Dc = [ Dc(f,h=h)(.5) - fp(.5) for h in hs ]; 
[hs using_D using_Dc]</pre>
<pre class="output">
16×3 Array{Float64,2}:
 0.1      -0.0254132    -0.00146191 
 0.01     -0.00241173   -1.46263e-5 
 0.001    -0.000239859  -1.46264e-7 
 0.0001   -2.39727e-5   -1.46274e-9 
 1.0e-5   -2.39715e-6   -1.75036e-11
 1.0e-6   -2.3969e-7     7.47635e-12
 1.0e-7   -2.4695e-8    -2.70079e-10
 1.0e-8    2.85032e-10   2.85032e-10
 1.0e-9    2.85032e-10   2.85032e-10
 1.0e-10  -1.10737e-7   -1.10737e-7 
 1.0e-11  -1.22096e-6   -1.22096e-6 
 1.0e-12  -6.77208e-6   -6.77208e-6 
 1.0e-13   4.87391e-5    4.87391e-5 
 1.0e-14  -0.000506372  -0.000506372
 1.0e-15   0.0105959     0.0105959  
 1.0e-16   0.23264       0.23264    </pre>

<p>The errors for the central difference are either much smaller for the same size $h$ or the same. We see that we can use a larger $h$ to get the most accuracy in this example.</p><div class="alert alert-danger" role="alert">
<span class="glyphicon glyphicon-th" aria-hidden="true"></span>
<span class="text-uppercase">example:</span><div class="markdown"><p>When does the tangent line hit 0?</p>
</div>
</div>
<p>Let $f(x) = 10/(1+x^2) - 10\exp(-(1/2)x^2)$. The tangent line at $x=c$ is given by</p>$$~
y = f( c) - f'( c)(x - c)
~$$
<p>and this intersects the $x$ axis when $y=0$. Solving this gives:</p>$$~
c - f( c)/f'( c)
~$$
<p>Our goal is to compute this value for any $c > 0$.</p><p>Doing so is easy:</p><pre class="sourceCode julia">f(x) = 10/(1+x^2) - 10*exp(-(1/2)*x^2)
fp(x) = Dc(f)(x)
intersection_point(c) = c - f(c)/fp(c)</pre>
<pre class="output">
intersection_point (generic function with 1 method)</pre>

<p>For example, when $c=1$ we have:</p><pre class="sourceCode julia">c = 1;
intersection_point(c)</pre>
<div class="well well-sm">
2.000000018978514</div>

<p>You can tell from the graph of $f(x)$ that this value should be more than 1, as it is.</p><pre class="sourceCode julia">plot([f, x -> 0, x -> f(c) + fp(c)*(x-c)], .5, 2.1) </pre>
    <div id="3060daff-4d03-4ffc-b84c-161aa13b9241" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('3060daff-4d03-4ffc-b84c-161aa13b9241');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[-0.8327017009652531,-0.8403709828705113,-0.847975435079289,-0.8555136463327075,-0.9218405945896047,-0.9814095361398323,-1.0334175623207509,-1.077248071506025,-1.0994650123502483,-1.1185023047691045,-1.1343158102607838,-1.1468812976711895,-1.1607324432788984,-1.1653724579733415,-1.1602223801231872,-1.1448639301234582,-1.1221213678539241,-1.0916516150288356,-1.05102977074048,-1.00289308536789,-0.9387403394332665,-0.8667674160720473,-0.7233980963296349,-0.5859534336995655,-0.42891327458696216,-0.26833134859030583,-0.09309791866321948,0.06696834623755787,0.22281247942111815,0.34358195901548116,0.41206592212145665,0.4763459338779934,0.5328235369661543,0.5854091448184122,0.6614848625829184,0.7275643920976662,0.7368591006123248],"type":"scatter","name":"y1","yaxis":"y","x":[0.5039063276079152,0.5078126552158305,0.5117189828237458,0.515625310431661,0.5517449496910949,0.5878645889505287,0.6239842282099626,0.6601038674693965,0.681810265124297,0.7035166627791973,0.7252230604340978,0.7469294580889982,0.7836344240171117,0.8203393899452252,0.8602112709990537,0.9000831520528824,0.9368414996541437,0.973599847255405,1.0130086807528944,1.0524175142503838,1.0980765125960177,1.1437355109416516,1.2248881697776344,1.2960517384643522,1.373639130648511,1.4516876460044994,1.5379802601990469,1.6200855051917495,1.7054559096181607,1.7773196058669523,1.8211883197225673,1.8650570335781826,1.9062949184920581,1.9475328034059336,2.0135990929158147,2.079665382425696,2.089832691212848]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"type":"scatter","name":"y2","yaxis":"y","x":[0.515625310431661,0.6601038674693965,0.7469294580889982,0.8203393899452252,0.9000831520528824,0.973599847255405,1.0524175142503838,1.1437355109416516,1.2248881697776344,1.2960517384643522,1.373639130648511,1.4516876460044994,1.5379802601990469,1.6200855051917495,1.7054559096181607,1.7773196058669523,1.8650570335781826,1.9475328034059336,2.079665382425696]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(62, 164, 78, 1.000)","shape":"linear","dash":"solid","width":1},"y":[-1.581314139611449,-1.427400182576914,-1.3349043098458964,-1.2567002266290606,-1.1717486723883546,-1.0934308534765371,-1.0094658744502103,-0.9121842119849033,-0.8257317507933275,-0.7499207330350945,-0.6672663738561389,-0.5841207771294683,-0.49219268768939783,-0.4047254301999964,-0.3137797768912107,-0.2372229086364258,-0.14375564985462697,-0.05589366982154065,0.08486803563208078],"type":"scatter","name":"y3","yaxis":"y","x":[0.515625310431661,0.6601038674693965,0.7469294580889982,0.8203393899452252,0.9000831520528824,0.973599847255405,1.0524175142503838,1.1437355109416516,1.2248881697776344,1.2960517384643522,1.373639130648511,1.4516876460044994,1.5379802601990469,1.6200855051917495,1.7054559096181607,1.7773196058669523,1.8650570335781826,1.9475328034059336,2.079665382425696]}], {"showlegend":true,"xaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[0.6000000000000001,0.9000000000000001,1.2000000000000002,1.5000000000000002,1.8000000000000003],"visible":true,"ticks":"inside","range":[0.5039063276079152,2.089832691212848],"domain":[0.0658209390492855,0.9934383202099738],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["0.6","0.9","1.2","1.5","1.8"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[-1.5,-1.0,-0.5,0.0,0.5],"visible":true,"ticks":"inside","range":[-1.581314139611449,0.7368591006123248],"domain":[0.03762029746281716,0.9901574803149606],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["-1.5","-1.0","-0.5","0.0","0.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p><hr/></p><div class="alert alert-info" role="alert">
<div class="markdown"><p>More generally ...</p>
</div> 
</div>
<p>We could have defined <code>intersection_point</code> to accept a function with:</p><pre class="sourceCode julia">intersection_point(f, c) = c  - f(c)/Dc(f)(c)</pre>
<pre class="output">
intersection_point (generic function with 2 methods)</pre>

<p>Then it could easily be reused for other problems.</p><h3>Practice</h3><h4>question</h4><p>Let </p><pre class="sourceCode julia">f(x) = besselj(1, x)</pre>
<pre class="output">
f (generic function with 1 method)</pre>

<p>This defines $f$ as a Bessel function of the first kind with order $\alpha=1$. Plot the approximate derivative over the interval $[0,5]$. There is one zero. What is its approximate value:</p><form name='WeaveQuestion' data-id='XqtWHelS' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>



<div class="input-group">
<input id="XqtWHelS" type="number" class="form-control">

</div>
  
<div id='XqtWHelS_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#XqtWHelS').on('change', function() {
  correct = Math.abs(this.value - 1.8411837814875183) <= 0.1;

  if(correct) {
     $('#XqtWHelS_message').html('<div class="alert alert-success"><span class="glyphicon glyphicon-thumbs-up">&nbsp;Correct</span></div>');
  } else {
     $('#XqtWHelS_message').html('<div class="alert alert-danger"><span class="glyphicon glyphicon-thumbs-down">&nbsp;Incorrect</span></div>');
  }
});
</script>
<h4>question</h4><p>Let $f(x) = \sin(\cos(x))$. Plot the approximate derivative of $f$. How many zeros are there between $5$ and $20$?</p><form name='WeaveQuestion' data-id='VqTspSTh' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>



<div class="input-group">
<input id="VqTspSTh" type="number" class="form-control">

</div>
  
<div id='VqTspSTh_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#VqTspSTh').on('change', function() {
  correct = Math.abs(this.value - 5) <= 1.0e-10;

  if(correct) {
     $('#VqTspSTh_message').html('<div class="alert alert-success"><span class="glyphicon glyphicon-thumbs-up">&nbsp;Correct</span></div>');
  } else {
     $('#VqTspSTh_message').html('<div class="alert alert-danger"><span class="glyphicon glyphicon-thumbs-down">&nbsp;Incorrect</span></div>');
  }
});
</script>
<h4>question</h4><p>Let $f(x) = |x^2 - 2|$. Plot the derivative of $f(x)$ over the interval $[-2,2]$. How many critical points do you see? (A critical point is where the derivative is $0$ <em>or</em> undefined.)</p><form name='WeaveQuestion' data-id='ii6zwIkG' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>



<div class="input-group">
<input id="ii6zwIkG" type="number" class="form-control">

</div>
  
<div id='ii6zwIkG_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#ii6zwIkG').on('change', function() {
  correct = Math.abs(this.value - 3) <= 1.0e-10;

  if(correct) {
     $('#ii6zwIkG_message').html('<div class="alert alert-success"><span class="glyphicon glyphicon-thumbs-up">&nbsp;Correct</span></div>');
  } else {
     $('#ii6zwIkG_message').html('<div class="alert alert-danger"><span class="glyphicon glyphicon-thumbs-down">&nbsp;Incorrect</span></div>');
  }
});
</script>
<h2>Automatic differentiation</h2><p>We discuss now <a href="http://en.wikipedia.org/wiki/Automatic_differentiation">Forward Mode Automatic Differentiation</a>. </p><p>Automatic differentiation avoids the numeric instability issues of finite differences by using a different approach. Whereas finite differences have a long history, automatic differentiation only dates back to the 60s.</p><p>The <code>ForwardDiff</code> package implements automatic differentiation. The <code>Roots</code> package provides an interface <code>D</code>, used like <code>D&#40;f&#41;</code>. The <code>MTH229</code> package overloads the idea of <code>&#39;</code> – at the expense of a warning on startup – that uses automatic differentiation when the notation <code>f&#39;</code> is encountered.</p><p>That means, we can find derivatives, as familiarly as:</p><pre class="sourceCode julia">f(x) = x^x
f'(1)</pre>
<div class="well well-sm">
1.0</div>

<p>Unlike, finite differences automatic differentiation does not have issues arising from the loss of precision encountered when subtracting two like-sized numbers. Unlike symbolic derivatives (such as those found by the Wolfram Alpha website used by your iPhone's Siri) they can be computed quickly, even if the computations defining the function involve many steps.</p><p>So what is automatic differentiation? The idea of the forward mode is quite intuitive. The <em>tangent line</em> approximation of a function at the point $c$ becomes</p>$$~
f(x) = f(c) + f'( c)(x-c) + O((x-c)^2)
~$$
<p>Where the notation $O(x-c)^2$ means that the last term is not precisely spelled out, but is like some constant times the difference $(x-c)^2$. This has many applications, but for this one it reduces the knowledge of the function values at this level to two values $(f(c), f'(c))$</p><p>Now consider the product of two functions $f(x)$ and $g(x)$? The above formula applied to $f \cdot g$ is:</p>$$~
(f\cdot g)(x) = f(c) \cdot g(c) + (f'( c)g( c) + f( c)g'( c))(x-c) + O((x-c)^2)
~$$
<p>This follows by the product rule. Again we have that two values determine the product $f\cdot g$ at this level, these being $(f(c) \cdot g(c)$, and $f'( c)g( c) + f( c)g'( c)$. <em>But</em>, this combination can be made from the values $(f(c), f'(c))$ and $(g(c), g'(c))$ which represent $f$ and $g$. Hence it is enough to know the two values for $f$ and $g$ to compute the two values for $f\cdot g$.</p><p>In fact, the rules of derivatives allow us to say the same for addition, subtraction, multiplication, division, powers <em>and</em> composition. For composition this is from the chain rule:</p>$$~
(f \circ g)(x) = (f \circ g)(c) + f'( g(c)) g'(c) (x-c) + O((x-c)^2).
~$$
<p>Automatic differentiation can be implemented by extending how we store a value, storing both $(x, dx)$ as above.  With this, the rules of differentials inform us how we combine these values. For example:</p><ul>
<li>$(x, dx) + (y, dy) = (x + y, d(x+y)) = (x + y, 1dx +  1dy)$
</li>
<li>$(x, dx) \cdot (y, dy) = (xy, d(xy)) = (xy, y dx + x dy)$
</li>
<li>$(x, dx)^n = (x^n, d(x^n)) = (x^n, n x^{n-1} dx)$
</li>
</ul><p>etc.</p><p>For functions we need to use the chain rule:</p><ul>
<li>$f((x, dx)) = (f(x), d(f(x))) = (f(x), f'(x) dx )$
</li>
</ul><h3>Examples</h3><p>Using <code>&#39;</code>, we see that plotting a function and its derivative is straightforward:</p><pre class="sourceCode julia">f(x) = exp(-x)*sin(x)
plot(f, 0, 2pi)
plot!(f')</pre>
    <div id="dbbe520c-2495-41d0-a504-d263ee2659bc" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('dbbe520c-2495-41d0-a504-d263ee2659bc');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.015105996833920894,0.029748574357082655,0.0439349480414501,0.05767232678651347,0.08774881862557905,0.1155531558014491,0.14117341138992087,0.1646969299413319,0.18621016535057466,0.20579853198907716,0.22354626855211926,0.23953631408141743,0.2538501956303314,0.2665679270472552,0.2777679183616732,0.28752689526692055,0.295919828203821,0.30301987056001767,0.3088983055109026,0.31362450103953626,0.3178753530571101,0.32067221746316754,0.3221241609314753,0.32233602064357336,0.3194375900748282,0.31273069523459013,0.30459871557098683,0.29461411611514454,0.28312209014311385,0.27043606497285033,0.24007512668279063,0.20781169590759208,0.1779994393832693,0.14924216004798466,0.12045664647242711,0.09439115711712734,0.06803603306122757,0.04596645764281789,0.029869759050725257,0.01687240525111823,0.007803375880461677,0.0006804648360779016,-0.00514097370565439,-0.00922853722740933,-0.011886673332692506,-0.013364130157844469,-0.013651783299685864,-0.011694481156923625,-0.008790850389951477,-0.006327530830216565,-0.0037453718623388843,-0.0019153425791365445,-0.00016134727010977512],"type":"scatter","name":"y1","yaxis":"y","x":[0.015340112644426933,0.030680225288853866,0.0460203379332808,0.06136045057770773,0.09682082349887991,0.1322811964200521,0.16774156934122425,0.20320194226239643,0.23866231518356862,0.2741226881047408,0.30958306102591293,0.34504343394708514,0.3805038068682573,0.41596417978942946,0.45142455271060167,0.4868849256317738,0.522345298552946,0.5578056714741182,0.5932660443952904,0.6287264173164625,0.6713468294467961,0.7139672415771299,0.7565876537074635,0.7992080658377971,0.8844488900984645,0.9696897143591319,1.0417597464278976,1.113829778496663,1.1858998105654286,1.2579698426341943,1.4145463533885865,1.5711228641429789,1.7154725576207572,1.8598222510985358,2.0145803783513556,2.1693385056041756,2.3486409728203155,2.5279434400364558,2.6872863130479567,2.846629186059458,2.986358526427849,3.1260878667962397,3.27843035510683,3.43077284341742,3.5840207449586465,3.7372686464998734,4.076138950015684,4.398565493128515,4.733814287353519,5.016022362597284,5.360566435525367,5.684448026262899,6.203331450698347]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.9400313008003783,0.9109635712653961,0.8823513922603914,0.8541940702150002,0.7298993403746534,0.6151682795969936,0.5097979411384378,0.41352666630763035,0.32604411977146475,0.24700045941136684,0.17601467012797173,0.11268209476659535,0.07812817847682396,0.046092631994640254,0.016480915616524205,-0.010802087700348961,-0.058763131654267,-0.09854971697083464,-0.12636519560999704,-0.14931356140819818,-0.167823551877808,-0.18230882108583196,-0.19394526996825007,-0.20178403491438,-0.20628153362774254,-0.2078657383857306,-0.20446792679727677,-0.19474153739224176,-0.16101279438609362,-0.11423239792891304,-0.07552137583958576,-0.047419126427486705,-0.024116868406561322,-0.00803744717354661,0.002578525506038291,0.007467810808748861,0.008972056969434268,0.008533644264634942,0.006950896496236342,0.005123995532653005,0.0025061180637722543],"type":"scatter","name":"y2","yaxis":"y","x":[0.030447813520289725,0.04555551439615252,0.06066321527201531,0.0757709161478781,0.14561717079506847,0.21546342544225883,0.2853096800894492,0.35515593473663953,0.4250021893838299,0.49484844403102024,0.5646946986782106,0.634540953325401,0.6765156410344253,0.7184903287434495,0.7604650164524738,0.8024397041614981,0.8863890795795466,0.9703384549975952,1.0413165835059484,1.1122947120143016,1.183272840522655,1.2542509690310082,1.331353111091323,1.4084552531516379,1.4855573952119527,1.5626595372722676,1.7048222476208803,1.846984957969493,2.151811858376085,2.504983716209836,2.818841184920527,3.094065901557036,3.394134720793142,3.695986931399906,4.029723149633587,4.347264740148361,4.677434317096357,4.955366773288894,5.294690799976535,5.6136653932849425,6.124687427315576]}], {"showlegend":true,"xaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[1.0,2.0,3.0,4.0,5.0,6.0],"visible":true,"ticks":"inside","range":[0.015340112644426933,6.203331450698347],"domain":[0.0658209390492855,0.9934383202099738],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["1","2","3","4","5","6"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[0.0,0.25,0.5,0.75],"visible":true,"ticks":"inside","range":[-0.2078657383857306,0.9400313008003783],"domain":[0.03762029746281716,0.9901574803149606],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["0.00","0.25","0.50","0.75"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>Second derivatives are also available:</p><pre class="sourceCode julia">f(x) = x^2 - 2x
plot(f, -2, 2)
plot!(f')
plot!(f'')</pre>
    <div id="6b624025-c045-4447-b045-df4e5fb0bdb6" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('6b624025-c045-4447-b045-df4e5fb0bdb6');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[7.8831916566470515,7.767146283063122,6.730282328188602,5.758649790325666,5.206119008491925,4.677146611615816,4.248286680290317,3.8362674305121165,2.999168522685326,2.297857386921068,1.6210192240603245,0.9339386361709084,0.4108203201077878,0.01983873748545165,-0.3343036434758776,-0.6146310928325823,-0.8359350244676964,-0.9600854594971382,-0.9998139565639903,-0.9626354909286199,-0.9082086947676298,-0.8297260979148169,-0.7340150412772193,-0.6170469452374965,-0.3853475557648638,-0.09908873367218796,-0.05019045538592737],"type":"scatter","name":"y1","yaxis":"y","x":[-1.9804683619604238,-1.9609367239208475,-1.780338527623678,-1.5997403313265088,-1.4912083430520067,-1.3826763547775045,-1.2909139399572207,-1.1991515251369371,-0.9997921198677943,-0.8160003818614874,-0.6189562143740406,-0.3906612226458709,-0.18777957555591424,-0.009870653839119958,0.18409782662127785,0.3792191150112484,0.5949506504976171,0.8002137629793739,1.0136397740454022,1.1932990146673805,1.3029707993064186,1.4126425839454564,1.5157372962301452,1.618832008514834,1.7839977322895368,1.9491634560642397,1.9745817280321198]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[-5.883688117134719,-5.169413204617109,-4.7401637546249695,-4.377238807632073,-3.983000590756782,-3.619547825785917,-3.229888049609051,-2.778428985819378,-2.377225447528894,-2.0254060991056524,-1.6418285710553455,-1.2559713364522387,-0.8293568220324425,-0.42344387628588165,-0.0013885941491593723,0.35389205374581456,0.7876494554520845,1.195394206551398,1.8486329172302205],"type":"scatter","name":"y2","yaxis":"y","x":[-1.9418440585673598,-1.5847066023085543,-1.3700818773124848,-1.1886194038160367,-0.9915002953783909,-0.8097739128929583,-0.6149440248045254,-0.38921449290968907,-0.188612723764447,-0.01270304955282611,0.17908571447232718,0.3720143317738807,0.5853215889837787,0.7882780618570592,0.9993057029254203,1.1769460268729073,1.3938247277260423,1.597697103275699,1.9243164586151102]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(62, 164, 78, 1.000)","shape":"linear","dash":"solid","width":1},"y":[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0],"type":"scatter","name":"y3","yaxis":"y","x":[-1.9418440585673598,-1.5847066023085543,-1.3700818773124848,-1.1886194038160367,-0.9915002953783909,-0.8097739128929583,-0.6149440248045254,-0.38921449290968907,-0.188612723764447,-0.01270304955282611,0.17908571447232718,0.3720143317738807,0.5853215889837787,0.7882780618570592,0.9993057029254203,1.1769460268729073,1.3938247277260423,1.597697103275699,1.9243164586151102]}], {"showlegend":true,"xaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[-1.5,-1.0,-0.5,0.0,0.5,1.0,1.5],"visible":true,"ticks":"inside","range":[-1.9804683619604238,1.9745817280321198],"domain":[0.03619130941965587,0.9934383202099738],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["-1.5","-1.0","-0.5","0.0","0.5","1.0","1.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[-4.0,-2.0,0.0,2.0,4.0,6.0],"visible":true,"ticks":"inside","range":[-5.883688117134719,7.8831916566470515],"domain":[0.03762029746281716,0.9901574803149606],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["-4","-2","0","2","4","6"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>Here is an example where we plot the tangent line and the function. The <code>MTH229</code> package provides this function to compute a tangent line function:</p><pre class="sourceCode julia">tangent(f, c) = x -> f(c) + f'(c)*(x-c)</pre>
<p>This is employed as follows:</p><pre class="sourceCode julia">f(x) = x^x
c = 1
plot(f, 1/2, 2)
plot!(tangent(f, c))</pre>
    <div id="7833fc94-45fe-4234-b1b3-419fca1e8445" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('7833fc94-45fe-4234-b1b3-419fca1e8445');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.7104433502788389,0.7558189162797591,0.7955577269653803,0.836718488414824,0.8897876684713296,0.9470512988003489,1.0182144203635133,1.1148084409023828,1.2150930940168956,1.3157508154544255,1.4408647901747844,1.5851324315021469,1.7694032069528682,1.9727143502030466,2.2178904331665956,2.4552377896496194,2.615896952713424,2.7897818855105077,2.966335556834102,3.156656318178,3.4931743817848653,3.8733038495872787,3.9360523642321454],"type":"scatter","name":"y1","yaxis":"y","x":[0.5146487285296822,0.6500973757525592,0.7314963669584358,0.8003181780736487,0.8750779550495772,0.9439998568019422,1.0178914196097346,1.1035020415077985,1.1795826591665322,1.24629850481033,1.319036684982979,1.392207168129218,1.4731064939366065,1.5500801611172652,1.6301149152670258,1.6974871305002677,1.738614049739907,1.779740968979546,1.8184014860863045,1.857062003193063,1.9189991496085765,1.98093629602409,1.990468148012045]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.5290613138862358,0.6623264764956609,0.742413284460932,0.8101256613461175,0.8836802817842814,0.9514911358068119,1.024191538025239,1.1084220835659888,1.1832762522239701,1.2489166126161733,1.3204822251739083,1.3924731718139927,1.4720683691803753,1.5478011910563678,1.6265457539948431,1.692831903044686,1.7737597778144756,1.849834367032321,1.971711758322104],"type":"scatter","name":"y2","yaxis":"y","x":[0.5290613138862358,0.6623264764956609,0.742413284460932,0.8101256613461175,0.8836802817842814,0.9514911358068119,1.024191538025239,1.1084220835659888,1.1832762522239701,1.2489166126161733,1.3204822251739083,1.3924731718139927,1.4720683691803753,1.5478011910563678,1.6265457539948431,1.692831903044686,1.7737597778144756,1.849834367032321,1.971711758322104]}], {"showlegend":true,"xaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[0.75,1.0,1.25,1.5,1.75],"visible":true,"ticks":"inside","range":[0.5146487285296822,1.990468148012045],"domain":[0.05100612423447069,0.9934383202099737],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["0.75","1.00","1.25","1.50","1.75"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[1.0,1.5,2.0,2.5,3.0,3.5],"visible":true,"ticks":"inside","range":[0.5290613138862358,3.9360523642321454],"domain":[0.03762029746281716,0.9901574803149606],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["1.0","1.5","2.0","2.5","3.0","3.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<hr /><div class="alert alert-danger" role="alert">
<span class="glyphicon glyphicon-th" aria-hidden="true"></span>
<span class="text-uppercase">example:</span><div class="markdown"><p>AP Calculus question</p>
</div>
</div>
<p>The 2014 AP Calculus exam included this question:</p><p>Grass clippings are placed in a bin, where they decompose. For $0 \leq t \leq 30$, the amount of grass clippings remaining in the bin is modeled by $A(t) = 6.687(0.931)^t$. Where $A(t)$ is measured in pounds and $t$ is measured in days.</p><ul>
<li><p>Find the average rate of change of $A(t)$ over the interval of $0 \leq t \leq 30$. Indicate units of measure.</p>
</li>
<li><p>Find the value of $A'(15)$. Using correct units, interpret the meaning of the value in the context of the problem.</p>
</li>
<li><p>Find the time $t$ for which the amount of grass clippings in the bin is equal to the average amount of grass clippings in the bin over the interval $0 \leq t \leq 30$.</p>
</li>
<li><p>For $t > 30$, $L(t)$, the linear approximation to $A$ at $t=30$ is a better model for the amount of grass clippings remaining in the bin. Use $L(t)$ to predict the time at which there will be 0.5% pound of grass clippings remaining in the bin. Show the work that leads to your answer.</p>
</li>
</ul><p>We can do all this relatively quickly with <code>D</code> and the <code>fzero</code> function from the <code>Roots</code> package.</p><p>First, we define $A(t)$:</p><pre class="sourceCode julia">A(t) = 6.687 * (0.931)^t</pre>
<pre class="output">
A (generic function with 1 method)</pre>

<p>The first question is answered by the slope of the secant line connecting $(0,A(0))$ and $(30, A(30))$:</p><pre class="sourceCode julia">m = (A(30) - A(0)) / (30 - 0)</pre>
<div class="well well-sm">
-0.1968024043540685</div>

<p>The units are in pounds per day.</p><p>The second question is done with <code>D</code> as follows:</p><pre class="sourceCode julia">A'(15)</pre>
<div class="well well-sm">
-0.1635905803884566</div>

<p>This also has units in pounds per day. This is the instantaneous rate of decomposition, and is less (in absolute value) than the average decay rate.</p><p>The mean value theorem tells us that there is at least one time where the instantaneous decomposition rate equals the average rate over the interval $[0,30]$. Thus the endpoints form a bracketing interval for the equation $A'(t) = m$, which we solve with:</p><pre class="sourceCode julia">fzero(t -> A'(t) - m, [0, 30])</pre>
<div class="well well-sm">
12.414773526372592</div>

<p>So at 12.4 days, the instantaneous rate is equal to the average rate of decomposition over the first 30 days.</p><p>But this doesn't really answer the question asked, which is about the average amount of grass clippings in the bin. For this we need the integral form of the mean value theorem. Skipping ahead a few lessons to solve this problem, we have:</p><pre class="sourceCode julia">a, err = quadgk(A, 0, 30)	# area under A from 0,30
avg = a/(30-0)
fzero(t -> A(t) - avg, [0, 30])</pre>
<div class="well well-sm">
12.414773526372596</div>

<p>We get the same answer – think about whether that is a coincidence.</p><p>Finally, we can define $L(t)$ using the point-slope form of the line. The point is $(30, A(30))$ and the slope is $A'(30)$:</p><pre class="sourceCode julia">L(t) = A(30) + A'(30) * (t - 30) # t > 30</pre>
<pre class="output">
L (generic function with 1 method)</pre>

<p>We could restrict $L$ to insist that $t > 30$, but this isn't necessary. We are asked to solve this. Using <code>fzero</code> requires a bracket. We check that $L(30) > 0.5$ and that $L(100)$ is negative:</p><pre class="sourceCode julia">L(30), L(100)</pre>
<pre class="output">
(0.7829278693779448, -3.135406990501517)</pre>

<p>So, we can use $[30, 100]$ as a bracket for $L(t) - 0.5 = 0$:</p><pre class="sourceCode julia">fzero(t -> L(t) - 0.5, [30, 100])</pre>
<div class="well well-sm">
35.05443040594682</div>

<p>So a bit over 35 days to decompose to half a pound.</p><p>Here is a picture, showing the decay:</p><pre class="sourceCode julia">f(t) = t <= 30 ? A(t) : L(t)
plot(f, 0, 40)</pre>
    <div id="0c4d2167-6d21-4775-a531-ea2b3ae305d2" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('0c4d2167-6d21-4775-a531-ea2b3ae305d2');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[6.594269424188003,6.502824770267799,5.715125021504521,5.022840867674486,4.64782631583036,4.300811041247822,4.027706718451079,3.7719446993303034,3.2708722747914734,2.8681090811833414,2.4912242456107436,2.1160527935431244,1.8303371731626306,1.6117208059902908,1.4030139214628012,1.2203269370535452,1.045901697463877,0.9031419527436327,0.7752928405032335,0.6747264025848664,0.5519461806144851,0.43652915061038794,0.251622118289348],"type":"scatter","name":"y1","yaxis":"y","x":[0.19531638039576263,0.39063276079152526,2.196614723763219,4.002596686734913,5.087916569479934,6.173236452224955,7.090860600427792,8.008484748630629,10.002078801322057,11.839996181385127,13.810437856259593,16.09338777354129,18.12220424444086,19.9012934616088,21.84097826621278,23.792191150112483,25.94950650497617,28.00213762979374,30.136397740454022,31.932990146673806,34.12642583945456,36.18832008514834,39.491634560642396]}], {"showlegend":true,"xaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[5.0,10.0,15.0,20.0,25.0,30.0,35.0],"visible":true,"ticks":"inside","range":[0.19531638039576263,39.491634560642396],"domain":[0.02137649460484106,0.9934383202099737],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["5","10","15","20","25","30","35"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[1.0,2.0,3.0,4.0,5.0,6.0],"visible":true,"ticks":"inside","range":[0.251622118289348,6.594269424188003],"domain":[0.03762029746281716,0.9901574803149606],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["1","2","3","4","5","6"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<h3>Practice</h3><h4>question</h4><p>Which definition would be right for  $(x,dx) - (y, dy)$?</p><form name="WeaveQuestion" data-id="wylMSzAK" data-controltype="radio">
<div class="form-group ">
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_wylMSzAK" value="1"><div class="markdown"><p><code>&#40;x - y, dx - y&#41;</code></p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_wylMSzAK" value="2"><div class="markdown"><p><code>&#40;x-y, dx - dy&#41;</code></p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_wylMSzAK" value="3"><div class="markdown"><p><code>&#40;x - dx, y -dy&#41;</code></p>
</div>
    </label>
    </div>
    


<div id="wylMSzAK_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_wylMSzAK']").on("change", function() {
  correct = this.value == 2;

  if(correct) {
     $("#wylMSzAK_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#wylMSzAK_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>
<h4>question (Find tangent line intersection)</h4><p>Redefine <code>intersection_point</code> as:</p><pre class="sourceCode julia">intersection_point(f, c) = c - f(c)/f'(c)</pre>
<pre class="output">
intersection_point (generic function with 2 methods)</pre>

<p>Now for $f(x) = 10/(1+x^2) - 10 \cdot \exp(-(1/2) \cdot x^2)$ and $c=1$ find the intersection point.</p><form name='WeaveQuestion' data-id='5NgfXQvt' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>



<div class="input-group">
<input id="5NgfXQvt" type="number" class="form-control">

</div>
  
<div id='5NgfXQvt_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#5NgfXQvt').on('change', function() {
  correct = Math.abs(this.value - 2) <= 0.0001;

  if(correct) {
     $('#5NgfXQvt_message').html('<div class="alert alert-success"><span class="glyphicon glyphicon-thumbs-up">&nbsp;Correct</span></div>');
  } else {
     $('#5NgfXQvt_message').html('<div class="alert alert-danger"><span class="glyphicon glyphicon-thumbs-down">&nbsp;Incorrect</span></div>');
  }
});
</script>
<h4>question (What is the size of the error?)</h4><p>We can compare the error at many different points with the following construct</p><pre class="sourceCode julia">f(x) = exp(-x)*sin(x)
fp(x) = exp(-x)*(cos(x) - sin(x))
[abs(f'(x) - fp(x) ) for x in linspace(0, pi, 25)]</pre>
<p>What is the order (exponent) of the largest difference above?</p><form name="WeaveQuestion" data-id="sM0msu5s" data-controltype="radio">
<div class="form-group ">
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_sM0msu5s" value="1"><div class="markdown"><p><code>1e-14</code></p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_sM0msu5s" value="2"><div class="markdown"><p><code>1e-10</code></p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_sM0msu5s" value="3"><div class="markdown"><p><code>1e-17</code></p>
</div>
    </label>
    </div>
    


<div id="sM0msu5s_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_sM0msu5s']").on("change", function() {
  correct = this.value == 3;

  if(correct) {
     $("#sM0msu5s_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#sM0msu5s_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>
<h2>Error analysis</h2><p>We end with a digression on how big <code>h</code> should be to have the approximate derivatives as close as can be.</p><p>The choice of $h$ in the derivative approximations above was done somewhat arbitrarily, with only the intuition that smaller $h$'s should produce more accurate approximations (which of course may be way off, as we are subtracting like-sized values in the derivative formula). Here we look a bit more closely at how to choose $h$.</p><p>As mentioned, with a bit of work from the second semester of calculus one can learn that the <em>mathematical error</em> in the forward difference is "order $h$" whereas the mathematical error in the central difference is "order $h^2$. This means that as $h$ gets small the approximation error in the first is a multple of $h$, but for the second a multiple of $h^2$ – a much smaller error in general.</p><p>However there is also error due to <em>floating point approximation</em>. Such error is different in that it gets bigger as $h$ gets smaller. So one error gets bigger, the other gets smaller. So clearly if $h$ gets too small, the floating point error will dominate and the overall error will not get smaller, rather larger.</p><p>So, how big is the floating point error? For any given number, it can be roughly as big as the the machine precision amount, $\epsilon$. So in the forward-difference approximation we could have errors in both terms $f(x+h)$ and $f(x)$ so the total error could be as big as $2\epsilon$. But this is divided by $h$ as we have:</p>$$~
\frac{f(x+h) - f(x)}{h} = \frac{float(x +h) + \epsilon - float(x) + \epsilon}{h} = 
	     \frac{float(x+h)-float(x)}{h} + \frac{2\epsilon}{h}.
~$$
<p>The errors may or <em>may not</em> cancel so the algebra with $\epsilon$ is unusual to the untrained eye. It basically takes into account the worse case.</p><p>The key is the $2\epsilon/h$ term – it gets bigger as $h$ gets smaller.</p><p>So if each floating point approximation is no more off than $\epsilon$, we have this bound on the error:</p>$$~
\text{error} \leq \frac{2\epsilon}{h} + (M/2)h
~$$
<p>Where $M$ is a constant that depends on the maximum absolute value of the second derivative and the $1/2$ comes from second semester calculus. Choosing $h$ to make this as small as possible is possible with some calculus involving the derivative, but for now we simply note the answer is $h=((2\epsilon)/(M/2))^{1/2}$.</p><p>Taking $\epsilon$ as machine tolerance and (conveniently) $M=1$ we get</p>$$~
h_{min} = \sqrt((2\epsilon)/(1/2)) \approx 10^{-8}
~$$
<p>Or more precisely:</p><pre class="sourceCode julia">sqrt( (2*eps())/(1/2) )</pre>
<div class="well well-sm">
2.9802322387695312e-8</div>

<p>We can check this is about right,but graphing on a different scale:</p><pre class="sourceCode julia">f(h; M=1) = 2*eps()/h + (M/2)*h
g(x) = log10(f(10.0^(-x)))
plot(g, 1, 10)			# min near 8, which means h like 1e-8</pre>
    <div id="818d5f05-4b2a-48b3-b0b1-fcf69bc7b3ea" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('818d5f05-4b2a-48b3-b0b1-fcf69bc7b3ea');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[-1.3889223668420165,-2.2016142501768963,-2.690008197391463,-3.1029390639509544,-3.5514977247390256,-3.9650291282667753,-4.408378450083894,-4.922041571255605,-5.3785204391140535,-5.778786202889682,-6.214990332056534,-6.652315101193971,-6.891011842748065,-7.121699024245689,-7.320459886792152,-7.469772276000841,-7.513127187900298,-7.525496556063121,-7.505130917667785,-7.454862318160695,-7.319782117416687,-7.147226789523509,-6.671939495894703,-6.20990400554338,-5.466903722450337],"type":"scatter","name":"y1","yaxis":"y","x":[1.0878923711780932,1.9005842545153553,2.388978201750615,2.8019090684418915,3.250467730297463,3.6639991408116535,4.107348517658409,4.621012249046791,5.0774959549991925,5.47779102886198,5.914220109897875,6.353243008775309,6.595940986197474,6.838638963619638,7.069559965161615,7.300480966703591,7.420533097928232,7.540585229152873,7.660637360377514,7.780689491602155,7.98280613730188,8.184922783001605,8.678445813877277,9.142372019158376,9.885617776144539]}], {"showlegend":true,"xaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[2.0,4.0,6.0,8.0],"visible":true,"ticks":"inside","range":[1.0878923711780932,9.885617776144539],"domain":[0.03619130941965587,0.9934383202099738],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["2","4","6","8"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"showticklabels":true,"gridwidth":0.5,"tickvals":[-7.0,-6.0,-5.0,-4.0,-3.0,-2.0],"visible":true,"ticks":"inside","range":[-7.525496556063121,-1.3889223668420165],"domain":[0.03762029746281716,0.9901574803149606],"tickmode":"array","linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","mirror":false,"tickangle":0,"showline":true,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgb(0, 0, 0)","ticktext":["-7","-6","-5","-4","-3","-2"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"zerolinecolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>Numerically, we can check how this basically works for some test function:</p><pre class="sourceCode julia">f(x) = exp(x) - x^3
fp(x) = exp(x) - 3x^2
[hs [Df(f,h=h)(.5) - fp(.5) for h in hs] ]</pre>
<pre class="output">
16×2 Array{Float64,2}:
 0.1      -0.074746   
 0.01     -0.00682885 
 0.001    -0.000676365
 0.0001   -6.75712e-5 
 1.0e-5   -6.75649e-6 
 1.0e-6   -6.75645e-7 
 1.0e-7   -6.87972e-8 
 1.0e-8    4.47752e-9 
 1.0e-9   -1.73158e-7 
 1.0e-10  -1.73158e-7 
 1.0e-11   4.26773e-6 
 1.0e-12  -0.000106755
 1.0e-13  -0.00166107 
 1.0e-14  -0.0105429  
 1.0e-15  -0.0105429  
 1.0e-16  -0.898721   </pre>

<p>We see the best case is around $h=10^{-8}$, as expected by the theory.</p><h3>Approximation errors for the central difference</h3><p>For the central difference, the errors are different. The error in $h$ becomes:</p>$$~
\text{error} \leq (2\epsilon)/(2h) + (M/6) h^2
~$$
<p>This gives $(3\epsilon/M)^{1/3}$ as the choice for $h$ that minimizes the right-hand expression.</p><p>Taking $\epsilon$ as the machine tolerance and (conveniently) $M=3$ we get</p>$$~
h_{min} \approx 10^{-6}
~$$
<p>We can again check how this works for our function and point:</p><pre class="sourceCode julia">[hs [ Dc(f,h=h)(.5) - fp(.5) for h in hs] ]</pre>
<pre class="output">
16×2 Array{Float64,2}:
 0.1      -0.00725076 
 0.01     -7.25212e-5 
 0.001    -7.25213e-7 
 0.0001   -7.25198e-9 
 1.0e-5   -8.54954e-11
 1.0e-6    3.6629e-11 
 1.0e-7   -1.07359e-9 
 1.0e-8    4.47752e-9 
 1.0e-9   -6.21359e-8 
 1.0e-10  -1.73158e-7 
 1.0e-11   4.26773e-6 
 1.0e-12  -0.000106755
 1.0e-13  -0.00166107 
 1.0e-14  -0.0105429  
 1.0e-15   0.100479   
 1.0e-16   0.211502   </pre>

<h3>Practice</h3><h4>question (Best depends on the function and value)</h4><p>A subtle point above is that we are minimizing an upper bound in $h$ with an assumption, not the actual error. The actual answer may differ as it depends on a function and the point of evaluation. Look at the function $f(x) = x^2 - 2x$ and compare the values at $0.5$ as above:</p><pre class="sourceCode julia">hs = [(1/10)^i for i in 1:16]
f(x) = x^2 - 2x
fp(x) = 2x - 2
[hs [Dc(f,h=h)(.5) - fp(.5) for h in hs] ]</pre>
<pre class="output">
16×2 Array{Float64,2}:
 0.1       2.22045e-16
 0.01     -6.66134e-16
 0.001    -6.66134e-16
 0.0001    1.10356e-13
 1.0e-5   -9.99867e-13
 1.0e-6   -2.87552e-11
 1.0e-7   -2.87552e-11
 1.0e-8   -5.02476e-9 
 1.0e-9   -2.72292e-8 
 1.0e-10  -8.27404e-8 
 1.0e-11  -8.27404e-8 
 1.0e-12   2.21217e-5 
 1.0e-13   0.000244166
 1.0e-14   0.000799278
 1.0e-15   0.000799278
 1.0e-16  -0.110223   </pre>

<p>What is the best value of $h$?</p><p>For which of these values of $h$ is the error smallest?</p><form name="WeaveQuestion" data-id="BHhXoxgW" data-controltype="radio">
<div class="form-group ">
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_BHhXoxgW" value="1"><div class="markdown"><p><code>1e-3</code></p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_BHhXoxgW" value="2"><div class="markdown"><p><code>1e-12</code></p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_BHhXoxgW" value="3"><div class="markdown"><p><code>1e-8</code></p>
</div>
    </label>
    </div>
    
    <div  class="radio"> 
    <label>
      <input type="radio" name="radio_BHhXoxgW" value="4"><div class="markdown"><p><code>1e-6</code></p>
</div>
    </label>
    </div>
    


<div id="BHhXoxgW_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_BHhXoxgW']").on("change", function() {
  correct = this.value == 1;

  if(correct) {
     $("#BHhXoxgW_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#BHhXoxgW_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>
<h4>question (Error analysis)</h4><p>Consider these commands:</p><pre class="sourceCode julia">f(x) = sin(x)
fp(x) = cos(x)
[hs [ Dc(f,h=h)(.5) - fp(.5) for h in hs] ]</pre>
<p>Do they show the smallest error around $10^{-6}$ as expected?</p><form name="WeaveQuestion" data-id="DnEDnUQG" data-controltype="radio">
<div class="form-group ">
    
    <div  class="radio inline"> 
    <label>
      <input type="radio" name="radio_DnEDnUQG" value="1"><div class="markdown"><p>true</p>
</div>
    </label>
    </div>
    
    <div  class="radio inline"> 
    <label>
      <input type="radio" name="radio_DnEDnUQG" value="2"><div class="markdown"><p>false</p>
</div>
    </label>
    </div>
    


<div id="DnEDnUQG_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_DnEDnUQG']").on("change", function() {
  correct = this.value == 1;

  if(correct) {
     $("#DnEDnUQG_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#DnEDnUQG_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>

  </div>
</div>  

</body>
</html>
