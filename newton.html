<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MTH229 with Julia - 7&nbsp; Newton’s method using julia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./first-second-derivatives.html" rel="next">
<link href="./derivatives.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./calculator.html">MTH229 notes</a></li><li class="breadcrumb-item"><a href="./newton.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Newton’s method using julia</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MTH229 with Julia</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/MTH229/mth229.github.io/tree/master/quarto/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">MTH229 notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calculator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Julia as a calculator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Functions in Julia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Graphing functions with Julia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./zeros.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Solving for zeros with julia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./limits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Investigating limits with Julia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./derivatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Approximate derivatives in Julia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./newton.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Newton’s method using julia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./first-second-derivatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exploring first and second derivatives with Julia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./extrema.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Maximization and minimization with Julia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./integration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Numeric integration with Julia</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">MTH232 and 233</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./symbolic-math.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Using symbolic math within Julia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mth232.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Notes on MTH 232 and Julia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mth233.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Notes on MTH 233 and Julia</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">7.1</span> Introduction</a></li>
  <li><a href="#basic-idea" id="toc-basic-idea" class="nav-link" data-scroll-target="#basic-idea"><span class="header-section-number">7.2</span> Basic idea</a>
  <ul class="collapse">
  <li><a href="#repeating-steps" id="toc-repeating-steps" class="nav-link" data-scroll-target="#repeating-steps"><span class="header-section-number">7.2.1</span> Repeating steps</a></li>
  <li><a href="#practice" id="toc-practice" class="nav-link" data-scroll-target="#practice"><span class="header-section-number">7.2.2</span> Practice</a></li>
  </ul></li>
  <li><a href="#implementing-a-newtons-method-function" id="toc-implementing-a-newtons-method-function" class="nav-link" data-scroll-target="#implementing-a-newtons-method-function"><span class="header-section-number">7.3</span> Implementing a Newton’s method function</a>
  <ul class="collapse">
  <li><a href="#practice-1" id="toc-practice-1" class="nav-link" data-scroll-target="#practice-1"><span class="header-section-number">7.3.1</span> Practice</a></li>
  </ul></li>
  <li><a href="#numeric-derivatives" id="toc-numeric-derivatives" class="nav-link" data-scroll-target="#numeric-derivatives"><span class="header-section-number">7.4</span> Numeric derivatives</a>
  <ul class="collapse">
  <li><a href="#the-secant-method" id="toc-the-secant-method" class="nav-link" data-scroll-target="#the-secant-method"><span class="header-section-number">7.4.1</span> The secant method</a></li>
  <li><a href="#using-forward-differences" id="toc-using-forward-differences" class="nav-link" data-scroll-target="#using-forward-differences"><span class="header-section-number">7.4.2</span> Using forward differences</a></li>
  <li><a href="#problems" id="toc-problems" class="nav-link" data-scroll-target="#problems"><span class="header-section-number">7.4.3</span> Problems</a></li>
  </ul></li>
  <li><a href="#the-find_zero-function" id="toc-the-find_zero-function" class="nav-link" data-scroll-target="#the-find_zero-function"><span class="header-section-number">7.5</span> The <code>find_zero</code> function</a>
  <ul class="collapse">
  <li><a href="#using-find_zero-and-a-graph-to-find-all-roots." id="toc-using-find_zero-and-a-graph-to-find-all-roots." class="nav-link" data-scroll-target="#using-find_zero-and-a-graph-to-find-all-roots."><span class="header-section-number">7.5.1</span> Using <code>find_zero</code> and a graph to find all roots.</a></li>
  <li><a href="#practice-2" id="toc-practice-2" class="nav-link" data-scroll-target="#practice-2"><span class="header-section-number">7.5.2</span> Practice</a></li>
  </ul></li>
  <li><a href="#various-issues-with-newtons-method" id="toc-various-issues-with-newtons-method" class="nav-link" data-scroll-target="#various-issues-with-newtons-method"><span class="header-section-number">7.6</span> Various issues with Newton’s method</a>
  <ul class="collapse">
  <li><a href="#the-initial-guess-is-no-where-near-the-end-results" id="toc-the-initial-guess-is-no-where-near-the-end-results" class="nav-link" data-scroll-target="#the-initial-guess-is-no-where-near-the-end-results"><span class="header-section-number">7.6.1</span> The initial guess is no where near the end results</a></li>
  <li><a href="#function-has-a-poor-shape" id="toc-function-has-a-poor-shape" class="nav-link" data-scroll-target="#function-has-a-poor-shape"><span class="header-section-number">7.6.2</span> Function has a poor shape</a></li>
  <li><a href="#cycles" id="toc-cycles" class="nav-link" data-scroll-target="#cycles"><span class="header-section-number">7.6.3</span> Cycles</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/MTH229/mth229.github.io/edit/master/quarto/newton.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/MTH229/mth229.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./calculator.html">MTH229 notes</a></li><li class="breadcrumb-item"><a href="./newton.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Newton’s method using julia</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Newton’s method using julia</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><br> A notebook for this material: <a href="https://raw.githubusercontent.com/mth229/229-projects/master/07-newton.ipynb">ipynb</a></p>
<section id="introduction" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">7.1</span> Introduction</h2>
<p>Newton’s method is an old method for <em>approximating</em> a zero of a function, <span class="math inline">\(f(x)\)</span>:</p>
<p><span class="math display">\[
f(x) = 0
\]</span></p>
<p>Previously we discussed the <em>bisection method</em> which applied for some continuous function <span class="math inline">\(f(x)\)</span> which changed signs <em>between</em> <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, points which bracket a zero. Not only did we need to find these bracketing points – which wasn’t hard from a graph, more importantly the actual algorithm is pretty slow.</p>
<p>If the function <span class="math inline">\(f\)</span> is sufficiently differentiable, then Newton’s method may work to find a zero. Unlike the bisection method which is slow but guaranteed to find a root by the intermediate value theorem, Newton’s method is fast (once it is close) but has no such guarantee of converging.</p>
<p>Newton’s method is useful to rapidly find a zero when there is a <em>nearby</em> initial guess (and a good function); the bisection method is useful when there is a zero <em>between</em> two values, which need not be nearby.</p>
<p>In this section, we’ll see how to implement the algorithm, try some examples, and then look at what can go wrong.</p>
<p>The <code>MTH229</code> package provides a function <code>newton</code> for easily performing Newton’s method, utilizing a function from the <code>Roots</code> package. More usefully, we will see that <code>find_zero</code>, which we used for bisection, can also be used for root finding with an algorithm that is a bit more robust than Newton’s method.</p>
<p>To begin, we load <code>MTH229</code> (and <code>Plots</code>); in the background loading <code>MTH229</code> loads <code>Roots</code> and its functions.</p>
<div id="04aa813c" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MTH229</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotly</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>Plots.PlotlyBackend()</code></pre>
</div>
</div>
</section>
<section id="basic-idea" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="basic-idea"><span class="header-section-number">7.2</span> Basic idea</h2>
<p>The idea behind Newton’s method is simple – <em>linear approximation</em>.</p>
<p>That is, most functions at any given point are well approximated by the tangent line at that point. If we have a good, <em>nearby</em>, guess <span class="math inline">\(x_n\)</span>, then we can improve this guess by replacing it with the easy to find zero, <span class="math inline">\(x_{n+1}\)</span>, of the tangent line at <span class="math inline">\((x_n, f(x_n))\)</span>.</p>
<div id="9483ee52" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display" data-execution_count="5">
    <div id="bf9686c7-0fcd-45f7-bfd7-6a8946cf1bc3" style="width:672px;height:480px;"></div>
    <script>
        requirejs.config({
        paths: {
            plotly: 'https://cdn.plot.ly/plotly-2.6.3.min'
        }
    });
    require(['plotly'], function (Plotly) {

    Plotly.newPlot('bf9686c7-0fcd-45f7-bfd7-6a8946cf1bc3', [
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5,
            "title": "",
            "len": 0.9835958005249343,
            "x": 0.9941413573303337
        },
        "name": "y1",
        "yaxis": "y",
        "legendgroup": "y1",
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 2
        },
        "y": [
            -0.6931471805599453,
            -0.6882761537868388,
            -0.6834287389476544,
            -0.6786047082321135,
            -0.6738038371110189,
            -0.6304717810368144,
            -0.5889396667840483,
            -0.549063905768703,
            -0.5107174343380565,
            -0.4664931354664584,
            -0.42414207490031447,
            -0.3896830303255992,
            -0.35637196310525276,
            -0.32140151053955035,
            -0.28761278147505415,
            -0.2574426769035132,
            -0.22815621306913283,
            -0.19768242255858853,
            -0.1681098869822993,
            -0.13490625689168112,
            -0.10276976971953711,
            -0.04808255316858595,
            -0.0024707131593766063,
            0.04499674649302926,
            0.09057606312993192,
            0.138663654803671,
            0.18236608975638363,
            0.22586779200766313,
            0.2610747824172439,
            0.3024430753158608,
            0.3388934406011746,
            0.3714173248714298,
            0.4033187087502738,
            0.4379019999552246,
            0.4682394812731061,
            0.5018799766671163,
            0.5320502561328544,
            0.560929352677542,
            0.5881925205415546,
            0.6153899867894131,
            0.6443626131002107,
            0.6850088908826686,
            0.6931471805599453
        ],
        "type": "scatter",
        "x": [
            0.5,
            0.5024414547549471,
            0.5048829095098941,
            0.5073243642648411,
            0.5097658190197881,
            0.5323405935569343,
            0.5549153680940805,
            0.5774901426312267,
            0.6000649171683728,
            0.6271979142369983,
            0.6543309113056239,
            0.6772715150106948,
            0.7002121187157657,
            0.7251320443744086,
            0.7500519700330515,
            0.7730259372838398,
            0.7959999045346282,
            0.820630425470559,
            0.8452609464064899,
            0.8737978203725111,
            0.9023346943385323,
            0.9530551061110214,
            0.99753233654022,
            1.0460244566553194,
            1.0948047787528121,
            1.1487376626244041,
            1.2000534407448433,
            1.2534099435113506,
            1.2983247536668452,
            1.353160645986364,
            1.4033937924459028,
            1.4497879797388775,
            1.496783853765011,
            1.549453053510164,
            1.5971798515547837,
            1.6518237435941894,
            1.7024191282188168,
            1.7523002487307766,
            1.8007306884179617,
            1.850378081872247,
            1.90477256519116,
            1.9837894730981975,
            2.0
        ]
    },
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5,
            "title": "",
            "len": 0.9835958005249343,
            "x": 0.9941413573303337
        },
        "name": "y2",
        "yaxis": "y",
        "legendgroup": "y2",
        "line": {
            "color": "rgba(227, 111, 71, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
        ],
        "type": "scatter",
        "x": [
            0.5,
            0.5097658190197881,
            0.6000649171683728,
            0.6543309113056239,
            0.7002121187157657,
            0.7500519700330515,
            0.7959999045346282,
            0.8452609464064899,
            0.9023346943385323,
            0.9530551061110214,
            0.99753233654022,
            1.0460244566553194,
            1.0948047787528121,
            1.1487376626244041,
            1.2000534407448433,
            1.2534099435113506,
            1.2983247536668452,
            1.353160645986364,
            1.4033937924459028,
            1.4497879797388775,
            1.496783853765011,
            1.549453053510164,
            1.5971798515547837,
            1.6518237435941894,
            1.7024191282188168,
            1.7523002487307766,
            1.8007306884179617,
            1.850378081872247,
            1.90477256519116,
            1.9837894730981975,
            2.0
        ]
    },
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5,
            "title": "",
            "len": 0.9835958005249343,
            "x": 0.9941413573303337
        },
        "name": "y3",
        "yaxis": "y",
        "legendgroup": "y3",
        "line": {
            "color": "rgba(62, 164, 78, 1.000)",
            "shape": "linear",
            "dash": "dash",
            "width": 1
        },
        "y": [
            0.0,
            -0.5108256237659907,
            0.0
        ],
        "type": "scatter",
        "x": [
            0.6,
            0.6,
            0.9064953742595945
        ]
    },
    {
        "showlegend": true,
        "mode": "markers",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5,
            "title": "",
            "len": 0.9835958005249343,
            "x": 0.9941413573303337
        },
        "name": "y4",
        "yaxis": "y",
        "legendgroup": "y4",
        "marker": {
            "symbol": "circle",
            "color": "rgba(195, 113, 210, 1.000)",
            "line": {
                "color": "rgba(0, 0, 0, 1.000)",
                "width": 1
            },
            "size": 8
        },
        "y": [
            -0.5108256237659907
        ],
        "type": "scatter",
        "x": [
            0.6
        ]
    }
]
, {
    "showlegend": false,
    "xaxis": {
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "showticklabels": false,
        "gridwidth": 0.5,
        "visible": true,
        "ticks": "inside",
        "range": [
            0.45499999999999996,
            2.045
        ],
        "domain": [
            0.005858642669666292,
            0.9941413573303337
        ],
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": false,
        "zeroline": false,
        "type": "-",
        "title": "",
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "mirror": false,
        "anchor": "y"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [
        {
            "yanchor": "bottom",
            "xanchor": "center",
            "rotation": -0.0,
            "y": 0,
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 20
            },
            "yref": "y",
            "showarrow": false,
            "text": "xᵢ",
            "xref": "x",
            "x": 0.6
        },
        {
            "yanchor": "bottom",
            "xanchor": "center",
            "rotation": -0.0,
            "y": 0,
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 20
            },
            "yref": "y",
            "showarrow": false,
            "text": "xᵢ₊₁",
            "xref": "x",
            "x": 0.9064953742595945
        },
        {
            "yanchor": "middle",
            "xanchor": "left",
            "rotation": -0.0,
            "y": -0.5108256237659907,
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 20
            },
            "yref": "y",
            "showarrow": false,
            "text": "(xᵢ, f(xᵢ))",
            "xref": "x",
            "x": 0.6
        },
        {
            "yanchor": "top",
            "xanchor": "center",
            "rotation": -0.0,
            "y": 0,
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 20
            },
            "yref": "y",
            "showarrow": false,
            "text": "xᵅ",
            "xref": "x",
            "x": 1
        }
    ],
    "height": 480,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "showticklabels": false,
        "gridwidth": 0.5,
        "visible": true,
        "ticks": "inside",
        "range": [
            -0.734736011393542,
            0.734736011393542
        ],
        "domain": [
            0.008202099737532808,
            0.9917979002624672
        ],
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": false,
        "zeroline": false,
        "type": "-",
        "title": "",
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "mirror": false,
        "anchor": "x"
    },
    "width": 672
}
);
    });
    </script>
<p>One step of Newton’s method illustrating how each step of the algorithm improves the previous one.</p>
</div>
</div>
<p>A simple picture shows that we have a triangle with base <span class="math inline">\(x_{n+1} - x_{n}\)</span>, rise <span class="math inline">\(0 - f(x_n)\)</span> and slope <span class="math inline">\(f'(x_n)\)</span>, using the “rise over run” formula:</p>
<p><span class="math display">\[
f'(x_n) = \frac{-f(x_n)}{x_{n+1} - x_{n}}.
\]</span></p>
<p>The basic algorithm of Newton’s methods solves this to get:</p>
<p><span class="math display">\[
x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}.
\]</span></p>
<p>Some books write the right-hand side as <span class="math inline">\(x_n - f'(x_n)^{-1} f(x_n)\)</span>, a form that generalizes to different settings.</p>
<p>Like the bisection method, Newton’s method is an <em>iterative method</em>. One begins with a (suitable, usually nearby) guess <span class="math inline">\(x_1\)</span>. From that the algorithm produces <span class="math inline">\(x_2\)</span> which is used to produce <span class="math inline">\(x_3\)</span>, etc. The idea is that the algorithm eventually will settle on a value <span class="math inline">\(x_n\)</span> sufficiently close to the desired root. We then call <span class="math inline">\(x_n\)</span> an <em>approximate</em> zero.</p>
<p>Mathematically, the indices indicate that the right hand side is computed and assigned to the left hand side. This is exactly what is done in assignment within <code>Julia</code>, so the above simply becomes:</p>
<div id="d24b6c34" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span>f<span class="op">'</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Where <code>f(x)</code> is the function and <code>f'(x)</code> its derivative. (In this case found by automatic differentiation.) This line starts with a previously defined value of <code>x</code> and updates it accordingly.</p>
<p>The updating is continued – by executing the exact same command – until either the algorithm has gotten close enough to an answer (i.e., it has converged) or we have given up on it converging.</p>
<p>Here is an example to find a zero of the function: <span class="math inline">\(f(x) = x^3 - 2x - 5\)</span>.</p>
<p>A quick graph shows a root near 2:</p>
<div id="e6528aac" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">2</span>x <span class="op">-</span> <span class="fl">5</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
    <div id="f5a26424-a241-4ceb-9e21-ff757abd73eb" style="width:672px;height:480px;"></div>
    <script>
        requirejs.config({
        paths: {
            plotly: 'https://cdn.plot.ly/plotly-2.6.3.min'
        }
    });
    require(['plotly'], function (Plotly) {

    Plotly.newPlot('f5a26424-a241-4ceb-9e21-ff757abd73eb', [
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303336
        },
        "name": "y1",
        "yaxis": "y",
        "legendgroup": "y1",
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -26.0,
            -25.756711934117355,
            -25.515134961946487,
            -25.2752634952189,
            -25.03709194566606,
            -23.95790834994008,
            -22.91438742842401,
            -21.90597696191842,
            -20.93212473122388,
            -19.99227851714099,
            -19.08588610047034,
            -18.212395262012507,
            -17.371253782568065,
            -16.402298550070654,
            -15.478318765824717,
            -14.598355615445232,
            -13.761450284547223,
            -13.086740302106548,
            -12.441545236854449,
            -11.825285585688665,
            -11.237381845506944,
            -10.630209344692993,
            -10.055070324074475,
            -9.511221967283923,
            -8.997921457953856,
            -8.12907978690515,
            -7.3569095102504125,
            -6.631143591522574,
            -6.0054029320382085,
            -5.68641116920856,
            -5.397945581099694,
            -5.138890691202479,
            -4.9081310230077815,
            -4.564358551854942,
            -4.300184409891458,
            -4.129089490508258,
            -4.010163904956656,
            -3.9349916588356337,
            -3.911338757340884,
            -3.9339916243923763,
            -3.9976678812610347,
            -4.256355712610718,
            -4.608401901808222,
            -5.027277010500375,
            -5.379375506547733,
            -5.755022904956007,
            -5.996154941075197,
            -6.060287381962485,
            -6.087930427946917,
            -6.0738216203824145,
            -6.0123702213601575,
            -5.881081185149675,
            -5.67705844283066,
            -5.423497405970604,
            -5.099235681802174,
            -4.634447983191494,
            -4.0623087174003505,
            -3.7589025436852417,
            -3.430032238965462,
            -3.0749206906320152,
            -2.6927907860759066,
            -2.2888494095213945,
            -1.857147148742416,
            -1.3969393406069108,
            -0.9074813219828224,
            -0.4035659443413797,
            0.1293065729282299,
            0.6918177935796921,
            1.2846492813666925,
            1.9245634203830626,
            2.597791229410074,
            3.305066952788355,
            4.047124834858547,
            4.900934924640856,
            5.798343644718216,
            6.740316636359212,
            7.727819540832435,
            9.245418455489126,
            10.864093942951108,
            12.586806137025366,
            14.416515171518924,
            14.805380742963436,
            15.198899698906086,
            15.597097598275425,
            16.0
        ],
        "type": "scatter",
        "x": [
            -3.0,
            -2.9902341809802118,
            -2.9804683619604235,
            -2.9707025429406357,
            -2.9609367239208475,
            -2.915787174846555,
            -2.870637625772263,
            -2.8254880766979706,
            -2.780338527623678,
            -2.7351889785493855,
            -2.6900394294750933,
            -2.644889880400801,
            -2.5997403313265086,
            -2.5454743371892574,
            -2.4912083430520067,
            -2.4369423489147555,
            -2.3826763547775043,
            -2.3367951473673623,
            -2.2909139399572207,
            -2.245032732547079,
            -2.199151525136937,
            -2.1493116738196516,
            -2.0994718225023656,
            -2.04963197118508,
            -1.9997921198677944,
            -1.9078962508646409,
            -1.8160003818614874,
            -1.717478298117764,
            -1.6189562143740408,
            -1.5618824664419981,
            -1.5048087185099557,
            -1.4477349705779132,
            -1.3906612226458708,
            -1.2892203991008926,
            -1.1877795755559142,
            -1.098825114697517,
            -1.00987065383912,
            -0.9128864136089211,
            -0.8159021733787222,
            -0.718341529183737,
            -0.6207808849887516,
            -0.40504934950238297,
            -0.19978623702062615,
            0.013639774045402136,
            0.19329901466738048,
            0.41264258394545644,
            0.6135751697836116,
            0.7063635443695611,
            0.7991519189555105,
            0.8931436670077773,
            0.9871354150600441,
            1.0924738145503499,
            1.1978122140406555,
            1.2932658101298946,
            1.388719406219134,
            1.4980071902979462,
            1.6072949743767582,
            1.6578903590013856,
            1.708485743626013,
            1.7590811282506404,
            1.8096765128752679,
            1.8595576333872277,
            1.9094387538991873,
            1.959319874411147,
            2.009200994923107,
            2.057631434610292,
            2.106061874297477,
            2.154492313984662,
            2.202922753671847,
            2.252570147126132,
            2.3022175405804175,
            2.3518649340347024,
            2.4015123274889874,
            2.4559068108079005,
            2.5103012941268137,
            2.564695777445727,
            2.6190902607646405,
            2.6981071686716778,
            2.7771240765787155,
            2.856140984485753,
            2.93515789239279,
            2.9513684192945924,
            2.967578946196395,
            2.9837894730981978,
            3.0
        ]
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -3.0,
            -2.0,
            -1.0,
            0.0,
            1.0,
            2.0,
            3.0
        ],
        "range": [
            -3.18,
            3.18
        ],
        "domain": [
            0.04554118235220598,
            0.9941413573303336
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−3",
            "−2",
            "−1",
            "0",
            "1",
            "2",
            "3"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 480,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -20.0,
            -10.0,
            0.0,
            10.0
        ],
        "range": [
            -27.26,
            17.26
        ],
        "domain": [
            0.031350247885680964,
            0.9917979002624672
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−20",
            "−10",
            "0",
            "10"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "legend": {
        "yanchor": "auto",
        "xanchor": "auto",
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "borderwidth": 1,
        "tracegroupgap": 0,
        "y": 1.0,
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "title": {
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 15
            },
            "text": ""
        },
        "traceorder": "normal",
        "x": 1.0
    },
    "width": 672
}
);
    });
    </script>
</div>
</div>
<p>Here we improve the estimate for the root near 2 using Newton’s method. We will need the first derivative, which we denote <code>fp</code></p>
<div id="a5927056" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> <span class="fl">3</span>x<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">2</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fl">2</span>                   <span class="co"># starting value, x_1</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span><span class="fu">fp</span>(x)      <span class="co"># new value, x_2</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>x, <span class="fu">f</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>(2.1, 0.06100000000000083)</code></pre>
</div>
</div>
<p>We can visualize our progress as follows, noting that <code>x</code> holds <span class="math inline">\(x_2\)</span>, and zooming into the domain <span class="math inline">\([1.9, 2.2]\)</span>:</p>
<div id="c12405c1" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x1, x2 <span class="op">=</span> <span class="fl">2</span>, x</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="fl">1.9</span>, <span class="fl">2.2</span>, legend<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(zero)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>([x1, x1, x2], [<span class="fl">0</span>, <span class="fu">f</span>(x1), <span class="fl">0</span>])  <span class="co"># why these values?</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter!</span>([x1, x2], [<span class="fl">0</span>, <span class="fl">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
    <div id="6f495bfe-d076-4aea-a8a7-64251648353a" style="width:672px;height:480px;"></div>
    <script>
        requirejs.config({
        paths: {
            plotly: 'https://cdn.plot.ly/plotly-2.6.3.min'
        }
    });
    require(['plotly'], function (Plotly) {

    Plotly.newPlot('6f495bfe-d076-4aea-a8a7-64251648353a', [
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303337
        },
        "name": "y1",
        "yaxis": "y",
        "legendgroup": "y1",
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -1.9410000000000007,
            -1.923731811521614,
            -1.7619943795066928,
            -1.66299169288579,
            -1.578221839012353,
            -1.4850272177508064,
            -1.3980802589901224,
            -1.3037611460488026,
            -1.1930488211132122,
            -1.093361697908935,
            -1.0049338655926636,
            -0.9074419266121954,
            -0.8082265186346129,
            -0.6971888565449724,
            -0.5902239361965655,
            -0.47763794410564575,
            -0.38177865295346614,
            -0.2633929455125026,
            -0.15363289963321414,
            -0.05114185604308563,
            0.05377914187642574,
            0.17268881805907998,
            0.2816531573989005,
            0.407832838134337,
            0.5260250354204388,
            0.6438360055750767,
            0.7594493229539676,
            0.8792300143115801,
            1.0119376166440883,
            1.2074781807914778,
            1.2480000000000029
        ],
        "type": "scatter",
        "x": [
            1.9,
            1.9019531638039575,
            1.9200129834336745,
            1.9308661822611246,
            1.940042423743153,
            1.9500103940066102,
            1.9591999809069256,
            1.969052189281298,
            1.9804669388677065,
            1.9906110212222043,
            1.999506467308044,
            2.0092048913310636,
            2.0189609557505626,
            2.0297475325248806,
            2.0400106881489686,
            2.05068198870227,
            2.059664950733369,
            2.0706321291972727,
            2.0806787584891806,
            2.089957595947775,
            2.099356770753002,
            2.1098906107020325,
            2.1194359703109567,
            2.1303647487188377,
            2.1404838256437637,
            2.1504600497461555,
            2.1601461376835926,
            2.1700756163744495,
            2.180954513038232,
            2.1967578946196396,
            2.2
        ]
    },
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303337
        },
        "name": "y2",
        "yaxis": "y",
        "legendgroup": "y2",
        "line": {
            "color": "rgba(227, 111, 71, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
        ],
        "type": "scatter",
        "x": [
            1.9,
            1.9019531638039575,
            1.9200129834336745,
            1.9308661822611246,
            1.940042423743153,
            1.9500103940066102,
            1.9591999809069256,
            1.969052189281298,
            1.9804669388677065,
            1.9906110212222043,
            1.999506467308044,
            2.0092048913310636,
            2.0189609557505626,
            2.0297475325248806,
            2.0400106881489686,
            2.05068198870227,
            2.059664950733369,
            2.0706321291972727,
            2.0806787584891806,
            2.089957595947775,
            2.099356770753002,
            2.1098906107020325,
            2.1194359703109567,
            2.1303647487188377,
            2.1404838256437637,
            2.1504600497461555,
            2.1601461376835926,
            2.1700756163744495,
            2.180954513038232,
            2.1967578946196396,
            2.2
        ]
    },
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303337
        },
        "name": "y3",
        "yaxis": "y",
        "legendgroup": "y3",
        "line": {
            "color": "rgba(62, 164, 78, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            0.0,
            -1.0,
            0.0
        ],
        "type": "scatter",
        "x": [
            2.0,
            2.0,
            2.1
        ]
    },
    {
        "showlegend": true,
        "mode": "markers",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303337
        },
        "name": "y4",
        "yaxis": "y",
        "legendgroup": "y4",
        "marker": {
            "symbol": "circle",
            "color": "rgba(195, 113, 210, 1.000)",
            "line": {
                "color": "rgba(0, 0, 0, 1.000)",
                "width": 1
            },
            "size": 8
        },
        "y": [
            0.0,
            0.0
        ],
        "type": "scatter",
        "x": [
            2.0,
            2.1
        ]
    }
]
, {
    "showlegend": false,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            1.9000000000000001,
            2.0,
            2.1,
            2.2
        ],
        "range": [
            1.8909999999999996,
            2.209
        ],
        "domain": [
            0.032313669124692745,
            0.9941413573303337
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "1.9",
            "2.0",
            "2.1",
            "2.2"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 480,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -2.0,
            -1.0,
            0.0,
            1.0
        ],
        "range": [
            -2.036670000000001,
            1.343670000000003
        ],
        "domain": [
            0.031350247885680964,
            0.9917979002624672
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−2",
            "−1",
            "0",
            "1"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "width": 672
}
);
    });
    </script>
</div>
</div>
<p>Continuing, though without visualizing the progress, this next step will compute <span class="math inline">\(x_3\)</span>:</p>
<div id="c1777e1f" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span><span class="fu">fp</span>(x)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>x, <span class="fu">f</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>(2.094568121104185, 0.00018572317327247845)</code></pre>
</div>
</div>
<p>This next step will compute <span class="math inline">\(x_4\)</span>:</p>
<div id="6d0d8c58" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span><span class="fu">fp</span>(x)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>x, <span class="fu">f</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>(2.094551481698199, 1.7397612239733462e-9)</code></pre>
</div>
</div>
<p>This next step will compute <span class="math inline">\(x_5\)</span>:</p>
<div id="5e598981" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span><span class="fu">fp</span>(x)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>x, <span class="fu">f</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>(2.0945514815423265, -8.881784197001252e-16)</code></pre>
</div>
</div>
<p>This next step will compute <span class="math inline">\(x_6\)</span>:</p>
<div id="74175d0c" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span><span class="fu">fp</span>(x)      <span class="co"># x stopped changing</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>x, <span class="fu">f</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>(2.0945514815423265, -8.881784197001252e-16)</code></pre>
</div>
</div>
<p>We see that <span class="math inline">\(x_5=x_6\)</span>, so the algorithm has stabilized. We also see that <span class="math inline">\(f(x_5)\)</span> is basically <span class="math inline">\(0\)</span> (Recall, <code>eps()</code> is the machine precision, or the size of the difference between floating point values at <span class="math inline">\(1.0\)</span> is basically <span class="math inline">\(10^{-16}\)</span>, the size of <span class="math inline">\(f(x_5)\)</span>.)</p>
<p>You can see in this case that the convergence happens quickly as soon as the algorithm gets close.</p>
<p>The approximate root is <span class="math inline">\(x_5\)</span>. It is important to realize that the actual, <em>exact</em>, answer is not likely to be the value computed by Newton’s method, which we call <code>xstar</code> at times. In most cases, the true answer will be irrational and <code>xstar</code> a floating point number, which ultimately can never be better than an approximation to an irrational number.</p>
<p>The above example iterated until it was clear the algorithm does not improve itself, as the values returned did not change. This need not be the case for every problem.</p>
<p>Rather, we can determine two ways that the number is close enough to the answer:</p>
<ul>
<li>The sequence of <code>x</code>’s stop changing by much</li>
<li>the values <code>f(x)</code> get close enough to zero.</li>
</ul>
<p>In the above, the first one was used. In either case, rather than look for values to be equal (e.g.&nbsp;<span class="math inline">\(x_{n+1} = x_{n}\)</span> or <span class="math inline">\(f(x_n) = 0\)</span>, we look at whether these two things are close enough to be so. That means for some tolerance, we stop when the change in the <code>x</code>’s is smaller than the tolerance or <code>f(x)</code> is smaller – in absolute value – than the tolerance.</p>
<section id="repeating-steps" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="repeating-steps"><span class="header-section-number">7.2.1</span> Repeating steps</h3>
<p>The above approach – basically repeating steps – can be tedious. There will be a function to do this for you (<code>newton</code>). One can use copy and paste to do much of this though:</p>
<div id="c9f5d673" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">2</span>x <span class="op">-</span> <span class="fl">5</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fl">2</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span>f<span class="op">'</span>(x)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span>f<span class="op">'</span>(x)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span>f<span class="op">'</span>(x)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span>f<span class="op">'</span>(x)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span>f<span class="op">'</span>(x)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>(x, <span class="fu">f</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>(2.0945514815423265, -8.881784197001252e-16)</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Newton looked at this same example in 1699 (B.T. Polyak, <em>Newton’s method and its use in optimization</em>, European Journal of Operational Research. 02/2007; 181(3):1086-1096.) though his technique was slightly different as he did not use the derivative, <em>per se</em>, but rather an approximation based on the fact that his function was a polynomial (though identical to the derivative). Raphson (1690) proposed the general form, hence the usual name of Newton-Raphson method.</p>
</div>
</div>
<hr>
</section>
<section id="practice" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="practice"><span class="header-section-number">7.2.2</span> Practice</h3>
<section id="question" class="level4">
<h4 class="anchored" data-anchor-id="question">Question</h4>
<p>Using Newton’s method to find <span class="math inline">\(\sqrt{k}\)</span> (by solving for roots of <span class="math inline">\(f(x) = x^2 - k\)</span>) is also referred to as the Babylonian method, due to its origins. The resulting method</p>
<p><span class="math display">\[
x_{n+1} = \frac{1}{2}(x_n + \frac{k}{x_n})
\]</span></p>
<p>is described by the first-century <a href="http://en.wikipedia.org/wiki/Babylonian_method">Greek mathematician Hero of Alexandria</a>.</p>
<p>Let <span class="math inline">\(k=15\)</span> and <span class="math inline">\(x_1\)</span> be <span class="math inline">\(4\)</span>. What is the value of <span class="math inline">\(x_4\)</span>?</p>
<div id="1f6f6d0b" class="cell" data-execution_count="14">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: `x0` not defined</code></pre>
</div>
</div>
</section>
<section id="question-1" class="level4">
<h4 class="anchored" data-anchor-id="question-1">Question</h4>
<p>The function <span class="math inline">\(f(x) = \sin(x)\)</span> has derivative <span class="math inline">\(f'(x) = \cos(x)\)</span>. Use Newton’s method to solve <span class="math inline">\(f(x) = 0\)</span> starting at <span class="math inline">\(3\)</span>. Repeat 5 times. What value do you get for <code>x</code>?</p>
<div id="2be014f5" class="cell" data-execution_count="15">
<div class="cell-output cell-output-display" data-execution_count="15">
<script>
var ID = "h8vxALxO"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="h8vxALxO" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_h8vxALxO" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <br>
<div class="input-group" aria-label="Input form: Numeric answer">
    <input id="h8vxALxO" type="number" class="form-control" placeholder="Numeric answer" aria-label="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="h8vxALxO_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_h8vxALxO').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_h8vxALxO')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.getElementById("h8vxALxO").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 3.141592653589793) <= 1.0e-14);
  var msgBox = document.getElementById('h8vxALxO_message');
  
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_h8vxALxO")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_h8vxALxO")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

});

</script>
</div>
</div>
<p>(This can be used to compute <span class="math inline">\(\pi\)</span> numerically, as the convergence is very fast. Here it takes 4 steps to verify.)</p>
</section>
<section id="question-2" class="level4">
<h4 class="anchored" data-anchor-id="question-2">Question</h4>
<p>Let <span class="math inline">\(f(x) = x^2 - 3^x\)</span>. This has derivative <span class="math inline">\(2x - 3^x \cdot \log(3)\)</span>. Starting with <span class="math inline">\(x_1=0\)</span>, what does Newton’s method converge on?</p>
<div id="e6a93d71" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display" data-execution_count="16">
<script>
var ID = "IjtpsAIt"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="IjtpsAIt" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_IjtpsAIt" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <br>
<div class="input-group" aria-label="Input form: Numeric answer">
    <input id="IjtpsAIt" type="number" class="form-control" placeholder="Numeric answer" aria-label="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="IjtpsAIt_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_IjtpsAIt').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_IjtpsAIt')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.getElementById("IjtpsAIt").addEventListener("change", function() {
  var correct = (Math.abs(this.value - -0.6860267245362514) <= 1.0e-14);
  var msgBox = document.getElementById('IjtpsAIt_message');
  
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_IjtpsAIt")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_IjtpsAIt")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

});

</script>
</div>
</div>
</section>
</section>
</section>
<section id="implementing-a-newtons-method-function" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="implementing-a-newtons-method-function"><span class="header-section-number">7.3</span> Implementing a Newton’s method function</h2>
<p>For iterative algorithms it is better to repeat the expression until something happens – not a fixed number of times. In this case, we need a criteria to decide if the algorithm has converged. We shall use the following:</p>
<ul>
<li>If the value of <span class="math inline">\(|x_{n+1} - x_n| &lt; tol\)</span> the algorithm has converged</li>
<li>If the value of <span class="math inline">\(|f(x_n)| &lt; tol\)</span> the algorithm has converged</li>
<li>If the above hasn’t happened by <span class="math inline">\(n=100\)</span> the algorithm fails to converge</li>
</ul>
<p>This isn’t perfect, but will be sufficient. (Well, in fact no stopping rule can be perfect, but this one doesn’t account for the relative size of the <span class="math inline">\(x_n\)</span>s which can be important.)</p>
<p>The first two steps require a tolerance. We will use <code>1e-14</code> for this. This is about 100 times the machine precision, <code>eps()</code>, which is sufficient when the answers are moderate in size. This is not very good if the answers are very large.</p>
<p>A basic algorithm is to repeat a step of Newton’s method until the above occurs. We wrap this up in a function for reuse, and employ a <code>while</code> loop to repeat the update step until something happens:</p>
<div id="e40eaed8" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">nm</span>(f, fp, x)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>     xnew, xold <span class="op">=</span> x, <span class="cn">Inf</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>     fn, fo <span class="op">=</span> <span class="fu">f</span>(xnew), <span class="cn">Inf</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>     tol <span class="op">=</span> <span class="fl">1e-14</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>     ctr <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>     <span class="cf">while</span> (ctr <span class="op">&lt;</span> <span class="fl">100</span>) <span class="op">&amp;&amp;</span> (<span class="fu">abs</span>(xnew <span class="op">-</span> xold) <span class="op">&gt;</span> tol) <span class="op">&amp;&amp;</span> ( <span class="fu">abs</span>(fn <span class="op">-</span> fo) <span class="op">&gt;</span> tol )</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>       x <span class="op">=</span> xnew <span class="op">-</span> <span class="fu">f</span>(xnew)<span class="op">/</span><span class="fu">fp</span>(xnew) <span class="co"># update step</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>       xnew, xold <span class="op">=</span> x, xnew</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>           fn, fo <span class="op">=</span> <span class="fu">f</span>(xnew), fn</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>       ctr <span class="op">=</span> ctr <span class="op">+</span> <span class="fl">1</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>     <span class="cf">end</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>     <span class="cf">if</span> ctr <span class="op">==</span> <span class="fl">100</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">error</span>(<span class="st">"Did not converge in 100 steps"</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>         <span class="cf">else</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>       xnew, ctr</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>         <span class="cf">end</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>nm (generic function with 1 method)</code></pre>
</div>
</div>
<p>Here we use the <code>nm</code> function to find a zero of this polynomial:</p>
<div id="11fbfed8" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">5</span>x <span class="op">+</span> <span class="fl">1</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> <span class="fl">3</span>x<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">5</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>xstar, ctr <span class="op">=</span> <span class="fu">nm</span>(f, fp, <span class="fl">0</span>)   <span class="co"># takes 6 steps</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>(0.20163967572340466, 6)</code></pre>
</div>
</div>
<p>However, the <code>MTH229</code> package provides the <code>newton</code> function. So we shall use that in the sequel. To see the number of steps, the argument <code>verbose=true</code> may be given.</p>
<hr>
<p>We revisit a problem from a previous project, finding zeroes of the function <span class="math inline">\(f(x) = \exp(x) - x^4\)</span>. We know from previous work that there are three of them. Let’s find one near <span class="math inline">\(x=2\)</span>:</p>
<div id="71ae6374" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">exp</span>(x) <span class="op">-</span> x<span class="op">^</span><span class="fl">4</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fl">2</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>xstar <span class="op">=</span> <span class="fu">newton</span>(f, <span class="fl">2</span>)  <span class="co"># newton will use automatic differentiation for the derivative</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>1.4296118247255556</code></pre>
</div>
</div>
<p>It took 8 steps and we are this close:</p>
<div id="2e94b9e9" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>xstar, <span class="fu">f</span>(xstar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>(1.4296118247255556, 0.0)</code></pre>
</div>
</div>
<p>In this case, the answer is exact up to floating point round off.</p>
<section id="practice-1" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="practice-1"><span class="header-section-number">7.3.1</span> Practice</h3>
<section id="question-3" class="level4">
<h4 class="anchored" data-anchor-id="question-3">Question</h4>
<p>Repeat the problem of finding a root of <span class="math inline">\(f(x) = \exp(x) - x^4\)</span> starting at <span class="math inline">\(x=2\)</span>. (<code>newton(f, 2, verbose=true)</code>). How many iterations does it take with the default tolerances?</p>
<div id="550ea906" class="cell" data-execution_count="21">
<div class="cell-output cell-output-display" data-execution_count="21">
<script>
var ID = "Lyc7NQIf"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="Lyc7NQIf" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_Lyc7NQIf" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <br>
<div class="input-group" aria-label="Input form: Numeric answer">
    <input id="Lyc7NQIf" type="number" class="form-control" placeholder="Numeric answer" aria-label="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="Lyc7NQIf_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_Lyc7NQIf').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_Lyc7NQIf')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.getElementById("Lyc7NQIf").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 6) <= 0.1);
  var msgBox = document.getElementById('Lyc7NQIf_message');
  
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_Lyc7NQIf")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_Lyc7NQIf")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

});

</script>
</div>
</div>
</section>
<section id="question-4" class="level4">
<h4 class="anchored" data-anchor-id="question-4">Question</h4>
<p>If we repeat with <span class="math inline">\(f(x) = \exp(x) - x^4\)</span> but start now at <span class="math inline">\(x=8\)</span> where does the algorithm converge?</p>
<div id="8608d91e" class="cell" data-execution_count="22">
<div class="cell-output cell-output-display" data-execution_count="22">
<script>
var ID = "YvRtBWUs"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="YvRtBWUs" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_YvRtBWUs" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <br>
<div class="input-group" aria-label="Input form: Numeric answer">
    <input id="YvRtBWUs" type="number" class="form-control" placeholder="Numeric answer" aria-label="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="YvRtBWUs_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_YvRtBWUs').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_YvRtBWUs')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.getElementById("YvRtBWUs").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 8.6131694564414) <= 1.0e-6);
  var msgBox = document.getElementById('YvRtBWUs_message');
  
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_YvRtBWUs")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_YvRtBWUs")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

});

</script>
</div>
</div>
</section>
<section id="question-5" class="level4">
<h4 class="anchored" data-anchor-id="question-5">Question</h4>
<p>Let <span class="math inline">\(f(x) = \sin(x) - \cos(4\cdot x)\)</span>.</p>
<p>Starting at <span class="math inline">\(\pi/8\)</span>, solve for the root returned by Newton’s method</p>
<div id="07a343e7" class="cell" data-execution_count="23">
<div class="cell-output cell-output-display" data-execution_count="23">
<script>
var ID = "QQH1a8xp"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="QQH1a8xp" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_QQH1a8xp" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <br>
<div class="input-group" aria-label="Input form: Numeric answer">
    <input id="QQH1a8xp" type="number" class="form-control" placeholder="Numeric answer" aria-label="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="QQH1a8xp_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_QQH1a8xp').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_QQH1a8xp')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.getElementById("QQH1a8xp").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.3141592653589793) <= 0.001);
  var msgBox = document.getElementById('QQH1a8xp_message');
  
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_QQH1a8xp")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_QQH1a8xp")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

});

</script>
</div>
</div>
</section>
</section>
</section>
<section id="numeric-derivatives" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="numeric-derivatives"><span class="header-section-number">7.4</span> Numeric derivatives</h2>
<p>In order to use Newton’s method we need to evaluate <span class="math inline">\(f'(x)\)</span>. We have used automatic differentiation above through <code>f'(x)</code>. Automatic differentiation returns a numerically accurate value for the derivative.</p>
<p>However, Newton’s method is actually fairly robust to using other related values to the derivative. That is the method will converge, though perhaps not as fast as with the derivative.</p>
<section id="the-secant-method" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="the-secant-method"><span class="header-section-number">7.4.1</span> The secant method</h3>
<p>The <a href="http://en.wikipedia.org/wiki/Secant_method">secant method</a> is perhaps the oldest numerical linear algebra tool dating back over <a href="http://scholarship.rice.edu/bitstream/handle/1911/20568/1442093.PDF?sequence=1">3000 years</a> well before Newton’s method. Rather than use the derivative at <span class="math inline">\(x_i\)</span> to compute <span class="math inline">\(x_{i+1}\)</span>, the secant line is used between <span class="math inline">\(x_{i-1}\)</span> and <span class="math inline">\(x_i\)</span>. This method will also converge to a zero with a good starting point, though not nearly as quickly as Newton’s method.</p>
<p>You can check – if you want – by repeating the last command until the change in <code>x2</code> is within your tolerance:</p>
<div id="d5344f12" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>x2, x1 <span class="op">=</span> <span class="fl">1</span>, <span class="fl">2</span>           <span class="co"># initial guess of 2</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">2</span>          <span class="co"># some function</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x1,x2) <span class="op">=</span> (<span class="fu">f</span>(x1) <span class="op">-</span> <span class="fu">f</span>(x2))<span class="op">/</span>(x1 <span class="op">-</span> x2)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>x2, x1 <span class="op">=</span> x2 <span class="op">-</span> <span class="fu">f</span>(x2)<span class="op">/</span><span class="fu">fp</span>(x1, x2), x2 <span class="co"># update step</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>(1.3333333333333333, 1)</code></pre>
</div>
</div>
<p>We can repeat via copy and paste:</p>
<div id="0cf12ca9" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>x2, x1 <span class="op">=</span> x2 <span class="op">-</span> <span class="fu">f</span>(x2)<span class="op">/</span><span class="fu">fp</span>(x1, x2), x2</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>x2, x1 <span class="op">=</span> x2 <span class="op">-</span> <span class="fu">f</span>(x2)<span class="op">/</span><span class="fu">fp</span>(x1, x2), x2</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>x2, x1 <span class="op">=</span> x2 <span class="op">-</span> <span class="fu">f</span>(x2)<span class="op">/</span><span class="fu">fp</span>(x1, x2), x2</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>x2, x1 <span class="op">=</span> x2 <span class="op">-</span> <span class="fu">f</span>(x2)<span class="op">/</span><span class="fu">fp</span>(x1, x2), x2</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>x2, x1 <span class="op">=</span> x2 <span class="op">-</span> <span class="fu">f</span>(x2)<span class="op">/</span><span class="fu">fp</span>(x1, x2), x2</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>x2, <span class="fu">f</span>(x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>(1.4142135623730947, -8.881784197001252e-16)</code></pre>
</div>
</div>
<p>The last line shows the algorithm has basically converged, as the values agree to <span class="math inline">\(10^{-14}\)</span>. We have</p>
</section>
<section id="using-forward-differences" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="using-forward-differences"><span class="header-section-number">7.4.2</span> Using forward differences</h3>
<p>Recall the forward difference approximation to the derivative:</p>
<p><span class="math display">\[
f'(x) \approx \frac{f(x + h) - f(x)}{h}
\]</span></p>
<p>For some small <span class="math inline">\(h\)</span> (with <span class="math inline">\(h=10^{-8}\)</span> a reasonable choice for many functions). This can be used</p>
<p>One can also use approximate derivatives based on forward differences in place of <span class="math inline">\(f'(x)\)</span> in the formula. Again, this won’t be as fast.</p>
<p>The update step <span class="math inline">\(x - f(x)/f'(x)\)</span> becomes</p>
<p><span class="math display">\[
x - \frac{h \cdot f(x)}{f(x+h) - f(x)}.
\]</span></p>
<p>The issue with this approximation is when the estimated value gets close to the actual root, the value of <span class="math inline">\(h\)</span> becomes too large. Steffenson’s method replaces <span class="math inline">\(h\)</span> with <span class="math inline">\(f(x)\)</span>, which for values close to a root gets quite small. This improves the convergence rate to be on par with Newton’s method. In this case, the update step looks like</p>
<p><span class="math display">\[
x - \frac{f(x)^2}{f(x+ f(x)) - f(x)}.
\]</span></p>
</section>
<section id="problems" class="level3" data-number="7.4.3">
<h3 data-number="7.4.3" class="anchored" data-anchor-id="problems"><span class="header-section-number">7.4.3</span> Problems</h3>
<section id="question-6" class="level4">
<h4 class="anchored" data-anchor-id="question-6">Question</h4>
<p>Use the secant method to find a root to <span class="math inline">\(f(x) = \cos(x) - x^3\)</span> starting with <span class="math inline">\(x_1=1/2\)</span> and <span class="math inline">\(x_2=1\)</span>.</p>
<div id="8c689ff1" class="cell" data-execution_count="26">
<div class="cell-output cell-output-display" data-execution_count="26">
<script>
var ID = "49ARuqcX"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="49ARuqcX" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_49ARuqcX" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <br>
<div class="input-group" aria-label="Input form: Numeric answer">
    <input id="49ARuqcX" type="number" class="form-control" placeholder="Numeric answer" aria-label="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="49ARuqcX_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_49ARuqcX').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_49ARuqcX')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.getElementById("49ARuqcX").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.8654740331016144) <= 1.0e-10);
  var msgBox = document.getElementById('49ARuqcX_message');
  
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_49ARuqcX")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_49ARuqcX")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

});

</script>
</div>
</div>
</section>
<section id="question-7" class="level4">
<h4 class="anchored" data-anchor-id="question-7">Question</h4>
<p>Use the secant method to find a root to <span class="math inline">\(f(x) = x^5 + x - 1\)</span> starting with <span class="math inline">\(x_1=1/2\)</span> and <span class="math inline">\(x_2=1\)</span>.</p>
<div id="47e08190" class="cell" data-execution_count="27">
<div class="cell-output cell-output-display" data-execution_count="27">
<script>
var ID = "8bOXS9yK"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="8bOXS9yK" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_8bOXS9yK" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <br>
<div class="input-group" aria-label="Input form: Numeric answer">
    <input id="8bOXS9yK" type="number" class="form-control" placeholder="Numeric answer" aria-label="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="8bOXS9yK_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_8bOXS9yK').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_8bOXS9yK')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.getElementById("8bOXS9yK").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.7548776662466927) <= 1.0e-10);
  var msgBox = document.getElementById('8bOXS9yK_message');
  
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_8bOXS9yK")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_8bOXS9yK")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

});

</script>
</div>
</div>
</section>
</section>
</section>
<section id="the-find_zero-function" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="the-find_zero-function"><span class="header-section-number">7.5</span> The <code>find_zero</code> function</h2>
<p>There are also very fast algorithms which do not require a derivative. The <code>Roots</code> package provides an interface to these through the <code>find_zero</code> function.</p>
<p>The <code>find_zero</code> function has two interfaces:</p>
<ul>
<li>when called with a bracketing interval, as in <code>find_zero(f, (a,b))</code>, it will use a bisection method to find a root.</li>
<li>when called with a starting point, as in <code>find_zero(f, a)</code>, it will use an iterative algorithm to search for a root.</li>
</ul>
<p>Many bracketing methods (like bisection) are guaranteed to converge, but can be slow. The iterative algorithm used by default with <code>find_zero</code> tries to speed the convergence up, but if along the way it finds a bracketing interval, that will guarantee convergence.</p>
<p>We focus on the simplest usage of <code>find_zero</code> where an initial guess is supplied and the default order is used. Here is an example to find <span class="math inline">\(-\sqrt{2}\)</span>:</p>
<div id="1c27fdb4" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">2</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">find_zero</span>(f, <span class="op">-</span><span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>-1.4142135623730951</code></pre>
</div>
</div>
<section id="using-find_zero-and-a-graph-to-find-all-roots." class="level3" data-number="7.5.1">
<h3 data-number="7.5.1" class="anchored" data-anchor-id="using-find_zero-and-a-graph-to-find-all-roots."><span class="header-section-number">7.5.1</span> Using <code>find_zero</code> and a graph to find all roots.</h3>
<p>Let’s look, again, at the task of finding all zeros to the function <span class="math inline">\(e^x - x^4\)</span>. We follow a standard approach:</p>
<ul>
<li>graph the function to roughly identify potential zeros</li>
<li>use these as starting points for <code>find_zero</code> to improve</li>
</ul>
<p>The following graph suggests, perhaps, there may be <span class="math inline">\(3\)</span> zeros, one near <span class="math inline">\(9\)</span>, one near <span class="math inline">\(2\)</span> and one near <span class="math inline">\(-1\)</span>.</p>
<div id="6c93746e" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">exp</span>(x) <span class="op">-</span> x<span class="op">^</span><span class="fl">4</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="op">-</span><span class="fl">5</span>, <span class="fl">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
    <div id="8234e3b6-0b82-4c46-8df1-bf58be895b03" style="width:672px;height:480px;"></div>
    <script>
        requirejs.config({
        paths: {
            plotly: 'https://cdn.plot.ly/plotly-2.6.3.min'
        }
    });
    require(['plotly'], function (Plotly) {

    Plotly.newPlot('8234e3b6-0b82-4c46-8df1-bf58be895b03', [
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303337
        },
        "name": "y1",
        "yaxis": "y",
        "legendgroup": "y1",
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -624.9932620530009,
            -613.6773013580785,
            -602.5156940186796,
            -591.5070298242472,
            -580.6499050330475,
            -532.3848921790742,
            -487.1930012955847,
            -444.9409096479892,
            -405.4982495652575,
            -368.73760831499436,
            -334.534527964636,
            -302.7675052272255,
            -273.31799129005395,
            -240.82575134801345,
            -211.31950373626358,
            -184.61035358443723,
            -160.51556953815287,
            -125.22879472090553,
            -96.10172237116237,
            -70.55285615003082,
            -50.46160189225934,
            -36.04738426460105,
            -24.949933722498063,
            -16.105383867474767,
            -9.81487939505613,
            -4.995042165466734,
            -2.1136453474420436,
            0.10807437835932376,
            0.6840891313009364,
            1.1009246089178757,
            1.6433582565971854,
            1.6333605792942345,
            -0.8990112995071771,
            -4.156076681461426,
            -9.415001612466853,
            -15.833837133306748,
            -24.490393755731482,
            -38.7087306027469,
            -57.70719846390766,
            -80.03288792400286,
            -107.75508661146168,
            -138.73080947954085,
            -175.39009407078396,
            -218.8087861932163,
            -268.9913057773001,
            -300.20668893881304,
            -333.7087924970519,
            -369.5321821964031,
            -407.69527715433264,
            -444.29783323372345,
            -482.80538500986415,
            -523.1847788948551,
            -565.3832727311991,
            -668.4151376834445,
            -779.0966421115977,
            -886.3408974160986,
            -995.2747072825501,
            -1100.4243469812186,
            -1198.052429300475,
            -1240.7003543809394,
            -1278.9459958374719,
            -1311.6521359395513,
            -1337.5210033220458,
            -1347.6579103880626,
            -1355.3944336097766,
            -1360.496747761676,
            -1362.7153442815377,
            -1361.7840799281278,
            -1357.4191687081736,
            -1349.3181136896285,
            -1337.1585751165023,
            -1318.7698787244044,
            -1294.6144128287879,
            -1264.175455930891,
            -1226.8997278933507,
            -1205.5145856356721,
            -1182.1949692219591,
            -1156.8603325529402,
            -1129.4273617489557,
            -1099.809885135524,
            -1067.9187803269415,
            -1033.6618783143504,
            -996.9438644617267,
            -939.0177310919585,
            -875.3745968459452,
            -805.683978898965,
            -729.5990062846436,
            -646.7556417232981,
            -556.7718667423687,
            -508.97781866023706,
            -459.24682835734075,
            -407.5256997221477,
            -353.75994549991174,
            -297.89375703280984,
            -239.8699732945979,
            -179.63004920334424,
            -117.11402319537501,
            -52.26048404326957,
            14.993463099788642,
            84.71223144731721,
            156.96178813689403,
            231.80969061658016,
            309.3251238796056,
            389.578938567186,
            472.6436899596665,
            558.5936778767091,
            647.5049875077284,
            739.455531194254,
            834.5250911864377,
            914.927415304076,
            997.5311967624039,
            1082.3834689481437,
            1169.532187665929,
            1259.0262488079616,
            1350.9155063610187,
            1445.25079075726,
            1542.0839275753842
        ],
        "type": "scatter",
        "x": [
            -5.0,
            -4.977213088953827,
            -4.954426177907655,
            -4.931639266861483,
            -4.90885235581531,
            -4.803503407975295,
            -4.69815446013528,
            -4.592805512295264,
            -4.487456564455249,
            -4.382107616615233,
            -4.2767586687752175,
            -4.171409720935202,
            -4.066060773095186,
            -3.9394401201082676,
            -3.8128194671213484,
            -3.6861988141344293,
            -3.5595781611475106,
            -3.345465859900182,
            -3.131353558652853,
            -2.8987675858388533,
            -2.666181613024853,
            -2.451757918684162,
            -2.2373342243434706,
            -2.007449362274783,
            -1.777564500206095,
            -1.5112203431898967,
            -1.2448761861736986,
            -0.7714856762971333,
            -0.35636485895794656,
            0.09622826211631494,
            0.5515112683595795,
            1.0548848511611064,
            1.533832113618539,
            1.7828291265289056,
            2.031826139439272,
            2.2414285868315798,
            2.451031034223888,
            2.70693186504831,
            2.9628326958727316,
            3.197254046017246,
            3.4316753961617605,
            3.648181603528976,
            3.864687810896191,
            4.084001889684814,
            4.303315968473436,
            4.426210767878793,
            4.549105567284149,
            4.672000366689506,
            4.794895166094863,
            4.906257694865642,
            5.0176202236364205,
            5.1289827524072,
            5.240345281177979,
            5.495350110695208,
            5.750354940212436,
            5.9864667351273635,
            6.222578530042291,
            6.455357092431437,
            6.688135654820583,
            6.801140014090681,
            6.914144373360779,
            7.027148732630877,
            7.140153091900976,
            7.198075050930976,
            7.255997009960975,
            7.313918968990974,
            7.371840928020974,
            7.429762887050973,
            7.487684846080972,
            7.545606805110971,
            7.603528764140971,
            7.666988994679702,
            7.730449225218434,
            7.793909455757166,
            7.857369686295899,
            7.889099801565265,
            7.920829916834631,
            7.952560032103997,
            7.984290147373363,
            8.01602026264273,
            8.047750377912095,
            8.07948049318146,
            8.111210608450827,
            8.157303804729931,
            8.203397001009037,
            8.249490197288143,
            8.295583393567249,
            8.341676589846355,
            8.387769786125459,
            8.410816384265011,
            8.433862982404563,
            8.456909580544115,
            8.479956178683668,
            8.503002776823221,
            8.526049374962774,
            8.549095973102325,
            8.572142571241878,
            8.595189169381431,
            8.618235767520982,
            8.641282365660535,
            8.664328963800088,
            8.687375561939641,
            8.710422160079194,
            8.733468758218747,
            8.7565153563583,
            8.779561954497852,
            8.802608552637405,
            8.825655150776957,
            8.84870174891651,
            8.867614030301947,
            8.886526311687383,
            8.90543859307282,
            8.924350874458256,
            8.943263155843692,
            8.962175437229128,
            8.981087718614564,
            9.0
        ]
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -4.0,
            -2.0,
            0.0,
            2.0,
            4.0,
            6.0,
            8.0
        ],
        "range": [
            -5.42,
            9.42
        ],
        "domain": [
            0.07199620880723243,
            0.9941413573303337
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−4",
            "−2",
            "0",
            "2",
            "4",
            "6",
            "8"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 480,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -1000.0,
            -500.0,
            0.0,
            500.0,
            1000.0,
            1500.0
        ],
        "range": [
            -1449.8593224372457,
            1629.227905731092
        ],
        "domain": [
            0.031350247885680964,
            0.9917979002624672
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−1000",
            "−500",
            "0",
            "500",
            "1000",
            "1500"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "legend": {
        "yanchor": "auto",
        "xanchor": "auto",
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "borderwidth": 1,
        "tracegroupgap": 0,
        "y": 1.0,
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "title": {
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 15
            },
            "text": ""
        },
        "traceorder": "normal",
        "x": 1.0
    },
    "width": 672
}
);
    });
    </script>
</div>
</div>
<p>We can improve these guesses with</p>
<div id="bb8d64db" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">find_zero</span>(f, <span class="fl">9</span>), <span class="fu">find_zero</span>(f, <span class="fl">2</span>), <span class="fu">find_zero</span>(f, <span class="op">-</span><span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>(8.6131694564414, 1.4296118247255556, -0.8155534188089607)</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Avoiding repetition
</div>
</div>
<div class="callout-body-container callout-body">
<p>The above can be written without repeating <code>find_zero</code> by using a comprehension:</p>
<div id="5dc812f5" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>[<span class="fu">find_zero</span>(f, x) for x <span class="kw">in</span> [<span class="fl">9</span>, <span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>3-element Vector{Float64}:
  8.6131694564414
  1.4296118247255556
 -0.8155534188089607</code></pre>
</div>
</div>
<p>Or even more compactly, using the broadcast notation:</p>
<div id="217de951" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">find_zero</span>.(f, [<span class="op">-</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>3-element Vector{Float64}:
 -0.8155534188089607
  1.4296118247255556
  8.6131694564414</code></pre>
</div>
</div>
</div>
</div>
<p>As another illustration, let <span class="math inline">\(f(x) = \cos^2(x^2)\)</span> on <span class="math inline">\([-1,2]\)</span>. Find all the zeros of the derivative of <span class="math inline">\(f(x)\)</span>.</p>
<p>We graph the derivative to identify starting points:</p>
<div id="d75fc931" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">cos</span>(x<span class="op">^</span><span class="fl">2</span>)<span class="op">^</span><span class="fl">2</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f<span class="op">'</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
    <div id="36fb97ca-6394-43bb-ba85-25fb4fd3b3df" style="width:672px;height:480px;"></div>
    <script>
        requirejs.config({
        paths: {
            plotly: 'https://cdn.plot.ly/plotly-2.6.3.min'
        }
    });
    require(['plotly'], function (Plotly) {

    Plotly.newPlot('36fb97ca-6394-43bb-ba85-25fb4fd3b3df', [
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303337
        },
        "name": "y1",
        "yaxis": "y",
        "legendgroup": "y1",
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            1.8185948536513636,
            1.8255074907316338,
            1.831503698402216,
            1.836599214837022,
            1.8408100535133547,
            1.8492506432532123,
            1.840800199277721,
            1.8171861226831896,
            1.780163900000359,
            1.7314844563167713,
            1.672866109197317,
            1.6059710170684782,
            1.5323859294518698,
            1.4371960320263928,
            1.3368985371557642,
            1.2336623306290597,
            1.129413599194958,
            0.9554143959561401,
            0.7897841405356245,
            0.6248124928405567,
            0.4791434901095381,
            0.41910091480729095,
            0.36367512744563935,
            0.31288077755522725,
            0.26667866936155643,
            0.22214730219468407,
            0.1826377140000548,
            0.1479480482097269,
            0.11783942774121517,
            0.08832858697063249,
            0.06414677004444062,
            0.04480284623243541,
            0.029781691453885983,
            0.0033104921634235884,
            4.808479501094209e-7,
            -0.0031195733574711703,
            -0.02724371791808789,
            -0.040574557623385216,
            -0.05764543318600161,
            -0.07889566942737697,
            -0.10474739397446818,
            -0.13398111655284997,
            -0.16805934338035783,
            -0.20726740526068366,
            -0.2518504028406295,
            -0.3041159925472902,
            -0.3625556072036511,
            -0.4272380962202539,
            -0.4981346314394562,
            -0.5625307352174344,
            -0.6310761398822473,
            -0.7035430269883526,
            -0.77962402332925,
            -1.1870000383685897,
            -1.5555533000151853,
            -1.6291340771352978,
            -1.6951008566344439,
            -1.751701595309327,
            -1.797107441701249,
            -1.8297615986097415,
            -1.8470169174258764,
            -1.849253079226398,
            -1.8469042577364978,
            -1.8397331075075525,
            -1.8275086486100143,
            -1.8075279954472245,
            -1.7806213649290594,
            -1.746508160059974,
            -1.704929699174946,
            -1.6556526928808462,
            -1.5984728338144472,
            -1.533218478935298,
            -1.4597544010384103,
            -1.386013458140786,
            -1.3054131066537444,
            -1.2179457314706974,
            -1.1236380001154773,
            -1.0225531015966518,
            -0.9147929159772462,
            -0.8005000923550356,
            -0.6798600116296164,
            -0.5342397691596602,
            -0.38102175582330816,
            -0.22070786349559685,
            -0.053884560526387515,
            0.296511624844487,
            0.6637336863633604,
            1.0119688296219875,
            1.3607024355139221,
            1.7018032842712985,
            2.0263685868502543,
            2.1773886110001244,
            2.320911565089381,
            2.4557461621272116,
            2.5806949544627873,
            2.6945634185852523,
            2.7961697045894116,
            2.8843550109619085,
            2.957994535004981,
            3.0145519555262807,
            3.055443332836141,
            3.0797939399757572,
            3.086801423604273,
            3.075746752048943,
            3.046005207809567,
            3.0239601168340555,
            2.997057320738826,
            2.9652500965926207,
            2.9284996296574577,
            2.8856626177172613,
            2.8375750733792326,
            2.784223131498175,
            2.7256030278723506,
            2.6617214172881756,
            2.5925956776133376,
            2.5182541985862366,
            2.4387366539348068,
            2.3540942554462787,
            2.2643899876017572,
            2.169698821385775,
            2.0701079058812875,
            1.8566372968292781,
            1.6249246636616352,
            1.490662419760057,
            1.3514821462146425,
            1.2076171995814287,
            1.059319288492618,
            0.7505223790027195,
            0.4274659753896859,
            -0.25054353651057304,
            -0.9503942830384066,
            -1.456629975741615,
            -1.9481050427367124,
            -2.1845305391682093,
            -2.4126942743330373,
            -2.6310476992418472,
            -2.838047811115071,
            -3.0321678583117304,
            -3.2119084857010303,
            -3.37580925864061,
            -3.522460496471568,
            -3.5888938586515797,
            -3.650515339292664,
            -3.7071684012482855,
            -3.7587019648110647,
            -3.8049707913087456,
            -3.845835865365859,
            -3.881164775021054,
            -3.9108320888688404,
            -3.9308649819053834,
            -3.946944310300248,
            -3.959012329957917,
            -3.9670150675378166,
            -3.9709024516800064,
            -3.9706284418394184,
            -3.966151154494449,
            -3.957432986493527
        ],
        "type": "scatter",
        "x": [
            -1.0,
            -0.9951170904901059,
            -0.9902341809802119,
            -0.9853512714703179,
            -0.9804683619604238,
            -0.9578935874232776,
            -0.9353188128861314,
            -0.9127440383489852,
            -0.890169263811839,
            -0.8675944892746928,
            -0.8450197147375467,
            -0.8224449402004006,
            -0.7998701656632544,
            -0.7727371685946289,
            -0.7456041715260033,
            -0.7184711744573777,
            -0.6913381773887523,
            -0.6454569699786104,
            -0.5995757625684686,
            -0.5497359112511828,
            -0.49989605993389713,
            -0.4769220926831088,
            -0.45394812543232044,
            -0.43097415818153206,
            -0.4080001909307437,
            -0.3833696699948128,
            -0.358739149058882,
            -0.33410862812295117,
            -0.3094781071870203,
            -0.28094123322099906,
            -0.25240435925497784,
            -0.22386748528895664,
            -0.19533061132293544,
            -0.09388978777795712,
            -0.004935326919559979,
            0.09204891331063893,
            0.1896095575056242,
            0.21657599944142028,
            0.24354244137721637,
            0.2705088833130125,
            0.29747532524880854,
            0.32313321430902814,
            0.34879110336924773,
            0.37444899242946733,
            0.4001068814896869,
            0.4267851328729405,
            0.45346338425619404,
            0.48014163563944756,
            0.5068198870227011,
            0.5292772921004484,
            0.5517346971781957,
            0.574192102255943,
            0.5966495073336903,
            0.7063212919727282,
            0.8067875848918058,
            0.8299846785382932,
            0.8531817721847805,
            0.8763788658312679,
            0.8995759594777553,
            0.9230738964908219,
            0.9465718335038886,
            0.9583208020104219,
            0.9700697705169553,
            0.9818187390234887,
            0.993567707530022,
            1.0067350074663102,
            1.0199023074025986,
            1.0330696073388868,
            1.046236907275175,
            1.0594042072114631,
            1.0725715071477513,
            1.0857388070840397,
            1.0989061070203279,
            1.1108378065314826,
            1.1227695060426375,
            1.1347012055537924,
            1.1466329050649473,
            1.1585646045761022,
            1.1704963040872571,
            1.182428003598412,
            1.194359703109567,
            1.2080206761194185,
            1.2216816491292701,
            1.2353426221391217,
            1.249003595148973,
            1.276325541168676,
            1.3036474871883792,
            1.3289451795006928,
            1.3542428718130064,
            1.3795405641253202,
            1.4048382564376338,
            1.4173085365656237,
            1.4297788166936138,
            1.4422490968216037,
            1.4547193769495936,
            1.4671896570775835,
            1.4796599372055734,
            1.4921302173335635,
            1.5046004974615534,
            1.5167081073833497,
            1.528815717305146,
            1.5409233272269423,
            1.5530309371487385,
            1.5651385470705348,
            1.577246156992331,
            1.5832999619532293,
            1.5893537669141273,
            1.5954075718750254,
            1.6014613768359236,
            1.6076673010177092,
            1.613873225199495,
            1.6200791493812805,
            1.626285073563066,
            1.6324909977448518,
            1.6386969219266374,
            1.644902846108423,
            1.6511087702902087,
            1.6573146944719943,
            1.6635206186537799,
            1.6697265428355657,
            1.6759324670173512,
            1.6883443153809226,
            1.7007561637444937,
            1.7075554741593577,
            1.714354784574222,
            1.7211540949890862,
            1.7279534054039503,
            1.7415520262336786,
            1.7551506470634068,
            1.7823478887228634,
            1.8095451303823202,
            1.8292993573590794,
            1.8490535843358389,
            1.8589306978242186,
            1.8688078113125983,
            1.878684924800978,
            1.8885620382893578,
            1.8984391517777375,
            1.9083162652661172,
            1.9181933787544967,
            1.9280704922428764,
            1.9330090489870662,
            1.9379476057312561,
            1.9428861624754459,
            1.9478247192196356,
            1.9527632759638256,
            1.9577018327080153,
            1.962640389452205,
            1.967578946196395,
            1.9716315779218456,
            1.9756842096472962,
            1.979736841372747,
            1.9837894730981975,
            1.987842104823648,
            1.9918947365490989,
            1.9959473682745494,
            2.0
        ]
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -1.0,
            0.0,
            1.0,
            2.0
        ],
        "range": [
            -1.09,
            2.09
        ],
        "domain": [
            0.032313669124692745,
            0.9941413573303337
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−1",
            "0",
            "1",
            "2"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 480,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -4.0,
            -2.0,
            0.0,
            2.0
        ],
        "range": [
            -4.1826335679385345,
            3.2985325398628014
        ],
        "domain": [
            0.031350247885680964,
            0.9917979002624672
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−4",
            "−2",
            "0",
            "2"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "legend": {
        "yanchor": "auto",
        "xanchor": "auto",
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "borderwidth": 1,
        "tracegroupgap": 0,
        "y": 1.0,
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "title": {
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 15
            },
            "text": ""
        },
        "traceorder": "normal",
        "x": 1.0
    },
    "width": 672
}
);
    });
    </script>
</div>
</div>
<p>We see there are 3 potential zeros, one near 0, one near 1.2 and close to 1.7. Here we improve our guesses:</p>
<div id="0c1c53e9" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> <span class="fu">find_zero</span>.(f<span class="op">'</span>, [<span class="fl">0</span>, <span class="fl">1.2</span>, <span class="fl">1.7</span>])   <span class="co"># or [find_zero(f', x) for x in [0, 1.2, 1.7]]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>3-element Vector{Float64}:
 0.0
 1.2533141373155003
 1.772453850905516</code></pre>
</div>
</div>
<p>The function values at these points can be found with</p>
<div id="0b4651ad" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>.(xs)               <span class="co"># or map(f, xs) or [f(x) for x in xs]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>3-element Vector{Float64}:
 1.0
 2.5860584564030066e-32
 1.0</code></pre>
</div>
</div>
<hr>
<p>Solving <span class="math inline">\(f(x) = g(x)\)</span> requires representing the difference of the two sides. For example, find the zero of <span class="math inline">\(cos(x) = 7x\)</span> in <span class="math inline">\((0, \pi/2)\)</span>. A graph will show a zero left of <span class="math inline">\(0.2\)</span>, which we take as an initial value:</p>
<div id="c59ddc4c" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">cos</span>(x)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">g</span>(x) <span class="op">=</span> <span class="fl">7</span>x</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">eqn</span>(x) <span class="op">=</span> <span class="fu">f</span>(x) <span class="op">-</span> <span class="fu">g</span>(x)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">find_zero</span>(eqn, <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>0.14143076140757285</code></pre>
</div>
</div>
</section>
<section id="practice-2" class="level3" data-number="7.5.2">
<h3 data-number="7.5.2" class="anchored" data-anchor-id="practice-2"><span class="header-section-number">7.5.2</span> Practice</h3>
<section id="question-8" class="level4">
<h4 class="anchored" data-anchor-id="question-8">Question</h4>
<p>Let</p>
<p><span class="math display">\[
f(x) = 4x^4 -5x^3 + 4x^2 -20x - 6
\]</span></p>
<p>Apply Newton’s method with <span class="math inline">\(x_1=0\)</span> using an automatic derivative. What value does it converge to?</p>
<div id="57a27ec9" class="cell" data-execution_count="37">
<div class="cell-output cell-output-display" data-execution_count="37">
<script>
var ID = "zx7axNNh"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="zx7axNNh" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_zx7axNNh" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <br>
<div class="input-group" aria-label="Input form: Numeric answer">
    <input id="zx7axNNh" type="number" class="form-control" placeholder="Numeric answer" aria-label="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="zx7axNNh_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_zx7axNNh').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_zx7axNNh')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.getElementById("zx7axNNh").addEventListener("change", function() {
  var correct = (Math.abs(this.value - -0.27798094871260326) <= 1.0e-10);
  var msgBox = document.getElementById('zx7axNNh_message');
  
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_zx7axNNh")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_zx7axNNh")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

});

</script>
</div>
</div>
</section>
<section id="question-9" class="level4">
<h4 class="anchored" data-anchor-id="question-9">Question</h4>
<p>Let’s try with a function where the derivative is not known easily. If we set</p>
<p><span class="math display">\[
f(x) = x^x - 2
\]</span></p>
<p>Can we find a root using Newton’s method, where <span class="math inline">\(x &gt; 0\)</span>?</p>
<p>We graph the function to see, using a smallish interval at first:</p>
<div id="15dcf280" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x<span class="op">^</span>x <span class="op">-</span> <span class="fl">2</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="fl">0</span>, <span class="fl">2</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(zero)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
    <div id="d199d3b6-6555-4a64-a3d0-ea0ab34c4901" style="width:672px;height:480px;"></div>
    <script>
        requirejs.config({
        paths: {
            plotly: 'https://cdn.plot.ly/plotly-2.6.3.min'
        }
    });
    require(['plotly'], function (Plotly) {

    Plotly.newPlot('d199d3b6-6555-4a64-a3d0-ea0ab34c4901', [
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303337
        },
        "name": "y1",
        "yaxis": "y",
        "legendgroup": "y1",
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -1.0,
            -1.018471774554126,
            -1.0322449292701017,
            -1.0441981677665488,
            -1.0549590002296656,
            -1.0954322247062043,
            -1.1267740949494707,
            -1.1524954645626044,
            -1.1742133752249955,
            -1.2090565624511105,
            -1.235659229181644,
            -1.248672615988137,
            -1.25986394830012,
            -1.2694778820412282,
            -1.2777068796511815,
            -1.288888735673651,
            -1.297112954220501,
            -1.3066434585010989,
            -1.3071398032837505,
            -1.3003152199742183,
            -1.284012643697211,
            -1.2624998137903805,
            -1.2383423396690278,
            -1.206327540394191,
            -1.1679527257038589,
            -1.1179101495023,
            -1.06230168331897,
            -1.0300765206816445,
            -0.9954326900236277,
            -0.9642996662370744,
            -0.931275789393776,
            -0.8882600703085095,
            -0.8421080772200686,
            -0.7969092880054272,
            -0.7487482363833415,
            -0.701482562037639,
            -0.6513874842835301,
            -0.5975923764569699,
            -0.5405477881705487,
            -0.47251593215256116,
            -0.3998671087285015,
            -0.32978420182632595,
            -0.2553979647012805,
            -0.16459677024700348,
            -0.06735962284197661,
            0.028824111984929512,
            0.1313392943996048,
            0.23903208181968294,
            0.3537564927489627,
            0.4723325383679753,
            0.5984732446333179,
            0.6662259907876233,
            0.7361732986063494,
            0.808390799743131,
            0.8829569472087226,
            0.9674455447022519,
            1.0549623830371897,
            1.1456232690951276,
            1.2395487781314207,
            1.3820653426722784,
            1.5321415130448366,
            1.6902063896934387,
            1.856715181285932,
            1.891962101398427,
            1.9275889536518056,
            1.9636001109974774,
            2.0
        ],
        "type": "scatter",
        "x": [
            0.0,
            0.0032552730065960435,
            0.006510546013192087,
            0.009765819019788131,
            0.013021092026384174,
            0.028070941717814955,
            0.04312079140924574,
            0.058170641100676525,
            0.07322049079210731,
            0.10332019017496888,
            0.13341988955783043,
            0.15150855427024745,
            0.16959721898266447,
            0.1876858836950815,
            0.2057745484074985,
            0.23636202001425977,
            0.266949491621021,
            0.33340262671073523,
            0.39466653937950424,
            0.4603479285419865,
            0.536446259118043,
            0.6040734748146952,
            0.6633764487202933,
            0.7280326088737592,
            0.7930730383370829,
            0.8649835501658724,
            0.9334045876597913,
            0.9689755895041294,
            1.0045465913484675,
            1.034489798118797,
            1.0644330048891268,
            1.1009902664354727,
            1.1375475279818188,
            1.171036292288178,
            1.2045250565945371,
            1.2354545147898537,
            1.26638397298517,
            1.297714555669259,
            1.329045138353348,
            1.3641579381834499,
            1.3992707380135518,
            1.4310886033766317,
            1.4629064687397113,
            1.4993357300993155,
            1.5357649914589195,
            1.569495247875338,
            1.603225504291756,
            1.6364795846330624,
            1.669733664974369,
            1.7020206247658258,
            1.7343075845572824,
            1.7508567157087107,
            1.767405846860139,
            1.7839549780115673,
            1.8005041091629959,
            1.8186356036026337,
            1.8367670980422712,
            1.854898592481909,
            1.8730300869215468,
            1.8993690562238927,
            1.9257080255262384,
            1.9520469948285841,
            1.97838596413093,
            1.9837894730981975,
            1.989192982065465,
            1.9945964910327325,
            2.0
        ]
    },
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303337
        },
        "name": "y2",
        "yaxis": "y",
        "legendgroup": "y2",
        "line": {
            "color": "rgba(227, 111, 71, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
        ],
        "type": "scatter",
        "x": [
            0.0,
            0.013021092026384174,
            0.13341988955783043,
            0.2057745484074985,
            0.266949491621021,
            0.33340262671073523,
            0.39466653937950424,
            0.4603479285419865,
            0.536446259118043,
            0.6040734748146952,
            0.6633764487202933,
            0.7280326088737592,
            0.7930730383370829,
            0.8649835501658724,
            0.9334045876597913,
            1.0045465913484675,
            1.0644330048891268,
            1.1375475279818188,
            1.2045250565945371,
            1.26638397298517,
            1.329045138353348,
            1.3992707380135518,
            1.4629064687397113,
            1.5357649914589195,
            1.603225504291756,
            1.669733664974369,
            1.7343075845572824,
            1.8005041091629959,
            1.8730300869215468,
            1.97838596413093,
            2.0
        ]
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            0.0,
            0.5,
            1.0,
            1.5,
            2.0
        ],
        "range": [
            -0.06000000000000005,
            2.06
        ],
        "domain": [
            0.032313669124692745,
            0.9941413573303337
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "0.0",
            "0.5",
            "1.0",
            "1.5",
            "2.0"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 480,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -1.0,
            0.0,
            1.0,
            2.0
        ],
        "range": [
            -1.406353997382263,
            2.0992141940985123
        ],
        "domain": [
            0.031350247885680964,
            0.9917979002624672
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−1",
            "0",
            "1",
            "2"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "legend": {
        "yanchor": "auto",
        "xanchor": "auto",
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "borderwidth": 1,
        "tracegroupgap": 0,
        "y": 1.0,
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "title": {
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 15
            },
            "text": ""
        },
        "traceorder": "normal",
        "x": 1.0
    },
    "width": 672
}
);
    });
    </script>
</div>
</div>
<p>Eyeing this, we pick an initial point, <span class="math inline">\(1\)</span>, for Newton’s method (<code>newton(f, 1)</code>) to the right of the minimum, which appears to be around <span class="math inline">\(x=0.35\)</span>.</p>
<p>What is the value of the approximate zero?</p>
<div id="62c0033c" class="cell" data-execution_count="39">
<div class="cell-output cell-output-display" data-execution_count="39">
<script>
var ID = "cCyLWrLY"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="cCyLWrLY" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_cCyLWrLY" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <br>
<div class="input-group" aria-label="Input form: Numeric answer">
    <input id="cCyLWrLY" type="number" class="form-control" placeholder="Numeric answer" aria-label="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="cCyLWrLY_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_cCyLWrLY').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_cCyLWrLY')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.getElementById("cCyLWrLY").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 1.5596104694623694) <= 1.0e-8);
  var msgBox = document.getElementById('cCyLWrLY_message');
  
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_cCyLWrLY")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_cCyLWrLY")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

});

</script>
</div>
</div>
</section>
<section id="question-10" class="level4">
<h4 class="anchored" data-anchor-id="question-10">Question</h4>
<p>Use <code>find_zero</code> to find the one root of <code>x^5 - x - 1</code>. First plot to get an estimate.</p>
<div id="6707a818" class="cell" data-execution_count="40">
<div class="cell-output cell-output-display" data-execution_count="40">
<script>
var ID = "uOdZptMu"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="uOdZptMu" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_uOdZptMu" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <br>
<div class="input-group" aria-label="Input form: Numeric answer">
    <input id="uOdZptMu" type="number" class="form-control" placeholder="Numeric answer" aria-label="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="uOdZptMu_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_uOdZptMu').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_uOdZptMu')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.getElementById("uOdZptMu").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 1.1673039782614187) <= 1.0e-8);
  var msgBox = document.getElementById('uOdZptMu_message');
  
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_uOdZptMu")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_uOdZptMu")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

});

</script>
</div>
</div>
</section>
<section id="question-11" class="level4">
<h4 class="anchored" data-anchor-id="question-11">Question</h4>
<p>Let <span class="math inline">\(f(x) = 5/\sin(x) + 8/\cos(x)\)</span>, Starting at <span class="math inline">\(x=\pi/4\)</span>, use <code>find_zero</code> to find a root of the derivative of <span class="math inline">\(f(x)\)</span> given by <code>f'</code>.</p>
<div id="931a2d3f" class="cell" data-execution_count="41">
<div class="cell-output cell-output-display" data-execution_count="41">
<script>
var ID = "1Bqbvn3T"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="1Bqbvn3T" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_1Bqbvn3T" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <br>
<div class="input-group" aria-label="Input form: Numeric answer">
    <input id="1Bqbvn3T" type="number" class="form-control" placeholder="Numeric answer" aria-label="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="1Bqbvn3T_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_1Bqbvn3T').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_1Bqbvn3T')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.getElementById("1Bqbvn3T").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.7073827215431158) <= 1.0e-8);
  var msgBox = document.getElementById('1Bqbvn3T_message');
  
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_1Bqbvn3T")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_1Bqbvn3T")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

});

</script>
</div>
</div>
</section>
<section id="question-12" class="level4">
<h4 class="anchored" data-anchor-id="question-12">Question</h4>
<p>The tangent line of <code>f</code> at <code>c</code> can be computed using the point-slope form, <span class="math inline">\(f(x) = f(c) + f'(c) \cdot (x - c)\)</span>. However, we employ the <code>tangent(f,c)</code> function of the <code>MTH229</code> package, which returns a function that represents the tangent line.</p>
<p>Let <span class="math inline">\(f(x) = x^2 - 3x + 5\)</span>. Use <code>find_zero</code> to find the intersection point of the tangent line at <span class="math inline">\(1\)</span> and the tangent line at <span class="math inline">\(3\)</span>. Where does this happen?</p>
<p>(Hint, let <code>t1</code> and <code>t3</code> be defined using <code>tangent(f,c)</code> for the appropriate <code>c</code> and then apply <code>find_zero</code> to <code>eqn(x) = t1(x) -  t3(x)</code> starting at <span class="math inline">\(1\)</span>.)</p>
<div id="35637b98" class="cell" data-execution_count="42">
<div class="cell-output cell-output-display" data-execution_count="42">
<script>
var ID = "EGhMYMhU"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="EGhMYMhU" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_EGhMYMhU" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <br>
<div class="input-group" aria-label="Input form: Numeric answer">
    <input id="EGhMYMhU" type="number" class="form-control" placeholder="Numeric answer" aria-label="Numeric answer">
</div>

    
        </div>
      </div>
      <div id="EGhMYMhU_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_EGhMYMhU').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_EGhMYMhU')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.getElementById("EGhMYMhU").addEventListener("change", function() {
  var correct = (Math.abs(this.value - 0.5278640450004206) <= 1.0e-8);
  var msgBox = document.getElementById('EGhMYMhU_message');
  
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_EGhMYMhU")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_EGhMYMhU")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

});

</script>
</div>
</div>
</section>
</section>
</section>
<section id="various-issues-with-newtons-method" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="various-issues-with-newtons-method"><span class="header-section-number">7.6</span> Various issues with Newton’s method</h2>
<p>As great as Newton’s method is, it won’t always work for various reasons, some of which are described in the following. Here is what you need to keep in mind. Newton’s method works well if</p>
<ul>
<li>The zero is a simple root – that is of multiplicity 1</li>
<li>The magnitude, <span class="math inline">\(|f'(x)|\)</span>, is not too small (If the tangent line is nearly flat, the next guess is far from the previous)</li>
<li>The magnitude, <span class="math inline">\(|f''(x)|\)</span>, is not too big (function doesn’t have so much curve that the tangent line is a poor approximation)</li>
<li>The initial guess is not to far from a zero</li>
</ul>
<p>The above points come from the following formula which you can find in many texts.</p>
<p><span class="math display">\[
\Delta x_{i+1} = \frac{f' '(\alpha)}{f'(\alpha)}(\Delta x_i)^2 + \text{error}
\]</span></p>
<p>which is valid when <span class="math inline">\(f(x)\)</span> satisfies <span class="math inline">\(f(\alpha) = 0\)</span>, the third derivative exists near <span class="math inline">\(\alpha\)</span>, and <span class="math inline">\(\Delta x_i = x_i - \alpha\)</span> is the error between the zero and the <span class="math inline">\(i\)</span> th estimate. When the derivative at <span class="math inline">\(\alpha\)</span> is non-zero, the error is basically a constant times <span class="math inline">\(\Delta x_i^2\)</span>. This is interpreted as saying there is quadratic convergence in the error, as the next one is related to the previous one squared.</p>
<p>Now we look at some cases where the above three points do not hold.</p>
<section id="the-initial-guess-is-no-where-near-the-end-results" class="level3" data-number="7.6.1">
<h3 data-number="7.6.1" class="anchored" data-anchor-id="the-initial-guess-is-no-where-near-the-end-results"><span class="header-section-number">7.6.1</span> The initial guess is no where near the end results</h3>
<p>Let <span class="math inline">\(f(x) = \sin(x) - x/4\)</span> and <span class="math inline">\(x_1 = 2\pi\)</span>. This value is deliberately a poor choice:</p>
<div id="5348498d" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">sin</span>(x) <span class="op">-</span> x<span class="op">/</span><span class="fl">4</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> <span class="fu">cos</span>(x) <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">4</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">newton</span>(f, fp, <span class="fl">2</span>pi, verbose<span class="op">=</span><span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Results of univariate zero finding:

* Converged to: -2.4745767873698292
* Algorithm: Roots.Newton()
* iterations: 22
* function evaluations ≈ 44
* stopped as |f(x_n)| ≤ max(δ, |x|⋅ϵ) using δ = atol, ϵ = rtol

Trace:
x₁ = 6.2831853071795862,     fx₁ = -1.5707963267948968
x₂ = 8.3775804095727828,     fx₂ = -1.2283696986087573
x₃ = 6.7397541447611076,     fx₃ = -1.2440675381169748
x₄ = 8.6608848638032576,     fx₄ = -1.4734831418043957
x₅ = 7.145187249669843,  fx₅ = -1.0271496267351363
x₆ = 9.7071751202999792,     fx₆ = -2.7054524356150202
x₇ = 7.471984835940221,  fx₇ = -0.94007407756685935
x₈ = 15.128927112593999,     fx₈ = -3.2350143158338276
x₉ = 12.152806896784888,     fx₉ = -3.4400768736735046
x₁₀ = 17.320458159488304,    fx₁₀ = -5.3292452806856589
x₁₁ = -8.262352431213138,    fx₁₁ = 1.1478190870135017
x₁₂ = -6.4886031684043539,   fx₁₂ = 1.4181745383583302
x₁₃ = -8.4340373897987018,   fx₁₃ = 1.2720772543609207
x₁₄ = -6.8400965825145015,   fx₁₄ = 1.1814574151203185
x₁₅ = -8.8128360727706223,   fx₁₅ = 1.6287509745643769
x₁₆ = -7.2885505274866542,   fx₁₆ = 0.97777993115770767
x₁₇ = -10.709994864744841,   fx₁₇ = 3.6369972987156078
x₁₈ = -3.8698495348738184,   fx₁₈ = 1.6330320788034982
x₁₉ = -2.230811533392838,    fx₁₉ = -0.23228002463635777
x₂₀ = -2.499925490828641,    fx₂₀ = 0.026449537717568972
x₂₁ = -2.4747617934295065,   fx₂₁ = 0.00019161604875239657
x₂₂ = -2.474576797589688,    fx₂₂ = 1.058441445600522e-08
x₂₃ = -2.4745767873698292,   fx₂₃ = 2.2204460492503131e-16
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>-2.4745767873698292</code></pre>
</div>
</div>
<p>Though <code>Julia</code> makes this happen fast, it will take more than 20 steps before converging and the answer is no where near the guess. This trace might show why</p>
<div id="6be159fa" class="cell" data-execution_count="44">
<div class="cell-output cell-output-display" data-execution_count="44">
    <div id="be9728d1-4877-46f8-8fa9-3bca47dfc6e6" style="width:672px;height:480px;"></div>
    <script>
        requirejs.config({
        paths: {
            plotly: 'https://cdn.plot.ly/plotly-2.6.3.min'
        }
    });
    require(['plotly'], function (Plotly) {

    Plotly.newPlot('be9728d1-4877-46f8-8fa9-3bca47dfc6e6', [
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303337
        },
        "name": "y1",
        "yaxis": "y",
        "legendgroup": "y1",
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            3.0440211108893696,
            2.9938363336674647,
            2.942602389293072,
            2.8904020110751474,
            2.837319939232498,
            2.3206120350407073,
            1.8088844638505261,
            1.6902660656466069,
            1.577492503048942,
            1.4715221941429806,
            1.3732381215843348,
            1.283438041963418,
            1.2028256401686321,
            1.1320027268297637,
            1.0714625653574261,
            1.012832321654476,
            0.9700300143372657,
            0.9432341245692698,
            0.9323668486746193,
            0.9370953438823485,
            0.9568370575985954,
            0.990769054877754,
            1.0378411947468873,
            1.0869644155850744,
            1.1437140821061789,
            1.2071339559400758,
            1.2761914243271666,
            1.4267785018635253,
            1.5861535379541292,
            1.757901984573513,
            1.9161672123920424,
            1.9865556804526352,
            2.0492948427252755,
            2.1031444215488024,
            2.1469842270792037,
            2.1776804841016455,
            2.1983702132605845,
            2.2085080382080453,
            2.207669754061971,
            2.1955571987096767,
            2.1720016767149977,
            2.1369658965111302,
            2.0905443986336563,
            2.0283877635395653,
            1.9538461119484953,
            1.867523956434165,
            1.7701812795072391,
            1.662723503956681,
            1.5461895437833295,
            1.4217380934201853,
            1.2906323361836276,
            0.9688574763889272,
            0.636739941528604,
            0.3130052346769294,
            0.015787694868335755,
            -0.10341894178576672,
            -0.21288488408868034,
            -0.31149263864531207,
            -0.3982766161618513,
            -0.4724366398670015,
            -0.5333491398416549,
            -0.5805758766503459,
            -0.6138700722324408,
            -0.6315547433681014,
            -0.6385717994367347,
            -0.6351249183012734,
            -0.6215303767748236,
            -0.598213647271006,
            -0.5657048194367338,
            -0.5246328960337183,
            -0.4757190244488217,
            -0.3458674693191451,
            -0.1921784061017402,
            -0.025373568956199632,
            0.1431565088569801,
            0.22494193659866502,
            0.3028254519547272,
            0.3754309062884769,
            0.44145045531769256,
            0.4996614841670337,
            0.5489424294510885,
            0.5882872936315805,
            0.6168186638157781,
            0.6348926646658326,
            0.6380665766696323,
            0.6257926278240808,
            0.5977673644194402,
            0.5539364503635338,
            0.4944955265435339,
            0.41988711663394834,
            0.330793628287531,
            0.23340574822265325,
            0.12469403508596044,
            0.005786565816845224,
            -0.12204258161677461,
            -0.3987508905388986,
            -0.6930549536106505,
            -1.0033409862244236,
            -1.3028838900555024,
            -1.4440017454819798,
            -1.5770474294161703,
            -1.7004432173512531,
            -1.8127607638960321,
            -1.8977920493627378,
            -1.973433761018371,
            -2.0391433660843346,
            -2.0944873192451836,
            -2.139145820048647,
            -2.17291632215512,
            -2.1957157559287666,
            -2.207581439981184,
            -2.207483424167721,
            -2.1918541936677123,
            -2.161472235439822,
            -2.1173572285819438,
            -2.06075337361189,
            -1.9931090510505385,
            -1.9160531418689577,
            -1.831368396936198,
            -1.6628095955326905,
            -1.487534028524871,
            -1.318335489816195,
            -1.1676753466515302,
            -1.107584244281714,
            -1.054930982199455,
            -1.0106488254207806,
            -0.9755730359635814,
            -0.9504310941888803,
            -0.9358341819737359,
            -0.9322700274247919,
            -0.940097194901519,
            -0.9598698991095755,
            -0.9916538828356722,
            -1.0353966542397866,
            -1.0909020650891201,
            -1.157832667012627,
            -1.2357137651406482,
            -1.3239391204348174,
            -1.421778232208311,
            -1.5418033109239162,
            -1.6714909587433155,
            -1.8093483903554743,
            -1.953759586347541,
            -2.2553107720022076,
            -2.561712117421453,
            -2.831223618754635,
            -3.082056586784632,
            -3.197406374060063,
            -3.3045701910314165,
            -3.4025653185125173,
            -3.4905226263907903,
            -3.5779497271316005,
            -3.6503449525786444,
            -3.707050472592878,
            -3.747663177110586,
            -3.772041220576373,
            -3.7803063247850317,
            -3.772841802745984,
            -3.7502863356525826,
            -3.7167113912708496,
            -3.671832304764812,
            -3.6166847030749834,
            -3.552447161299127,
            -3.4020310953126964,
            -3.2322062110273184,
            -3.058150190494677,
            -2.8900996914733144,
            -2.812171205229025,
            -2.7402587444430484,
            -2.6757290905899325,
            -2.61984912705874,
            -2.574960716237803,
            -2.5402437268640154,
            -2.516501405044806,
            -2.504396999620628,
            -2.504445301496374,
            -2.5170060767618456,
            -2.542279477371019,
            -2.580303487923336,
            -2.6323866373749043,
            -2.697427560683372,
            -2.7749426129690775,
            -2.8642809359929777,
            -2.9646331827892665,
            -3.0750423668096585,
            -3.194416690148589,
            -3.321544178889364,
            -3.6206656497720897,
            -3.9354608959360875,
            -4.249821865116477,
            -4.547668337844905,
            -4.648765683430262,
            -4.745021443652263,
            -4.835813903303563,
            -4.920567743241887,
            -4.998758926180941,
            -5.069919146979714,
            -5.133639809636881,
            -5.189575497216426,
            -5.237446905236794,
            -5.27704321361231,
            -5.308223877003595,
            -5.33091981837274,
            -5.345134015607217,
            -5.350941476230726,
            -5.348488600415736,
            -5.33799193770722,
            -5.3235674795208645,
            -5.304107626445145,
            -5.2798318694499,
            -5.250987246771676
        ],
        "type": "scatter",
        "x": [
            -10.0,
            -9.954426177907655,
            -9.90885235581531,
            -9.863278533722966,
            -9.81770471163062,
            -9.39630892027056,
            -8.974913128910497,
            -8.869564181070482,
            -8.764215233230466,
            -8.65886628539045,
            -8.553517337550435,
            -8.44816838971042,
            -8.342819441870404,
            -8.237470494030388,
            -8.132121546190373,
            -8.005500893203454,
            -7.878880240216535,
            -7.7522595872296165,
            -7.625638934242697,
            -7.499018281255777,
            -7.372397628268859,
            -7.24577697528194,
            -7.119156322295021,
            -7.0121001716713565,
            -6.905044021047693,
            -6.797987870424029,
            -6.690931719800364,
            -6.476819418553035,
            -6.262707117305706,
            -6.030121144491707,
            -5.797535171677707,
            -5.6812421852707065,
            -5.564949198863706,
            -5.448656212456706,
            -5.332363226049706,
            -5.22515137887936,
            -5.117939531709014,
            -5.010727684538669,
            -4.903515837368324,
            -4.796303990197979,
            -4.689092143027633,
            -4.581880295857287,
            -4.474668448686941,
            -4.359726017652598,
            -4.2447835866182535,
            -4.129841155583909,
            -4.014898724549566,
            -3.899956293515222,
            -3.785013862480878,
            -3.6700714314465337,
            -3.55512900041219,
            -3.288784843395992,
            -3.0224406863797935,
            -2.756096529363595,
            -2.489752372347397,
            -2.371404744878256,
            -2.2530571174091145,
            -2.134709489939973,
            -2.016361862470832,
            -1.8980142350016906,
            -1.7796666075325493,
            -1.6613189800634078,
            -1.5429713525942665,
            -1.4391911482594697,
            -1.335410943924673,
            -1.2316307395898765,
            -1.1278505352550798,
            -1.0240703309202832,
            -0.9202901265854865,
            -0.8165099222506897,
            -0.7127297179158931,
            -0.48643315737876236,
            -0.2601365968416316,
            -0.03384003630450086,
            0.19245652423262988,
            0.306277275793446,
            0.42009802735426216,
            0.5339187789150783,
            0.6477395304758945,
            0.7615602820367107,
            0.8753810335975267,
            0.9892017851583429,
            1.103022536719159,
            1.2288659324195408,
            1.3547093281199225,
            1.4805527238203042,
            1.606396119520686,
            1.7322395152210677,
            1.8580829109214494,
            1.9839263066218311,
            2.109769702322213,
            2.2295065179365707,
            2.349243333550929,
            2.4689801491652874,
            2.5887169647796453,
            2.828190596008362,
            3.067664227237078,
            3.316661240147445,
            3.565658253057811,
            3.6901567595129943,
            3.8146552659681774,
            3.9391537724233605,
            4.063652278878544,
            4.168453502574698,
            4.273254726270851,
            4.378055949967005,
            4.4828571736631595,
            4.587658397359314,
            4.692459621055468,
            4.797260844751622,
            4.902062068447776,
            5.030012483859987,
            5.1579628992721975,
            5.285913314684409,
            5.41386373009662,
            5.54181414550883,
            5.669764560921042,
            5.7977149763332525,
            5.925665391745463,
            6.160086741889978,
            6.394508092034492,
            6.628929442179007,
            6.863350792323521,
            6.971603896007129,
            7.079856999690737,
            7.188110103374344,
            7.296363207057952,
            7.4046163107415595,
            7.512869414425166,
            7.621122518108774,
            7.729375621792382,
            7.839032661186693,
            7.948689700581005,
            8.058346739975317,
            8.168003779369627,
            8.277660818763938,
            8.38731785815825,
            8.496974897552562,
            8.606631936946872,
            8.729526736352229,
            8.852421535757586,
            8.975316335162942,
            9.098211134568299,
            9.344000733379012,
            9.589790332189725,
            9.812515389731283,
            10.035240447272841,
            10.14660297604362,
            10.2579655048144,
            10.36932803358518,
            10.480690562355958,
            10.608192977114573,
            10.735695391873186,
            10.863197806631801,
            10.990700221390416,
            11.118202636149029,
            11.245705050907643,
            11.373207465666258,
            11.500709880424871,
            11.618765777882334,
            11.7368216753398,
            11.854877572797264,
            11.972933470254727,
            12.209045265169655,
            12.445157060084583,
            12.67793562247373,
            12.910714184862874,
            13.027103466057447,
            13.143492747252019,
            13.259882028446592,
            13.376271309641165,
            13.489275668911263,
            13.602280028181362,
            13.71528438745146,
            13.828288746721558,
            13.941293105991656,
            14.054297465261754,
            14.167301824531854,
            14.280306183801953,
            14.396150101861952,
            14.51199401992195,
            14.627837937981948,
            14.743681856041947,
            14.859525774101947,
            14.975369692161944,
            15.091213610221942,
            15.207057528281942,
            15.460898450436869,
            15.714739372591797,
            15.968580294746726,
            16.222421216901655,
            16.314607609459863,
            16.406794002018074,
            16.498980394576286,
            16.591166787134497,
            16.68335317969271,
            16.775539572250917,
            16.867725964809125,
            16.959912357367337,
            17.05209874992555,
            17.144285142483756,
            17.236471535041964,
            17.328657927600176,
            17.420844320158388,
            17.5130307127166,
            17.60521710527481,
            17.69740349783302,
            17.773052623374767,
            17.84870174891651,
            17.924350874458256,
            18.0
        ]
    },
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303337
        },
        "name": "y2",
        "yaxis": "y",
        "legendgroup": "y2",
        "line": {
            "color": "rgba(227, 111, 71, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
        ],
        "type": "scatter",
        "x": [
            -10.0,
            -9.81770471163062,
            -8.132121546190373,
            -7.119156322295021,
            -6.262707117305706,
            -5.332363226049706,
            -4.474668448686941,
            -3.55512900041219,
            -2.489752372347397,
            -1.5429713525942665,
            -0.7127297179158931,
            0.19245652423262988,
            1.103022536719159,
            2.109769702322213,
            3.067664227237078,
            4.063652278878544,
            4.902062068447776,
            5.925665391745463,
            6.863350792323521,
            7.729375621792382,
            8.606631936946872,
            9.589790332189725,
            10.480690562355958,
            11.500709880424871,
            12.445157060084583,
            13.376271309641165,
            14.280306183801953,
            15.207057528281942,
            16.222421216901655,
            17.69740349783302,
            18.0
        ]
    },
    {
        "showlegend": true,
        "mode": "lines",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303337
        },
        "name": "y3",
        "yaxis": "y",
        "legendgroup": "y3",
        "line": {
            "color": "rgba(62, 164, 78, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            0.0,
            -1.5707963267948968,
            0.0,
            -1.2283696986087573,
            0.0,
            -1.2440675381169748,
            0.0,
            -1.4734831418043957,
            0.0,
            -1.0271496267351363,
            0.0,
            -2.7054524356150202,
            0.0,
            -0.9400740775668593,
            0.0,
            -3.2350143158338276,
            0.0,
            -3.4400768736735046,
            0.0,
            -5.329245280685659,
            0.0,
            1.1478190870135017,
            0.0,
            1.4181745383583302,
            0.0,
            1.2720772543609207,
            0.0,
            1.1814574151203185,
            0.0,
            1.628750974564377,
            0.0,
            0.9777799311577077,
            0.0,
            3.636997298715608,
            0.0,
            1.6330320788034982,
            0.0,
            -0.23228002463635777,
            0.0,
            0.02644953771756897,
            0.0
        ],
        "type": "scatter",
        "x": [
            6.283185307179586,
            6.283185307179586,
            8.377580409572783,
            8.377580409572783,
            6.739754144761108,
            6.739754144761108,
            8.660884863803258,
            8.660884863803258,
            7.145187249669843,
            7.145187249669843,
            9.70717512029998,
            9.70717512029998,
            7.471984835940221,
            7.471984835940221,
            15.128927112593999,
            15.128927112593999,
            12.152806896784888,
            12.152806896784888,
            17.320458159488304,
            17.320458159488304,
            -8.262352431213138,
            -8.262352431213138,
            -6.488603168404354,
            -6.488603168404354,
            -8.434037389798702,
            -8.434037389798702,
            -6.8400965825145015,
            -6.8400965825145015,
            -8.812836072770622,
            -8.812836072770622,
            -7.288550527486654,
            -7.288550527486654,
            -10.709994864744841,
            -10.709994864744841,
            -3.8698495348738184,
            -3.8698495348738184,
            -2.230811533392838,
            -2.230811533392838,
            -2.499925490828641,
            -2.499925490828641,
            -2.4747617934295065
        ]
    },
    {
        "showlegend": true,
        "mode": "markers",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303337
        },
        "name": "y4",
        "yaxis": "y",
        "legendgroup": "y4",
        "marker": {
            "symbol": "diamond",
            "color": "rgba(195, 113, 210, 1.000)",
            "line": {
                "color": "rgba(0, 0, 0, 1.000)",
                "width": 1
            },
            "size": 12
        },
        "y": [
            0.0
        ],
        "type": "scatter",
        "x": [
            6.283185307179586
        ]
    },
    {
        "showlegend": true,
        "mode": "markers",
        "xaxis": "x",
        "colorbar": {
            "y": 0.5115740740740741,
            "title": "",
            "len": 0.9604476523767862,
            "x": 0.9941413573303337
        },
        "name": "y5",
        "yaxis": "y",
        "legendgroup": "y5",
        "marker": {
            "symbol": "circle",
            "color": "rgba(172, 142, 24, 1.000)",
            "line": {
                "color": "rgba(0, 0, 0, 1.000)",
                "width": 1
            },
            "size": 8
        },
        "y": [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
        ],
        "type": "scatter",
        "x": [
            8.377580409572783,
            6.739754144761108,
            8.660884863803258,
            7.145187249669843,
            9.70717512029998,
            7.471984835940221,
            15.128927112593999,
            12.152806896784888,
            17.320458159488304,
            -8.262352431213138,
            -6.488603168404354,
            -8.434037389798702,
            -6.8400965825145015,
            -8.812836072770622,
            -7.288550527486654,
            -10.709994864744841,
            -3.8698495348738184,
            -2.230811533392838,
            -2.499925490828641,
            -2.4747617934295065
        ]
    }
]
, {
    "showlegend": false,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -10.0,
            -5.0,
            0.0,
            5.0,
            10.0,
            15.0
        ],
        "range": [
            -11.571294710687187,
            18.861299845942348
        ],
        "domain": [
            0.032313669124692745,
            0.9941413573303337
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−10",
            "−5",
            "0",
            "5",
            "10",
            "15"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [
        {
            "yanchor": "top",
            "xanchor": "center",
            "rotation": -0.0,
            "y": 0,
            "font": {
                "color": "rgba(0, 0, 0, 1.000)",
                "family": "sans-serif",
                "size": 14
            },
            "yref": "y",
            "showarrow": false,
            "text": "x₀",
            "xref": "x",
            "x": 6.283185307179586
        }
    ],
    "height": 480,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -4.0,
            -2.0,
            0.0,
            2.0
        ],
        "range": [
            -5.620579639479116,
            3.906635461963998
        ],
        "domain": [
            0.031350247885680964,
            0.9917979002624672
        ],
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "ticktext": [
            "−4",
            "−2",
            "0",
            "2"
        ],
        "zeroline": false,
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x",
        "visible": true,
        "ticks": "inside",
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "type": "-"
    },
    "width": 672
}
);
    });
    </script>
<p>Newton, way off</p>
</div>
</div>
<section id="question-13" class="level4">
<h4 class="anchored" data-anchor-id="question-13">Question</h4>
<p>When <span class="math inline">\(|f'(x)|\)</span> is too close to <span class="math inline">\(0\)</span>, the path can jump alot. In the figure, what was the longest jump?</p>
<div id="62fd6d41" class="cell" data-execution_count="45">
<div class="cell-output cell-output-display" data-execution_count="45">
<script>
var ID = "N0d43yoV"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="N0d43yoV" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_N0d43yoV" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <fieldset style="border:0px">
<legend style="display: none" aria-label="Select an item">Select an item</legend>
<div class="form-check">
    <label class="form-check-label" for="radio_N0d43yoV_1">
      <input class="form-check-input" type="radio" name="radio_N0d43yoV" id="radio_N0d43yoV_1" value="1">
      
      <span class="label-body px-1">
        From about 17 to -10
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_N0d43yoV_2">
      <input class="form-check-input" type="radio" name="radio_N0d43yoV" id="radio_N0d43yoV_2" value="2">
      
      <span class="label-body px-1">
        From about 0 to -5
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_N0d43yoV_3">
      <input class="form-check-input" type="radio" name="radio_N0d43yoV" id="radio_N0d43yoV_3" value="3">
      
      <span class="label-body px-1">
        From about -12 to -3
      </span>
    </label>
</div>
</fieldset>

    
        </div>
      </div>
      <div id="N0d43yoV_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_N0d43yoV').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_N0d43yoV')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_N0d43yoV"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 1;
    var msgBox = document.getElementById('N0d43yoV_message');
    
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_N0d43yoV")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_N0d43yoV")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

})});

</script>
</div>
</div>
</section>
<section id="question-14" class="level4">
<h4 class="anchored" data-anchor-id="question-14">Question</h4>
<p>The method did find a zero, but the initial guess was nowhere near the final zero. How close was the closest zero to the initial guess?</p>
<div id="ec3498c5" class="cell" data-execution_count="46">
<div class="cell-output cell-output-display" data-execution_count="46">
<script>
var ID = "3ODK8WJN"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="3ODK8WJN" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_3ODK8WJN" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <fieldset style="border:0px">
<legend style="display: none" aria-label="Select an item">Select an item</legend>
<div class="form-check">
    <label class="form-check-label" for="radio_3ODK8WJN_1">
      <input class="form-check-input" type="radio" name="radio_3ODK8WJN" id="radio_3ODK8WJN_1" value="1">
      
      <span class="label-body px-1">
        <code>8.75</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_3ODK8WJN_2">
      <input class="form-check-input" type="radio" name="radio_3ODK8WJN" id="radio_3ODK8WJN_2" value="2">
      
      <span class="label-body px-1">
        <code>2pi</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_3ODK8WJN_3">
      <input class="form-check-input" type="radio" name="radio_3ODK8WJN" id="radio_3ODK8WJN_3" value="3">
      
      <span class="label-body px-1">
        <code>3.8</code>
      </span>
    </label>
</div>
</fieldset>

    
        </div>
      </div>
      <div id="3ODK8WJN_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_3ODK8WJN').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_3ODK8WJN')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_3ODK8WJN"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 3;
    var msgBox = document.getElementById('3ODK8WJN_message');
    
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_3ODK8WJN")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_3ODK8WJN")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

})});

</script>
</div>
</div>
</section>
</section>
<section id="function-has-a-poor-shape" class="level3" data-number="7.6.2">
<h3 data-number="7.6.2" class="anchored" data-anchor-id="function-has-a-poor-shape"><span class="header-section-number">7.6.2</span> Function has a poor shape</h3>
<p>Let <span class="math inline">\(f(x) = x^{1/3}\)</span>. We know the root is 0. Let’s see what happens if we use Newton’s method. We have to be careful though as <code>Julia</code> thinks that cube roots of negative numbers (via <code>x^(1/3)</code> are <code>NaN</code>, not a number. (You can avoid this, by making your number complex, e.g.&nbsp;<code>x + 0*im</code>, but then the real answer is not given as an answer. It is just one of three and not the chosen one.)</p>
<p>So we define our function using <code>Julia</code>’s <code>cbrt</code> function, which works as we desire for negative numbers, as follows:</p>
<div id="d067ec98" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> <span class="fu">cbrt</span>(x)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>xstar <span class="op">=</span> <span class="fu">newton</span>(f, <span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: Roots.ConvergenceFailed("Algorithm failed to converge")</code></pre>
</div>
</div>
<p>Still an issue. Why?</p>
<section id="question-15" class="level4">
<h4 class="anchored" data-anchor-id="question-15">Question</h4>
<p>Despite all our care with the derivative, the method did not converge in <span class="math inline">\(200\)</span> steps. Can you see why from this trace?</p>
<div id="f1fd9703" class="cell" data-execution_count="48">
<div class="cell-output cell-output-error">
<pre><code>LoadError: UndefVarError: `n!` not defined</code></pre>
</div>
</div>
<div id="a796c589" class="cell" data-execution_count="49">
<div class="cell-output cell-output-display" data-execution_count="49">
<script>
var ID = "Ew5jnoZK"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="Ew5jnoZK" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_Ew5jnoZK" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <fieldset style="border:0px">
<legend style="display: none" aria-label="Select an item">Select an item</legend>
<div class="form-check">
    <label class="form-check-label" for="radio_Ew5jnoZK_1">
      <input class="form-check-input" type="radio" name="radio_Ew5jnoZK" id="radio_Ew5jnoZK_1" value="1">
      
      <span class="label-body px-1">
        <code>|f'(x)|</code> gets too small
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_Ew5jnoZK_2">
      <input class="form-check-input" type="radio" name="radio_Ew5jnoZK" id="radio_Ew5jnoZK_2" value="2">
      
      <span class="label-body px-1">
        <code>|f''(x)|</code> gets too big at 0
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_Ew5jnoZK_3">
      <input class="form-check-input" type="radio" name="radio_Ew5jnoZK" id="radio_Ew5jnoZK_3" value="3">
      
      <span class="label-body px-1">
        Initial guess is too far from a zero.
      </span>
    </label>
</div>
</fieldset>

    
        </div>
      </div>
      <div id="Ew5jnoZK_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_Ew5jnoZK').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_Ew5jnoZK')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_Ew5jnoZK"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('Ew5jnoZK_message');
    
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_Ew5jnoZK")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_Ew5jnoZK")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

})});

</script>
</div>
</div>
</section>
<section id="question-solve-by-hand" class="level4">
<h4 class="anchored" data-anchor-id="question-solve-by-hand">Question: solve by hand</h4>
<p>For <span class="math inline">\(f(x) = x^{1/3}\)</span>, simplify the expression by hand:</p>
<pre class="math"><code>x - f(x)/f'(x)</code></pre>
<p>What do you get?</p>
<div id="9ab7489e" class="cell" data-execution_count="50">
<div class="cell-output cell-output-display" data-execution_count="50">
<script>
var ID = "VZ8cWgz0"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="VZ8cWgz0" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_VZ8cWgz0" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <fieldset style="border:0px">
<legend style="display: none" aria-label="Select an item">Select an item</legend>
<div class="form-check">
    <label class="form-check-label" for="radio_VZ8cWgz0_1">
      <input class="form-check-input" type="radio" name="radio_VZ8cWgz0" id="radio_VZ8cWgz0_1" value="1">
      
      <span class="label-body px-1">
        <code>x - (1/3)x^{-1/3}</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_VZ8cWgz0_2">
      <input class="form-check-input" type="radio" name="radio_VZ8cWgz0" id="radio_VZ8cWgz0_2" value="2">
      
      <span class="label-body px-1">
        <code>x - 3/x</code>
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_VZ8cWgz0_3">
      <input class="form-check-input" type="radio" name="radio_VZ8cWgz0" id="radio_VZ8cWgz0_3" value="3">
      
      <span class="label-body px-1">
        <code>-2x</code>
      </span>
    </label>
</div>
</fieldset>

    
        </div>
      </div>
      <div id="VZ8cWgz0_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_VZ8cWgz0').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_VZ8cWgz0')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_VZ8cWgz0"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 3;
    var msgBox = document.getElementById('VZ8cWgz0_message');
    
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_VZ8cWgz0")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_VZ8cWgz0")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

})});

</script>
</div>
</div>
</section>
<section id="question-16" class="level4">
<h4 class="anchored" data-anchor-id="question-16">Question</h4>
<p>Apply Newton’s method to <span class="math inline">\(f(x) = (x-2)^7 \cdot (x-3) \cdot (x-4)\)</span> starting at 1.9981. The algorithm does not converge to 2 – an obvious root. From a plot of <span class="math inline">\(f(x)\)</span> explain why not:</p>
<div id="55377dfa" class="cell" data-execution_count="51">
<div class="cell-output cell-output-display" data-execution_count="51">
<script>
var ID = "EHgeYlnu"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="EHgeYlnu" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_EHgeYlnu" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <fieldset style="border:0px">
<legend style="display: none" aria-label="Select an item">Select an item</legend>
<div class="form-check">
    <label class="form-check-label" for="radio_EHgeYlnu_1">
      <input class="form-check-input" type="radio" name="radio_EHgeYlnu" id="radio_EHgeYlnu_1" value="1">
      
      <span class="label-body px-1">
        <code>|f'(x)|</code> gets too small
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_EHgeYlnu_2">
      <input class="form-check-input" type="radio" name="radio_EHgeYlnu" id="radio_EHgeYlnu_2" value="2">
      
      <span class="label-body px-1">
        <code>|f''(x)|</code> gets too big at 0
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_EHgeYlnu_3">
      <input class="form-check-input" type="radio" name="radio_EHgeYlnu" id="radio_EHgeYlnu_3" value="3">
      
      <span class="label-body px-1">
        Initial guess is to far from a zero.
      </span>
    </label>
</div>
</fieldset>

    
        </div>
      </div>
      <div id="EHgeYlnu_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_EHgeYlnu').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_EHgeYlnu')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_EHgeYlnu"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 1;
    var msgBox = document.getElementById('EHgeYlnu_message');
    
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_EHgeYlnu")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_EHgeYlnu")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

})});

</script>
</div>
</div>
</section>
<section id="question-17" class="level4">
<h4 class="anchored" data-anchor-id="question-17">Question</h4>
<p>The function <code>f(x) = atan(x)</code> is a strictly increasing function with one zero, <span class="math inline">\(0\)</span>. Yet it can pose problems with Newton’s method. For which values of <span class="math inline">\(x\)</span> does Newton’s method converge:</p>
<div id="81f871da" class="cell" data-execution_count="52">
<div class="cell-output cell-output-display" data-execution_count="52">
<script>
var ID = "nMoLWbiM"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="nMoLWbiM" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_nMoLWbiM" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <fieldset style="border:0px">
<legend style="display: none" aria-label="Select an item">Select an item</legend>
<div class="form-check">
    <label class="form-check-label" for="radio_nMoLWbiM_1">
      <input class="form-check-input" type="radio" name="radio_nMoLWbiM" id="radio_nMoLWbiM_1" value="1">
      
      <span class="label-body px-1">
        For each of \(1\), \(2\) and \(\pi\)
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_nMoLWbiM_2">
      <input class="form-check-input" type="radio" name="radio_nMoLWbiM" id="radio_nMoLWbiM_2" value="2">
      
      <span class="label-body px-1">
        For \(1\) and \(2\) but not \(\pi\)
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_nMoLWbiM_3">
      <input class="form-check-input" type="radio" name="radio_nMoLWbiM" id="radio_nMoLWbiM_3" value="3">
      
      <span class="label-body px-1">
        For \(1\) but not \(2\) or \(\pi\)
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_nMoLWbiM_4">
      <input class="form-check-input" type="radio" name="radio_nMoLWbiM" id="radio_nMoLWbiM_4" value="4">
      
      <span class="label-body px-1">
        For none of  \(1\), \(2\) and \(\pi\)
      </span>
    </label>
</div>
</fieldset>

    
        </div>
      </div>
      <div id="nMoLWbiM_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_nMoLWbiM').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_nMoLWbiM')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_nMoLWbiM"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 3;
    var msgBox = document.getElementById('nMoLWbiM_message');
    
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_nMoLWbiM")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_nMoLWbiM")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

})});

</script>
</div>
</div>
</section>
</section>
<section id="cycles" class="level3" data-number="7.6.3">
<h3 data-number="7.6.3" class="anchored" data-anchor-id="cycles"><span class="header-section-number">7.6.3</span> Cycles</h3>
<p>Sometimes, the process can cycle even for reasonable functions.</p>
<section id="question-18" class="level4">
<h4 class="anchored" data-anchor-id="question-18">Question</h4>
<p>Let <span class="math inline">\(f(x) = x^3 - 5x\)</span>. Starting with <span class="math inline">\(x_1=1\)</span>, compute three steps of Newton’s method. What are the terms in the series produced?</p>
<div id="4e11f2d4" class="cell" data-execution_count="53">
<div class="cell-output cell-output-display" data-execution_count="53">
<script>
var ID = "iAUF9dDV"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="iAUF9dDV" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_iAUF9dDV" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <fieldset style="border:0px">
<legend style="display: none" aria-label="Select an item">Select an item</legend>
<div class="form-check">
    <label class="form-check-label" for="radio_iAUF9dDV_1">
      <input class="form-check-input" type="radio" name="radio_iAUF9dDV" id="radio_iAUF9dDV_1" value="1">
      
      <span class="label-body px-1">
        \(1, -2, -4,  \dots\)
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_iAUF9dDV_2">
      <input class="form-check-input" type="radio" name="radio_iAUF9dDV" id="radio_iAUF9dDV_2" value="2">
      
      <span class="label-body px-1">
        \(-1.0, 1.0, -1.0, \dots\)
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_iAUF9dDV_3">
      <input class="form-check-input" type="radio" name="radio_iAUF9dDV" id="radio_iAUF9dDV_3" value="3">
      
      <span class="label-body px-1">
        \(-1.0, 0.6666666666666667, -0.2850952524822228, \dots\)
      </span>
    </label>
</div>
</fieldset>

    
        </div>
      </div>
      <div id="iAUF9dDV_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_iAUF9dDV').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_iAUF9dDV')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_iAUF9dDV"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 2;
    var msgBox = document.getElementById('iAUF9dDV_message');
    
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_iAUF9dDV")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_iAUF9dDV")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

})});

</script>
</div>
</div>
</section>
<section id="question-always-cycles" class="level4">
<h4 class="anchored" data-anchor-id="question-always-cycles">Question: always cycles…</h4>
<p>Here is a pathological example where the value always cycles no matter where you start unless you start at <span class="math inline">\(0\)</span>.</p>
<p>Let <span class="math inline">\(f(x) = \sqrt{|x|}\)</span>. This is the one-sided square root function turned into an even function. We could also have defined it by:</p>
<div id="648edc5b" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(x) <span class="op">=</span> x <span class="op">&gt;=</span> <span class="fl">0</span> ? <span class="fu">sqrt</span>(x) <span class="op">:</span> <span class="fu">sqrt</span>(<span class="op">-</span>x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>f (generic function with 1 method)</code></pre>
</div>
</div>
<p>where the ternary operator <code>a ? b : c</code> looks at <code>a</code> and if true will execute <code>b</code> otherwise <code>c</code>.</p>
<p>This makes it easier to write the derivative of the function in <code>Julia</code>:</p>
<div id="58d0be4f" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fp</span>(x) <span class="op">=</span> x <span class="op">&gt;=</span><span class="fl">0</span> ? (<span class="fl">1</span><span class="op">/</span><span class="fl">2</span>)<span class="fu">*sqrt</span>(x)<span class="op">/</span>x <span class="op">:</span> <span class="fu">-</span>(<span class="fl">1</span><span class="op">/</span><span class="fl">2</span>)<span class="fu">*sqrt</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="op">-</span>x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>fp (generic function with 2 methods)</code></pre>
</div>
</div>
<p>To see what happens when using Newton’s method, lets start at <span class="math inline">\(x=2\)</span></p>
<div id="5c27f77a" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fl">2</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span><span class="fu">fp</span>(x)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span><span class="fu">fp</span>(x)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">-</span> <span class="fu">f</span>(x)<span class="op">/</span><span class="fu">fp</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>-2.0</code></pre>
</div>
</div>
<p>Try again with <span class="math inline">\(x=3.0\)</span> What sequence do you get:</p>
<div id="3662b0ec" class="cell" data-execution_count="57">
<div class="cell-output cell-output-display" data-execution_count="57">
<script>
var ID = "fOLYSZjc"
</script>
<form class="mx-2 my-3 mw-100" name="WeaveQuestion" data-id="fOLYSZjc" data-controltype="" onsubmit="return false;">
  <div class="form-group ">
    <div class="controls">
      <div class="form" id="controls_fOLYSZjc" correct="-1" attempts="0">
        <div style="padding-top: 5px">
    <fieldset style="border:0px">
<legend style="display: none" aria-label="Select an item">Select an item</legend>
<div class="form-check">
    <label class="form-check-label" for="radio_fOLYSZjc_1">
      <input class="form-check-input" type="radio" name="radio_fOLYSZjc" id="radio_fOLYSZjc_1" value="1">
      
      <span class="label-body px-1">
        \(2, -2.0, 2.0, -2.0\)
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_fOLYSZjc_2">
      <input class="form-check-input" type="radio" name="radio_fOLYSZjc" id="radio_fOLYSZjc_2" value="2">
      
      <span class="label-body px-1">
        \(3, 2.0, 1.0, 0.0, -1.0, \dots\)
      </span>
    </label>
</div>
<div class="form-check">
    <label class="form-check-label" for="radio_fOLYSZjc_3">
      <input class="form-check-input" type="radio" name="radio_fOLYSZjc" id="radio_fOLYSZjc_3" value="3">
      
      <span class="label-body px-1">
        \(3, -3.0, 3.0, -3.0, \dots\)
      </span>
    </label>
</div>
</fieldset>

    
        </div>
      </div>
      <div id="fOLYSZjc_message" style="padding-bottom: 15px"></div>
    </div>
  </div>
</form>
<script>
document.getElementById('controls_fOLYSZjc').addEventListener("quizquestion_answer", (e) => {
          var o = document.getElementById('controls_fOLYSZjc')
          var atts = Number(o.getAttribute("attempts"))
          o.setAttribute("correct",  e.detail.correct);
          o.setAttribute("attempts", atts + 1)
      }, true)
</script>

<script text="text/javascript">
document.querySelectorAll('input[name="radio_fOLYSZjc"]').forEach(function(rb) {
rb.addEventListener("change", function() {
    var correct = rb.value == 3;
    var msgBox = document.getElementById('fOLYSZjc_message');
    
  if(correct) {
    msgBox.innerHTML = "<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>";
    var explanation = document.getElementById("explanation_fOLYSZjc")
    if (explanation != null) {
       explanation.style.display = "none";
    }
      const correct_answer   = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 1}});
  this.dispatchEvent(correct_answer);
  //typeof correct_answer   != "undefined" && this.dispatchEvent(correct_answer);

  } else {
    msgBox.innerHTML = "<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>";
    var explanation = document.getElementById("explanation_fOLYSZjc")
    if (explanation != null) {
       explanation.style.display = "block";
    }
      const incorrect_answer = new CustomEvent("quizquestion_answer", {bubbles:true, detail:{correct: 0}});
  this.dispatchEvent(incorrect_answer);
  //typeof incorrect_answer != "undefined" && this.dispatchEvent(incorrect_answer);

  }

})});

</script>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Environment of <code>Julia</code> when generated
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>Julia</code> version:</p>
<div id="7514b80c" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="cn">VERSION</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>v"1.10.3"</code></pre>
</div>
</div>
<p>Packages and versions:</p>
<div id="63f23ba3" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Pkg</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Pkg</span>.<span class="fu">status</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Status `~/work/mth229.github.io/mth229.github.io/Project.toml`
  [a2e0e22d] CalculusWithJulia v0.2.6
  [7073ff75] IJulia v1.24.2
  [b964fa9f] LaTeXStrings v1.3.1
  [ebaf19f5] MTH229 v0.3.2
  [91a5bcdd] Plots v1.40.4
  [f27b6e38] Polynomials v4.0.9
  [438e738f] PyCall v1.96.4
  [612c44de] QuizQuestions v0.3.23
  [295af30f] Revise v3.5.14
  [f2b01f46] Roots v2.1.5
  [24249f21] SymPy v2.1.1
  [56ddb016] Logging</code></pre>
</div>
</div>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./derivatives.html" class="pagination-link" aria-label="Approximate derivatives in Julia">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Approximate derivatives in Julia</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./first-second-derivatives.html" class="pagination-link" aria-label="Exploring first and second derivatives with Julia">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exploring first and second derivatives with Julia</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/MTH229/mth229.github.io/edit/master/quarto/newton.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/MTH229/mth229.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script src="https://cdn.jsdelivr.net/gh/yasserelsaid/chatbot@v0.1.4/index.min.js" data-chatbotid="index-pdf-k527qtaap"></script>




</body></html>